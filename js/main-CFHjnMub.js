import{E as t,V as e,M as n,T as i,S as r,Q as s,a as o,R as a,P as l,b as c,c as u,A as h,d,e as p,C as m,f,g,W as _,H as v,h as y,L as w,N as b,G as T,i as E,j as x,k as A,B as C,l as S,m as k,D as O,n as M,U as D,o as P,p as I,q as F,r as R,s as N,t as L,u as j,v as V}from"./three-Dro9o-hU.js";import{c as B,a as $,g as W}from"./enhancements-Ur4svFn_.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const z="14.7.77",U=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),q=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),H=(t,e)=>({startTime:e,type:"setValue",value:t}),G=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),Y=(t,e,{startTime:n,target:i,timeConstant:r})=>i+(e-i)*Math.exp((n-t)/r),X=t=>"exponentialRampToValue"===t.type,Z=t=>"linearRampToValue"===t.type,K=t=>X(t)||Z(t),J=t=>"setValue"===t.type,Q=t=>"setValueCurve"===t.type,tt=(t,e,n,i)=>{const r=t[e];return void 0===r?i:K(r)||J(r)?r.value:Q(r)?r.values[r.values.length-1]:Y(n,tt(t,e-1,r.startTime,i),r)},et=(t,e,n,i,r)=>void 0===n?[i.insertTime,r]:K(n)?[n.endTime,n.value]:J(n)?[n.startTime,n.value]:Q(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,tt(t,e-1,n.startTime,r)],nt=t=>"cancelAndHold"===t.type,it=t=>"cancelScheduledValues"===t.type,rt=t=>nt(t)||it(t)?t.cancelTime:X(t)||Z(t)?t.endTime:t.startTime,st=(t,e,n,{endTime:i,value:r})=>n===r?r:0<n&&0<r||n<0&&r<0?n*(r/n)**((t-e)/(i-e)):0,ot=(t,e,n,{endTime:i,value:r})=>n+(t-e)/(i-e)*(r-n),at=(t,{duration:e,startTime:n,values:i})=>((t,e)=>{const n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]})(i,(t-n)/e*(i.length-1)),lt=t=>"setTarget"===t.type;class ct{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){const e=rt(t);if(nt(t)||it(t)){const n=this._automationEvents.findIndex((n=>it(t)&&Q(n)?n.startTime+n.duration>=e:rt(n)>=e)),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),nt(t)){const t=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&K(i)){if(void 0!==t&&lt(t))throw new Error("The internal list is malformed.");const n=void 0===t?i.insertTime:Q(t)?t.startTime+t.duration:rt(t),r=void 0===t?this._defaultValue:Q(t)?t.values[t.values.length-1]:t.value,s=X(i)?st(e,n,r,i):ot(e,n,r,i),o=X(i)?U(s,e,this._currenTime):q(s,e,this._currenTime);this._automationEvents.push(o)}if(void 0!==t&&lt(t)&&this._automationEvents.push(H(this.getValue(e),e)),void 0!==t&&Q(t)&&t.startTime+t.duration>e){const n=e-t.startTime,i=(t.values.length-1)/t.duration,r=Math.max(2,1+Math.ceil(n*i)),s=n/(r-1)*i,o=t.values.slice(0,r);if(s<1)for(let e=1;e<r;e+=1){const n=s*e%1;o[e]=t.values[e-1]*(1-n)+t.values[e]*n}this._automationEvents[this._automationEvents.length-1]=G(o,t.startTime,n)}}}else{const n=this._automationEvents.findIndex((t=>rt(t)>e)),i=-1===n?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(void 0!==i&&Q(i)&&rt(i)+i.duration>e)return!1;const r=X(t)?U(t.value,t.endTime,this._currenTime):Z(t)?q(t.value,e,this._currenTime):t;if(-1===n)this._automationEvents.push(r);else{if(Q(t)&&e+t.duration>rt(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,r)}}return!0}flush(t){const e=this._automationEvents.findIndex((e=>rt(e)>t));if(e>1){const t=this._automationEvents.slice(e-1),n=t[0];lt(n)&&t.unshift(H(tt(this._automationEvents,e-2,n.startTime,this._defaultValue),n.startTime)),this._automationEvents=t}}getValue(t){if(0===this._automationEvents.length)return this._defaultValue;const e=this._automationEvents.findIndex((e=>rt(e)>t)),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,r=this._automationEvents[i];if(void 0!==r&&lt(r)&&(void 0===n||!K(n)||n.insertTime>t))return Y(t,tt(this._automationEvents,i-1,r.startTime,this._defaultValue),r);if(void 0!==r&&J(r)&&(void 0===n||!K(n)))return r.value;if(void 0!==r&&Q(r)&&(void 0===n||!K(n)||r.startTime+r.duration>t))return t<r.startTime+r.duration?at(t,r):r.values[r.values.length-1];if(void 0!==r&&K(r)&&(void 0===n||!K(n)))return r.value;if(void 0!==n&&X(n)){const[e,s]=et(this._automationEvents,i,r,n,this._defaultValue);return st(t,e,s,n)}if(void 0!==n&&Z(n)){const[e,s]=et(this._automationEvents,i,r,n,this._defaultValue);return ot(t,e,s,n)}return this._defaultValue}}const ut=new WeakSet,ht=new WeakMap,dt=new WeakMap,pt=new WeakMap,mt=new WeakMap,ft=new WeakMap,gt=new WeakMap,_t=new WeakMap,vt=new WeakMap,yt=new WeakMap,wt={construct:()=>wt},bt=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Tt=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),r=i.match(bt);for(;null!==r;){const t=r[1].slice(1,-1),s=r[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(s),i=i.slice(r[0].length).replace(/^[\s]+/,""),r=i.match(bt)}return[n.join(";"),i]},Et=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},xt=t=>{if(!(t=>{try{new new Proxy(t,wt)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},At=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},Ct=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[i]=n;return t.delete(i),i},St=(t,e,n,i)=>{const r=At(t,e),s=Ct(r,(t=>t[0]===n&&t[1]===i));return 0===r.size&&t.delete(e),s},kt=t=>At(gt,t),Ot=t=>{if(ut.has(t))throw new Error("The AudioNode is already stored.");ut.add(t),kt(t).forEach((t=>t(!0)))},Mt=t=>"port"in t,Dt=t=>{if(!ut.has(t))throw new Error("The AudioNode is not stored.");ut.delete(t),kt(t).forEach((t=>t(!1)))},Pt=(t,e)=>{!Mt(t)&&e.every((t=>0===t.size))&&Dt(t)},It={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Ft=(t,e)=>t.context===e,Rt=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Nt=()=>new DOMException("","IndexSizeError"),Lt=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(i){if(12===i.code)throw Nt();throw i}})},jt={numberOfChannels:1},Vt=-34028234663852886e22,Bt=-Vt,$t=t=>ut.has(t),Wt={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},zt=t=>At(ht,t),Ut=t=>At(pt,t),qt=(t,e)=>{const{activeInputs:n}=zt(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||qt(n,[...e,t])}))));const i=(t=>"playbackRate"in t)(t)?[t.playbackRate]:Mt(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t&&!("gain"in t))(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const r of i){const t=Ut(r);void 0!==t&&t.activeInputs.forEach((([t])=>qt(t,e)))}$t(t)&&Dt(t)},Ht=t=>{qt(t.destination,[])},Gt=t=>"context"in t,Yt=t=>Gt(t[0]),Xt=(t,e,n,i)=>{for(const r of t)if(n(r)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},Zt=(t,e,[n,i],r)=>{Xt(t,[e,n,i],(t=>t[0]===e&&t[1]===n),r)},Kt=(t,[e,n,i],r)=>{const s=t.get(e);void 0===s?t.set(e,new Set([[n,i]])):Xt(s,[n,i],(t=>t[0]===n),r)},Jt=t=>"inputs"in t,Qt=(t,e,n,i)=>{if(Jt(e)){const r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},te=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},ee=(t,e)=>{if(!kt(t).delete(e))throw new Error("Missing the expected event listener.")},ne=(t,e,n)=>{const i=At(t,e),r=Ct(i,(t=>t[0]===n));return 0===i.size&&t.delete(e),r},ie=(t,e,n,i)=>{Jt(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},re=t=>At(dt,t),se=t=>At(mt,t),oe=t=>_t.has(t),ae=t=>!ut.has(t),le=(t,e)=>new Promise((n=>{if(null!==e)n(!0);else{const e=t.createScriptProcessor(256,1,1),i=t.createGain(),r=t.createBuffer(1,2,44100),s=r.getChannelData(0);s[0]=1,s[1]=1;const o=t.createBufferSource();o.buffer=r,o.loop=!0,o.connect(e).connect(t.destination),o.connect(i),o.disconnect(i),e.onaudioprocess=i=>{const r=i.inputBuffer.getChannelData(0);Array.prototype.some.call(r,(t=>1===t))?n(!0):n(!1),o.stop(),e.onaudioprocess=null,o.disconnect(e),e.disconnect(t.destination)},o.start()}})),ce=(t,e)=>{const n=new Map;for(const i of t)for(const t of i){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},ue=t=>"context"in t,he=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=Ut(e),{outputs:o}=zt(t),a=kt(t),l=o=>{const a=re(t),l=se(e);if(o){const e=ne(s,t,n);Zt(r,t,e,!1),i||oe(t)||a.connect(l,n)}else{const e=((t,e,n)=>Ct(t,(t=>t[0]===e&&t[1]===n)))(r,t,n);Kt(s,e,!1),i||oe(t)||a.disconnect(l,n)}};return!!Xt(o,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(l),$t(t)?Zt(r,t,[n,l],!0):Kt(s,[t,n,l],!0),!0)},de=(t,e,n,i,r)=>{const[s,o]=((t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=zt(e),o=te(r[i],t,n);if(null===o)return[St(s,t,n,i)[2],!1];return[o[2],!0]})(t,n,i,r);if(null!==s&&(ee(t,s),!o||e||oe(t)||ie(re(t),re(n),i,r)),$t(n)){const{activeInputs:t}=zt(n);Pt(n,t)}},pe=(t,e,n,i)=>{const[r,s]=((t,e,n)=>{const{activeInputs:i,passiveInputs:r}=Ut(e),s=te(i,t,n);if(null===s)return[ne(r,t,n)[1],!1];return[s[2],!0]})(t,n,i);null!==r&&(ee(t,r),!s||e||oe(t)||re(t).disconnect(se(n),i))};class me{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,i)=>t.call(e,n,i,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const fe={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function ge(t,e,n,i,r){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{const s=t.getChannelData(i);if(0===e[n].byteLength)e[n]=s.slice(r,r+128);else{const t=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const _e=(t,e,n,i,r)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,r):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],r)},ve=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const t=[],r="number"==typeof e?e:e[i];for(let e=0;e<r;e+=1)t.push(new Float32Array(128));n.push(t)}return n},ye=async(t,e,n,i,r,s,o)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,l=i.channelCount*i.numberOfInputs,c=r.reduce(((t,e)=>t+e),0),u=0===c?null:n.createBuffer(c,a,n.sampleRate);if(void 0===s)throw new Error("Missing the processor constructor.");const h=zt(t),d=await((t,e)=>{const n=At(yt,t),i=re(e);return At(n,i)})(n,t),p=ve(i.numberOfInputs,i.channelCount),m=ve(i.numberOfOutputs,r),f=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let _=0;_<a;_+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)ge(e,p[t],n,n,_);void 0!==s.parameterDescriptors&&null!==e&&s.parameterDescriptors.forEach((({name:t},n)=>{ge(e,f,t,l+n,_)}));for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<r[t];e+=1)0===m[t][e].byteLength&&(m[t][e]=new Float32Array(128));try{const t=p.map(((t,e)=>0===h.activeInputs[e].size?[]:t)),e=o(_/n.sampleRate,n.sampleRate,(()=>d.process(t,m,f)));if(null!==u)for(let n=0,s=0;n<i.numberOfOutputs;n+=1){for(let t=0;t<r[n];t+=1)_e(u,m[n],t,s+t,_);s+=r[n]}if(!e)break}catch(g){t.dispatchEvent(new ErrorEvent("processorerror",{colno:g.colno,filename:g.filename,lineno:g.lineno,message:g.message}));break}}return u},we={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},be={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Te={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Ee={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},xe={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ae=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise((i=>{const r=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>r();try{e.postMessage(t,[t])}catch{}finally{r()}}))},Ce={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Se=(t,e,n)=>{const i=e[n];if(void 0===i)throw t();return i},ke={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Oe={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Me=()=>new DOMException("","InvalidStateError"),De=()=>new DOMException("","InvalidAccessError"),Pe={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Ie=(t,e,n,i,r,s,o,a,l,c,u)=>{const h=c.length;let d=a;for(let p=0;p<h;p+=1){let a=n[0]*c[p];for(let e=1;e<r;e+=1){const i=d-e&l-1;a+=n[e]*s[i],a-=t[e]*o[i]}for(let t=r;t<i;t+=1)a+=n[t]*s[d-t&l-1];for(let n=r;n<e;n+=1)a-=t[n]*o[d-n&l-1];s[d]=c[p],o[d]=a,d=d+1&l-1,u[p]=a}return d},Fe={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Re=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},Ne=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},Le=(t,e)=>{Ne(t,e,"channelCount"),Ne(t,e,"channelCountMode"),Ne(t,e,"channelInterpretation")},je=t=>"function"==typeof t.getFloatTimeDomainData,Ve=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},Be=t=>{var e;t.start=(e=t.start,(n=0,i=0,r)=>{if("number"==typeof r&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})},$e=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},We=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),ze=async(t,e)=>{const n=await(t=>new Promise(((e,n)=>{const{port1:i,port2:r}=new MessageChannel;i.onmessage=({data:t})=>{i.close(),r.close(),e(t)},i.onmessageerror=({data:t})=>{i.close(),r.close(),n(t)},r.postMessage(t)})))(e);return new t(n)},Ue=(t,e)=>{const n=t.createBiquadFilter();return Le(n,e),Ve(n,e,"Q"),Ve(n,e,"detune"),Ve(n,e,"frequency"),Ve(n,e,"gain"),Ne(n,e,"type"),n},qe=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Le(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Me()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw Me()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw Me()}})})(n),n},He=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Ge=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Le(n,e),Ve(n,e,"delayTime"),n},Ye=(t,e)=>{const n=t.createGain();return Le(n,e),Ve(n,e,"gain"),n};function Xe(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Ze(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function Ke(t,e){let n=[0,0];for(let i=t.length-1;i>=0;i-=1)n=Ze(n,e),n[0]+=t[i];return n}const Je=(t,e,n,i)=>t.createScriptProcessor(e,n,i),Qe=()=>new DOMException("","NotSupportedError"),tn={numberOfChannels:1},en={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},nn={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},rn={disableNormalization:!1},sn={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},on={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},an=(t,e,n)=>void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),ln=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},cn=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:s,set:o}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(o)})},un=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;un(t,e,n+1e-7)}},hn=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},dn=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},pn=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},mn=(t,e)=>{const n=e.createGain();t.connect(n);const i=(e=>()=>{e.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),He(t,n),t.stop=(e=>{let i=!1;return(r=0)=>{if(i)try{e.call(t,r)}catch{n.gain.setValueAtTime(0,r)}else e.call(t,r),i=!0}})(t.stop)},fn=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},gn=(t=>(e,n,[i,r,s],o)=>{t(e[r],[n,i,s],(t=>t[0]===n&&t[1]===i),o)})(Xt),_n=(t=>(e,n,[i,r,s],o)=>{const a=e.get(i);void 0===a?e.set(i,new Set([[r,n,s]])):t(a,[r,n,s],(t=>t[0]===r&&t[1]===n),o)})(Xt),vn=(t=>(e,n,i,r)=>t(e[r],(t=>t[0]===n&&t[1]===i)))(Ct),yn=new WeakMap,wn=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(yn),bn=(Tn=new Map,En=new WeakMap,(t,e)=>{const n=En.get(t);if(void 0!==n)return n;const i=Tn.get(t);if(void 0!==i)return i;try{const n=e();return n instanceof Promise?(Tn.set(t,n),n.catch((()=>!1)).then((e=>(Tn.delete(t),En.set(t,e),e)))):(En.set(t,n),n)}catch{return En.set(t,!1),!1}});var Tn,En;const xn="undefined"==typeof window?null:window,An=((t,e)=>(n,i)=>{const r=n.createAnalyser();if(Le(r,i),!(i.maxDecibels>i.minDecibels))throw e();return Ne(r,i,"fftSize"),Ne(r,i,"maxDecibels"),Ne(r,i,"minDecibels"),Ne(r,i,"smoothingTimeConstant"),t(je,(()=>je(r)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=.0078125*(n[t]-128);return e}})(r),r})(bn,Nt),Cn=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(zt),Sn=((t,e,n)=>async(i,r,s)=>{const o=t(i);await Promise.all(o.activeInputs.map(((t,o)=>Array.from(t).map((async([t,a])=>{const l=e(t),c=await l.render(t,r),u=i.context.destination;n(t)||i===u&&n(i)||c.connect(s,a,o)})))).reduce(((t,e)=>[...t,...e]),[]))})(zt,Cn,oe),kn=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ft(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(An,re,Sn),On=(Mn=ft,t=>{const e=Mn.get(t);if(void 0===e)throw Me();return e});var Mn;const Dn=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(xn),Pn=(t=>e=>null!==t&&e instanceof t)(Dn),In=new WeakMap,Fn=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,i){if(null!==n){let r=this._listeners.get(n);void 0===r&&(r=t(this,n),"function"==typeof n&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(e,r,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}})(fn),Rn=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(xn),Nn=(t=>e=>null!==t&&e instanceof t)(Rn),Ln=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(xn),jn=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(xn),Vn=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(xn),Bn=((t,e,n,i,r,s,o,a,l,c,u,h,d,p,m,f)=>class extends c{constructor(e,i,r,s){super(r),this._context=e,this._nativeAudioNode=r;const o=u(e);h(o)&&!0!==n(le,(()=>le(o,f)))&&(t=>{const e=new Map;t.connect=(t=>(n,i=0,r=0)=>{const s=ue(n)?t(n,i,r):t(n,i),o=e.get(n);return void 0===o?e.set(n,[{input:r,output:i}]):o.every((t=>t.input!==r||t.output!==i))&&o.push({input:r,output:i}),s})(t.connect.bind(t)),t.disconnect=(n=>(i,r,s)=>{if(n.apply(t),void 0===i)e.clear();else if("number"==typeof i)for(const[t,n]of e){const r=n.filter((t=>t.output!==i));0===r.length?e.delete(t):e.set(t,r)}else if(e.has(i))if(void 0===r)e.delete(i);else{const t=e.get(i);if(void 0!==t){const n=t.filter((t=>t.output!==r&&(t.input!==s||void 0===s)));0===n.length?e.delete(i):e.set(i,n)}}for(const[n,o]of e)o.forEach((e=>{ue(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)})(r),dt.set(this,r),gt.set(this,new Set),"closed"!==e.state&&i&&Ot(this),t(this,s,r)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();const c=u(this._context),h=m(c);if(d(t)||p(t))throw s();if(Gt(t)){const r=re(t);try{const e=Qt(this._nativeAudioNode,r,n,a),i=ae(this);(h||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&ae(t)&&Ot(t)}catch(g){if(12===g.code)throw s();throw g}if(e(this,t,n,a,h)){const e=l([this],t);ce(e,i(h))}return t}const f=se(t);if("playbackRate"===f.name&&1024===f.maxValue)throw o();try{this._nativeAudioNode.connect(f,n),(h||ae(this))&&this._nativeAudioNode.disconnect(f,n)}catch(g){if(12===g.code)throw s();throw g}if(he(this,t,n,h)){const e=l([this],t);ce(e,i(h))}}disconnect(t,e,n){let i;const o=u(this._context),c=m(o);if(void 0===t)i=((t,e)=>{const n=zt(t),i=[];for(const r of n.outputs)Yt(r)?de(t,e,...r):pe(t,e,...r),i.push(r[0]);return n.outputs.clear(),i})(this,c);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw r();i=((t,e,n)=>{const i=zt(t),r=[];for(const s of i.outputs)s[1]===n&&(Yt(s)?de(t,e,...s):pe(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r})(this,c,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw r();if(Gt(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw r();if(i=((t,e,n,i,r)=>{const s=zt(t);return Array.from(s.outputs).filter((t=>!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==r&&t[2]!==r))).map((n=>(Yt(n)?de(t,e,...n):pe(t,e,...n),s.outputs.delete(n),n[0])))})(this,c,t,e,n),0===i.length)throw s()}for(const r of i){const t=l([this],r);ce(t,a)}}})(($n=ht,(t,e,n)=>{const i=[];for(let r=0;r<n.numberOfInputs;r+=1)i.push(new Set);$n.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,i,r,s,o,a,l,c,u,h,d)=>{const p=new WeakMap;return(m,f,g,_,v)=>{const{activeInputs:y,passiveInputs:w}=s(f),{outputs:b}=s(m),T=a(m),E=s=>{const a=l(f),c=l(m);if(s){const e=St(w,m,g,_);t(y,m,e,!1),v||h(m)||n(c,a,g,_),d(f)&&Ot(f)}else{const t=i(y,m,g,_);e(w,_,t,!1),v||h(m)||r(c,a,g,_);const n=o(f);if(0===n)u(f)&&Pt(f,y);else{const t=p.get(f);void 0!==t&&clearTimeout(t),p.set(f,setTimeout((()=>{u(f)&&Pt(f,y)}),1e3*n))}}};return!!c(b,[f,g,_],(t=>t[0]===f&&t[1]===g&&t[2]===_),!0)&&(T.add(E),u(m)?t(y,m,[g,_,E],!0):e(w,_,[m,g,E],!0),!0)}})(gn,_n,Qt,vn,ie,zt,wn,kt,re,Xt,$t,oe,ae),bn,((t,e,n,i,r,s)=>o=>(a,l)=>{const c=t.get(a);if(void 0===c){if(!o&&s(a)){const t=i(a),{outputs:s}=n(a);for(const n of s)if(Yt(n)){const r=i(n[0]);e(t,r,n[1],n[2])}else{const e=r(n[0]);t.disconnect(e,n[1])}}t.set(a,l)}else t.set(a,c+l)})(_t,ie,zt,re,se,$t),Nt,De,Qe,((t,e,n,i,r,s,o,a)=>(l,c)=>{const u=e.get(l);if(void 0===u)throw new Error("Missing the expected cycle count.");const h=s(l.context),d=a(h);if(u===c){if(e.delete(l),!d&&o(l)){const e=i(l),{outputs:s}=n(l);for(const n of s)if(Yt(n)){const r=i(n[0]);t(e,r,n[1],n[2])}else{const t=r(n[0]);e.connect(t,n[1])}}}else e.set(l,u-c)})(Qt,_t,zt,re,se,On,$t,Pn),((t,e,n)=>function i(r,s){const o=Gt(s)?s:n(t,s);if((t=>"delayTime"in t)(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map((t=>i([...r,o],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(In,zt,At),Fn,On,Nn,Ln,jn,Pn,Vn);var $n;const Wn=((t,e,n,i,r,s)=>class extends t{constructor(t,n){const o=r(t),a={...It,...n},l=i(o,a);super(t,!1,l,s(o)?e():null),this._nativeAnalyserNode=l}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(Bn,kn,Nt,An,On,Pn),zn=new WeakSet,Un=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(xn),qn=(Hn=new Uint32Array(1),t=>(Hn[0]=t,Hn[0]));var Hn;const Gn=((t,e)=>n=>{n.copyFromChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const l=n.length,c=n.getChannelData(a),u=i.length;for(let t=o<0?-o:0;t+o<l&&t<u;t+=1)i[t]=c[t+o]},n.copyToChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const l=n.length,c=n.getChannelData(a),u=i.length;for(let t=o<0?-o:0;t+o<l&&t<u;t+=1)c[t+o]=i[t]}})(qn,Nt),Yn=(t=>e=>{e.copyFromChannel=(n=>(i,r,s=0)=>{const o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(i,r,s=0)=>{const o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o)})(e.copyToChannel)})(qn),Xn=((t,e,n,i,r,s,o,a)=>{let l=null;return class c{constructor(c){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:h,sampleRate:d}={...jt,...c};null===l&&(l=new r(1,1,44100));const p=null!==i&&e(s,s)?new i({length:u,numberOfChannels:h,sampleRate:d}):l.createBuffer(h,u,d);if(0===p.numberOfChannels)throw n();return"function"!=typeof p.copyFromChannel?(o(p),Lt(p)):e(Rt,(()=>Rt(p)))||a(p),t.add(p),p}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===c.prototype||t.has(e)}}})(zn,bn,Qe,Un,Dn,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(Un),Gn,Yn),Zn=(t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(i),i.disconnect()};n.addEventListener("ended",r)})(Ye),Kn=((t,e,n)=>async(i,r,s)=>{const o=e(i);await Promise.all(Array.from(o.activeInputs).map((async([e,i])=>{const o=t(e),a=await o.render(e,r);n(e)||a.connect(s,i)})))})(Cn,Ut,oe),Jn=(t=>(e,n,i)=>t(n,e,i))(Kn),Qn=((t,e,n,i,r,s,o,a,l,c,u)=>(h,d)=>{const p=h.createBufferSource();return Le(p,d),Ve(p,d,"playbackRate"),Ne(p,d,"buffer"),Ne(p,d,"loop"),Ne(p,d,"loopEnd"),Ne(p,d,"loopStart"),e(n,(()=>n(h)))||(t=>{t.start=(e=>{let n=!1;return(i=0,r=0,s)=>{if(n)throw Me();e.call(t,i,r,s),n=!0}})(t.start)})(p),e(i,(()=>i(h)))||l(p),e(r,(()=>r(h)))||c(p,h),e(s,(()=>s(h)))||Be(p),e(o,(()=>o(h)))||u(p,h),e(a,(()=>a(h)))||$e(p),t(h,p),p})(Zn,bn,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),hn,dn,pn,(t=>{var e;t.start=(e=t.start,(n=0,i=0,r)=>{const s=t.buffer,o=null===s?i:Math.min(s.duration,i);null!==s&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,r)})}),(t=>(e,n)=>{const i=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=i),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===i?null:n}),(t=>n=>t.call(e,null===n?i:n)))})(cn),mn),ti=((t,e)=>(n,i,r)=>(t(i).replay(r),e(i,n,r)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(Ut),Kn),ei=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(l,c){const u=s.get(c);return void 0!==u?Promise.resolve(u):(async(l,c)=>{let u=n(l);const h=Ft(u,c);if(!h){const t={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,loop:u.loop,loopEnd:u.loopEnd,loopStart:u.loopStart,playbackRate:u.playbackRate.value};u=e(c,t),null!==o&&u.start(...o),null!==a&&u.stop(a)}return s.set(c,u),h?await t(c,l.playbackRate,u.playbackRate):await i(c,l.playbackRate,u.playbackRate),await r(l,c,u),u})(l,c)}}})(Jn,Qn,re,ti,Sn),ni=((t,e,n,i,r,s,o,a,l,c,u,h,d)=>(p,m,f,g=null,_=null)=>{const v=f.value,y=new ct(v),w=m?i(y):null,b={get defaultValue(){return v},get maxValue(){return null===g?f.maxValue:g},get minValue(){return null===_?f.minValue:_},get value(){return f.value},set value(t){f.value=t,b.setValueAtTime(t,p.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof f.cancelAndHoldAtTime)null===w&&y.flush(p.context.currentTime),y.add(r(t)),f.cancelAndHoldAtTime(t);else{const e=Array.from(y).pop();null===w&&y.flush(p.context.currentTime),y.add(r(t));const n=Array.from(y).pop();f.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?f.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?f.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?f.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&f.setValueCurveAtTime(n.values,n.startTime,n.duration))}return b},cancelScheduledValues:t=>(null===w&&y.flush(p.context.currentTime),y.add(s(t)),f.cancelScheduledValues(t),b),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;const n=p.context.currentTime;return null===w&&y.flush(n),0===Array.from(y).length&&(y.add(c(v,n)),f.setValueAtTime(v,n)),y.add(o(t,e)),f.exponentialRampToValueAtTime(t,e),b},linearRampToValueAtTime(t,e){const n=p.context.currentTime;return null===w&&y.flush(n),0===Array.from(y).length&&(y.add(c(v,n)),f.setValueAtTime(v,n)),y.add(a(t,e)),f.linearRampToValueAtTime(t,e),b},setTargetAtTime:(t,e,n)=>(null===w&&y.flush(p.context.currentTime),y.add(l(t,e,n)),f.setTargetAtTime(t,e,n),b),setValueAtTime:(t,e)=>(null===w&&y.flush(p.context.currentTime),y.add(c(t,e)),f.setValueAtTime(t,e),b),setValueCurveAtTime(t,e,n){const i=t instanceof Float32Array?t:new Float32Array(t);if(null!==h&&"webkitAudioContext"===h.name){const t=e+n,r=p.context.sampleRate,s=Math.ceil(e*r),o=Math.floor(t*r),a=o-s,l=new Float32Array(a);for(let u=0;u<a;u+=1){const t=(i.length-1)/n*((s+u)/r-e),o=Math.floor(t),a=Math.ceil(t);l[u]=o===a?i[o]:(1-(t-o))*i[o]+(1-(a-t))*i[a]}null===w&&y.flush(p.context.currentTime),y.add(u(l,e,n)),f.setValueCurveAtTime(l,e,n);const c=o/r;c<t&&d(b,l[l.length-1],c),d(b,i[i.length-1],t)}else null===w&&y.flush(p.context.currentTime),y.add(u(i,e,n)),f.setValueCurveAtTime(i,e,n);return b}};return n.set(b,f),e.set(b,p),t(b,w),b})((ii=pt,(t,e)=>{ii.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),In,mt,(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t)}else if("setTarget"===n.type){const{startTime:t,target:i,timeConstant:r}=n;e.setTargetAtTime(i,t,r)}else if("setValue"===n.type){const{startTime:t,value:i}=n;e.setValueAtTime(i,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:i,values:r}=n;e.setValueCurveAtTime(r,i,t)}}}})),(t=>({cancelTime:t,type:"cancelAndHold"})),(t=>({cancelTime:t,type:"cancelScheduledValues"})),((t,e)=>({endTime:e,type:"exponentialRampToValue",value:t})),((t,e)=>({endTime:e,type:"linearRampToValue",value:t})),((t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"})),H,G,Rn,un);var ii;const ri=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,i){const a=s(t),l={...Wt,...i},c=r(a,l),u=o(a),h=u?e():null;super(t,!1,c,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==l.buffer,this._nativeAudioBufferSourceNode=c,this._onended=null,this._playbackRate=n(this,u,c.playbackRate,Bt,Vt)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){Ot(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),$t(this)&&Dt(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(Bn,ei,ni,Me,Qn,On,Pn,fn),si=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,n){const i=s(t),l=o(i),c=r(i,n,l);super(t,!1,c,l?e(a):null),this._isNodeOfNativeOfflineAudioContext=l,this._nativeAudioDestinationNode=c}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Bn,(t=>{const e=new WeakMap;return{render(n,i){const r=e.get(i);return void 0!==r?Promise.resolve(r):(async(n,i)=>{const r=i.destination;return e.set(i,r),await t(n,i,r),r})(n,i)}}}),Nt,Me,((t,e)=>(n,i,r)=>{const s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch{}r&&"explicit"!==s.channelCountMode&&(s.channelCountMode="explicit"),0===s.maxChannelCount&&Object.defineProperty(s,"maxChannelCount",{value:i});const o=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e);try{s.channelCount=e}catch(n){if(e>s.maxChannelCount)throw n}})),e(o,"channelCountMode",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelCountMode=e})),e(o,"channelInterpretation",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelInterpretation=e})),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o})(Ye,cn),On,Pn,Sn),oi=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const l=s.get(a);return void 0!==l?Promise.resolve(l):(async(o,a)=>{let l=n(o);const c=Ft(l,a);if(!c){const t={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(a,t)}return s.set(a,l),c?(await t(a,o.Q,l.Q),await t(a,o.detune,l.detune),await t(a,o.frequency,l.frequency),await t(a,o.gain,l.gain)):(await i(a,o.Q,l.Q),await i(a,o.detune,l.detune),await i(a,o.frequency,l.frequency),await i(a,o.gain,l.gain)),await r(o,a,l),l})(o,a)}}})(Jn,Ue,re,ti,Sn),ai=(t=>(e,n)=>t.set(e,n))(yn),li=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,i){const l=s(t),c={...we,...i},u=r(l,c),h=o(l);super(t,!1,u,h?n():null),this._Q=e(this,h,u.Q,Bt,Vt),this._detune=e(this,h,u.detune,1200*Math.log2(Bt),-1200*Math.log2(Bt)),this._frequency=e(this,h,u.frequency,t.sampleRate/2,0),this._gain=e(this,h,u.gain,40*Math.log10(Bt),Vt),this._nativeBiquadFilterNode=u,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(r){if(11===r.code)throw i();throw r}if(t.length!==e.length||e.length!==n.length)throw i()}})(Bn,ni,oi,De,Ue,On,Pn,ai),ci=((t,e)=>(n,i,r)=>{const s=new Set;return n.connect=(r=>(o,a=0,l=0)=>{const c=0===s.size;if(e(o))return r.call(n,o,a,l),t(s,[o,a,l],(t=>t[0]===o&&t[1]===a&&t[2]===l),!0),c&&i(),o;r.call(n,o,a),t(s,[o,a],(t=>t[0]===o&&t[1]===a),!0),c&&i()})(n.connect),n.disconnect=(t=>(i,o,a)=>{const l=s.size>0;if(void 0===i)t.apply(n),s.clear();else if("number"==typeof i){t.call(n,i);for(const t of s)t[1]===i&&s.delete(t)}else{e(i)?t.call(n,i,o,a):t.call(n,i,o);for(const t of s)t[0]!==i||void 0!==o&&t[1]!==o||void 0!==a&&t[2]!==a||s.delete(t)}const c=0===s.size;l&&c&&r()})(n.disconnect),n})(Xt,Ln),ui=((t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const r=n.createBufferSource();e(i,(()=>{const t=i.numberOfInputs;for(let e=0;e<t;e+=1)r.connect(i,0,e)}),(()=>r.disconnect(i)))})(Me,ci),hi=((t,e)=>(n,i)=>{const r=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,r),Le(r,i),r})(Rn,ui),di=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ft(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(hi,re,Sn),pi=((t,e,n,i,r)=>class extends t{constructor(t,s){const o=i(t),a={...be,...s};super(t,!1,n(o,a),r(o)?e():null)}})(Bn,di,hi,On,Pn),mi=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ft(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(qe,re,Sn),fi=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),l=s({...Te,...o});super(t,!1,n(a,l),r(a)?e():null)}})(Bn,mi,qe,On,Pn,(t=>({...t,channelCount:t.numberOfOutputs}))),gi=((t,e,n,i)=>(r,{offset:s,...o})=>{const a=r.createBuffer(1,2,44100),l=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(r,{...o,gain:s}),u=a.getChannelData(0);u[0]=1,u[1]=1,l.buffer=a,l.loop=!0;const h={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(t){c.channelCount=t},get channelCountMode(){return c.channelCountMode},set channelCountMode(t){c.channelCountMode=t},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(t){c.channelInterpretation=t},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(t){l.onended=t},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2]),start(t=0){l.start.call(l,t)},stop(t=0){l.stop.call(l,t)}};return t(r,l),i(He(h,c),(()=>l.connect(c)),(()=>l.disconnect(c)))})(Zn,Qn,Ye,ci),_i=((t,e,n,i,r)=>(s,o)=>{if(void 0===s.createConstantSource)return n(s,o);const a=s.createConstantSource();return Le(a,o),Ve(a,o,"offset"),e(i,(()=>i(s)))||Be(a),e(r,(()=>r(s)))||$e(a),t(s,a),a})(Zn,bn,gi,hn,pn),vi=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(l,c){const u=s.get(c);return void 0!==u?Promise.resolve(u):(async(l,c)=>{let u=n(l);const h=Ft(u,c);if(!h){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,offset:u.offset.value};u=e(c,t),null!==o&&u.start(o),null!==a&&u.stop(a)}return s.set(c,u),h?await t(c,l.offset,u.offset):await i(c,l.offset,u.offset),await r(l,c,u),u})(l,c)}}})(Jn,_i,re,ti,Sn),yi=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),l={...Ee,...o},c=i(a,l),u=s(a),h=u?n():null;super(t,!1,c,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=c,this._offset=e(this,u,c.offset,Bt,Vt),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){Ot(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),$t(this)&&Dt(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(Bn,ni,vi,_i,On,Pn,fn),wi=((t,e)=>(n,i)=>{const r=n.createConvolver();if(Le(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),Ne(r,i,"buffer"),i.channelCount>2)throw t();if(e(r,"channelCount",(t=>()=>t.call(r)),(e=>n=>{if(n>2)throw t();return e.call(r,n)})),"max"===i.channelCountMode)throw t();return e(r,"channelCountMode",(t=>()=>t.call(r)),(e=>n=>{if("max"===n)throw t();return e.call(r,n)})),r})(Qe,cn),bi=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ft(o,s)){const e={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(s,e)}return i.set(s,o),Jt(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o})(r,s)}}})(wi,re,Sn),Ti=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),l={...xe,...o},c=n(a,l);super(t,!1,c,r(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=c,null!==l.buffer&&s(this,l.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,t.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(Bn,bi,wi,On,Pn,ai),Ei=((t,e,n,i,r)=>s=>{const o=new WeakMap;return{render(a,l){const c=o.get(l);return void 0!==c?Promise.resolve(c):(async(a,l)=>{let c=n(a);const u=Ft(c,l);if(!u){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,delayTime:c.delayTime.value,maxDelayTime:s};c=e(l,t)}return o.set(l,c),u?await t(l,a.delayTime,c.delayTime):await i(l,a.delayTime,c.delayTime),await r(a,l,c),c})(a,l)}}})(Jn,Ge,re,ti,Sn),xi=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const l=r(t),c={...Ce,...a},u=i(l,c),h=s(l);super(t,!1,u,h?n(c.maxDelayTime):null),this._delayTime=e(this,h,u.delayTime),o(this,c.maxDelayTime)}get delayTime(){return this._delayTime}})(Bn,ni,Ei,Ge,On,Pn,ai),Ai=(t=>(e,n)=>{const i=e.createDynamicsCompressor();if(Le(i,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return Ve(i,n,"attack"),Ve(i,n,"knee"),Ve(i,n,"ratio"),Ve(i,n,"release"),Ve(i,n,"threshold"),i})(Qe),Ci=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const l=s.get(a);return void 0!==l?Promise.resolve(l):(async(o,a)=>{let l=n(o);const c=Ft(l,a);if(!c){const t={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(a,t)}return s.set(a,l),c?(await t(a,o.attack,l.attack),await t(a,o.knee,l.knee),await t(a,o.ratio,l.ratio),await t(a,o.release,l.release),await t(a,o.threshold,l.threshold)):(await i(a,o.attack,l.attack),await i(a,o.knee,l.knee),await i(a,o.ratio,l.ratio),await i(a,o.release,l.release),await i(a,o.threshold,l.threshold)),await r(o,a,l),l})(o,a)}}})(Jn,Ai,re,ti,Sn),Si=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,r){const l=s(t),c={...ke,...r},u=i(l,c),h=o(l);super(t,!1,u,h?n():null),this._attack=e(this,h,u.attack),this._knee=e(this,h,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=e(this,h,u.ratio),this._release=e(this,h,u.release),this._threshold=e(this,h,u.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Bn,ni,Ci,Ai,Qe,On,Pn,ai),ki=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const l=s.get(a);return void 0!==l?Promise.resolve(l):(async(o,a)=>{let l=n(o);const c=Ft(l,a);if(!c){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(a,t)}return s.set(a,l),c?await t(a,o.gain,l.gain):await i(a,o.gain,l.gain),await r(o,a,l),l})(o,a)}}})(Jn,Ye,re,ti,Sn),Oi=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),l={...Oe,...o},c=i(a,l),u=s(a);super(t,!1,c,u?n():null),this._gain=e(this,u,c.gain,Bt,Vt)}get gain(){return this._gain}})(Bn,ni,ki,Ye,On,Pn),Mi=((t,e,n,i)=>(r,s,{channelCount:o,channelCountMode:a,channelInterpretation:l,feedback:c,feedforward:u})=>{const h=We(s,r.sampleRate),d=c instanceof Float64Array?c:new Float64Array(c),p=u instanceof Float64Array?u:new Float64Array(u),m=d.length,f=p.length,g=Math.min(m,f);if(0===m||m>20)throw i();if(0===d[0])throw e();if(0===f||f>20)throw i();if(0===p[0])throw e();if(1!==d[0]){for(let t=0;t<f;t+=1)p[t]/=d[0];for(let t=1;t<m;t+=1)d[t]/=d[0]}const _=n(r,h,o,o);_.channelCount=o,_.channelCountMode=a,_.channelInterpretation=l;const v=[],y=[],w=[];for(let t=0;t<o;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),w.push(e)}_.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let r=0;r<i;r+=1){const t=e.getChannelData(r),i=n.getChannelData(r);v[r]=Ie(d,m,p,f,g,y[r],w[r],v[r],32,t,i)}};const b=r.sampleRate/2,T={get bufferSize(){return h},get channelCount(){return _.channelCount},set channelCount(t){_.channelCount=t},get channelCountMode(){return _.channelCountMode},set channelCountMode(t){_.channelCountMode=t},get channelInterpretation(){return _.channelInterpretation},set channelInterpretation(t){_.channelInterpretation=t},get context(){return _.context},get inputs(){return[_]},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},addEventListener:(...t)=>_.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>_.dispatchEvent(t[0]),getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();const r=e.length;for(let t=0;t<r;t+=1){const r=-Math.PI*(e[t]/b),s=[Math.cos(r),Math.sin(r)],o=Xe(Ke(p,s),Ke(d,s));n[t]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),i[t]=Math.atan2(o[1],o[0])}},removeEventListener:(...t)=>_.removeEventListener(t[0],t[1],t[2])};return He(T,_)})(De,Me,Je,Qe),Di=((t,e,n,i)=>r=>t(Re,(()=>Re(r)))?Promise.resolve(t(i,i)).then((t=>{if(!t){const t=n(r,512,0,1);r.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>r.currentTime,t.connect(r.destination)}return r.startRendering()})):new Promise((t=>{const n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(r.destination),r.startRendering()})))(bn,Ye,Je,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(Ye,Dn)),Pi=((t,e,n,i,r)=>(s,o)=>{const a=new WeakMap;let l=null;const c=async(c,u)=>{let h=null,d=e(c);const p=Ft(d,u);if(void 0===u.createIIRFilter?h=t(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(d=u.createIIRFilter(o,s)),a.set(u,null===h?d:h),null!==h){if(null===l){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(c.context.destination.channelCount,c.context.length,u.sampleRate);l=(async()=>{await i(c,t,t.destination);return((t,e,n,i)=>{const r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),o=r.length,a=s.length,l=Math.min(o,a);if(1!==r[0]){for(let t=0;t<o;t+=1)s[t]/=r[0];for(let t=1;t<a;t+=1)r[t]/=r[0]}const c=new Float32Array(32),u=new Float32Array(32),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let p=0;p<d;p+=1){const e=t.getChannelData(p),n=h.getChannelData(p);c.fill(0),u.fill(0),Ie(r,o,s,a,l,c,u,0,32,e,n)}return h})(await r(t),u,s,o)})()}const t=await l;return h.buffer=t,h.start(0),h}return await i(c,u,d),d};return{render(t,e){const n=a.get(e);return void 0!==n?Promise.resolve(n):c(t,e)}}})(Qn,re,Dn,Sn,Di),Ii=(t=>(e,n,i)=>{if(void 0===e.createIIRFilter)return t(e,n,i);const r=e.createIIRFilter(i.feedforward,i.feedback);return Le(r,i),r})(Mi),Fi=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),l=r(a),c={...Pe,...o},u=e(a,l?null:t.baseLatency,c);super(t,!1,u,l?n(c.feedback,c.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw De();return e.call(t,n,i,r)})})(u),this._nativeIIRFilterNode=u,s(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(Bn,Ii,Pi,On,Pn,ai),Ri=((t,e,n,i,r,s,o,a)=>(l,c)=>{const u=c.listener,{forwardX:h,forwardY:d,forwardZ:p,positionX:m,positionY:f,positionZ:g,upX:_,upY:v,upZ:y}=void 0===u.forwardX?(()=>{const h=new Float32Array(1),d=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),p=o(c);let m=!1,f=[0,0,-1,0,1,0],g=[0,0,0];const _=()=>{if(m)return;m=!0;const t=i(c,256,9,0);t.onaudioprocess=({inputBuffer:t})=>{const e=[s(t,h,0),s(t,h,1),s(t,h,2),s(t,h,3),s(t,h,4),s(t,h,5)];e.some(((t,e)=>t!==f[e]))&&(u.setOrientation(...e),f=e);const n=[s(t,h,6),s(t,h,7),s(t,h,8)];n.some(((t,e)=>t!==g[e]))&&(u.setPosition(...n),g=n)},d.connect(t)},v=t=>e=>{e!==f[t]&&(f[t]=e,u.setOrientation(...f))},y=t=>e=>{e!==g[t]&&(g[t]=e,u.setPosition(...g))},w=(e,i,s)=>{const o=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});o.connect(d,0,e),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:()=>i});const u=t({context:l},p,o.offset,Bt,Vt);var h,m,f,g,v,y,w;return a(u,"value",(t=>()=>t.call(u)),(t=>e=>{try{t.call(u,e)}catch(n){if(9!==n.code)throw n}_(),p&&s(e)})),u.cancelAndHoldAtTime=(h=u.cancelAndHoldAtTime,p?()=>{throw r()}:(...t)=>{const e=h.apply(u,t);return _(),e}),u.cancelScheduledValues=(m=u.cancelScheduledValues,p?()=>{throw r()}:(...t)=>{const e=m.apply(u,t);return _(),e}),u.exponentialRampToValueAtTime=(f=u.exponentialRampToValueAtTime,p?()=>{throw r()}:(...t)=>{const e=f.apply(u,t);return _(),e}),u.linearRampToValueAtTime=(g=u.linearRampToValueAtTime,p?()=>{throw r()}:(...t)=>{const e=g.apply(u,t);return _(),e}),u.setTargetAtTime=(v=u.setTargetAtTime,p?()=>{throw r()}:(...t)=>{const e=v.apply(u,t);return _(),e}),u.setValueAtTime=(y=u.setValueAtTime,p?()=>{throw r()}:(...t)=>{const e=y.apply(u,t);return _(),e}),u.setValueCurveAtTime=(w=u.setValueCurveAtTime,p?()=>{throw r()}:(...t)=>{const e=w.apply(u,t);return _(),e}),u};return{forwardX:w(0,0,v(0)),forwardY:w(1,0,v(1)),forwardZ:w(2,-1,v(2)),positionX:w(6,0,y(0)),positionY:w(7,0,y(1)),positionZ:w(8,0,y(2)),upX:w(3,0,v(3)),upY:w(4,1,v(4)),upZ:w(5,0,v(5))}})():u;return{get forwardX(){return h},get forwardY(){return d},get forwardZ(){return p},get positionX(){return m},get positionY(){return f},get positionZ(){return g},get upX(){return _},get upY(){return v},get upZ(){return y}}})(ni,hi,_i,Je,Qe,an,Pn,cn),Ni=new WeakMap,Li=((t,e,n,i,r,s)=>class extends n{constructor(n,s){super(n),this._nativeContext=n,ft.set(this,n),i(n)&&r.set(n,new Set),this._destination=new t(this,s),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?s(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(si,Ri,Fn,Pn,Ni,fn),ji=((t,e,n,i,r,s)=>(o,a)=>{const l=o.createOscillator();return Le(l,a),Ve(l,a,"detune"),Ve(l,a,"frequency"),void 0!==a.periodicWave?l.setPeriodicWave(a.periodicWave):Ne(l,a,"type"),e(n,(()=>n(o)))||Be(l),e(i,(()=>i(o)))||s(l,o),e(r,(()=>r(o)))||$e(l),t(o,l),l})(Zn,bn,hn,dn,pn,mn),Vi=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null,l=null;return{set periodicWave(t){o=t},set start(t){a=t},set stop(t){l=t},render(c,u){const h=s.get(u);return void 0!==h?Promise.resolve(h):(async(c,u)=>{let h=n(c);const d=Ft(h,u);if(!d){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:null===o?void 0:o,type:h.type};h=e(u,t),null!==a&&h.start(a),null!==l&&h.stop(l)}return s.set(u,h),d?(await t(u,c.detune,h.detune),await t(u,c.frequency,h.frequency)):(await i(u,c.detune,h.detune),await i(u,c.frequency,h.frequency)),await r(c,u,h),h})(c,u)}}})(Jn,ji,re,ti,Sn),Bi=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),l={...en,...o},c=n(a,l),u=s(a),h=u?i():null,d=t.sampleRate/2;super(t,!1,c,h),this._detune=e(this,u,c.detune,153600,-153600),this._frequency=e(this,u,c.frequency,d,-d),this._nativeOscillatorNode=c,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==l.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=l.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){Ot(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),$t(this)&&Dt(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(Bn,ni,ji,Vi,On,Pn,fn),$i=(t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}})(Qn),Wi=((t,e,n,i,r)=>(s,{curve:o,oversample:a,...l})=>{const c=s.createWaveShaper(),u=s.createWaveShaper();Le(c,l),Le(u,l);const h=n(s,{...l,gain:1}),d=n(s,{...l,gain:-1}),p=n(s,{...l,gain:1}),m=n(s,{...l,gain:-1});let f=null,g=!1,_=null;const v={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(t){h.channelCount=t,d.channelCount=t,c.channelCount=t,p.channelCount=t,u.channelCount=t,m.channelCount=t},get channelCountMode(){return c.channelCountMode},set channelCountMode(t){h.channelCountMode=t,d.channelCountMode=t,c.channelCountMode=t,p.channelCountMode=t,u.channelCountMode=t,m.channelCountMode=t},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t,d.channelInterpretation=t,c.channelInterpretation=t,p.channelInterpretation=t,u.channelInterpretation=t,m.channelInterpretation=t},get context(){return c.context},get curve(){return _},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)c.curve=n,u.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),i=new Float32Array(t+2-t%2);e[0]=n[0],i[0]=-n[t-1];const r=Math.ceil((t+1)/2),s=(t+1)/2-1;for(let o=1;o<r;o+=1){const a=o/r*s,l=Math.floor(a),c=Math.ceil(a);e[o]=l===c?n[l]:(1-(a-l))*n[l]+(1-(c-a))*n[c],i[o]=l===c?-n[t-1-l]:-(1-(a-l))*n[t-1-l]-(1-(c-a))*n[t-1-c]}e[r]=t%2==1?n[r-1]:(n[r-2]+n[r-1])/2,c.curve=e,u.curve=i}_=n,g&&(i(_)&&null===f?f=t(s,h):null!==f&&(f(),f=null))},get inputs(){return[h]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(t){c.oversample=t,u.oversample=t},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2])};null!==o&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a);return r(He(v,p),(()=>{h.connect(c).connect(p),h.connect(d).connect(u).connect(m).connect(p),g=!0,i(_)&&(f=t(s,h))}),(()=>{h.disconnect(c),c.disconnect(p),h.disconnect(d),d.disconnect(u),u.disconnect(m),m.disconnect(p),g=!1,null!==f&&(f(),f=null)}))})($i,Me,Ye,ln,ci),zi=((t,e,n,i,r,s,o)=>(a,l)=>{const c=a.createWaveShaper();if(null!==s&&"webkitAudioContext"===s.name&&void 0===a.createGain().gain.automationRate)return n(a,l);Le(c,l);const u=null===l.curve||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(null!==u&&u.length<2)throw e();Ne(c,{curve:u},"curve"),Ne(c,l,"oversample");let h=null,d=!1;o(c,"curve",(t=>()=>t.call(c)),(e=>n=>(e.call(c,n),d&&(i(n)&&null===h?h=t(a,c):i(n)||null===h||(h(),h=null)),n)));return r(c,(()=>{d=!0,i(c.curve)&&(h=t(a,c))}),(()=>{d=!1,null!==h&&(h(),h=null)}))})($i,Me,Wi,ln,ci,Rn,cn),Ui=((t,e,n,i,r,s,o,a,l,c)=>(u,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:p,distanceModel:m,maxDistance:f,orientationX:g,orientationY:_,orientationZ:v,panningModel:y,positionX:w,positionY:b,positionZ:T,refDistance:E,rolloffFactor:x,...A})=>{const C=u.createPanner();if(A.channelCount>2)throw o();if("max"===A.channelCountMode)throw o();Le(C,A);const S={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},k=n(u,{...S,channelInterpretation:"speakers",numberOfInputs:6}),O=i(u,{...A,gain:1}),M=i(u,{...S,gain:1}),D=i(u,{...S,gain:0}),P=i(u,{...S,gain:0}),I=i(u,{...S,gain:0}),F=i(u,{...S,gain:0}),R=i(u,{...S,gain:0}),N=r(u,256,6,1),L=s(u,{...S,curve:new Float32Array([1,1]),oversample:"none"});let j=[g,_,v],V=[w,b,T];const B=new Float32Array(1);N.onaudioprocess=({inputBuffer:t})=>{const e=[l(t,B,0),l(t,B,1),l(t,B,2)];e.some(((t,e)=>t!==j[e]))&&(C.setOrientation(...e),j=e);const n=[l(t,B,3),l(t,B,4),l(t,B,5)];n.some(((t,e)=>t!==V[e]))&&(C.setPosition(...n),V=n)},Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0});const $={get bufferSize(){},get channelCount(){return C.channelCount},set channelCount(t){if(t>2)throw o();O.channelCount=t,C.channelCount=t},get channelCountMode(){return C.channelCountMode},set channelCountMode(t){if("max"===t)throw o();O.channelCountMode=t,C.channelCountMode=t},get channelInterpretation(){return C.channelInterpretation},set channelInterpretation(t){O.channelInterpretation=t,C.channelInterpretation=t},get coneInnerAngle(){return C.coneInnerAngle},set coneInnerAngle(t){C.coneInnerAngle=t},get coneOuterAngle(){return C.coneOuterAngle},set coneOuterAngle(t){C.coneOuterAngle=t},get coneOuterGain(){return C.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();C.coneOuterGain=t},get context(){return C.context},get distanceModel(){return C.distanceModel},set distanceModel(t){C.distanceModel=t},get inputs(){return[O]},get maxDistance(){return C.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;C.maxDistance=t},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get orientationX(){return M.gain},get orientationY(){return D.gain},get orientationZ(){return P.gain},get panningModel(){return C.panningModel},set panningModel(t){C.panningModel=t},get positionX(){return I.gain},get positionY(){return F.gain},get positionZ(){return R.gain},get refDistance(){return C.refDistance},set refDistance(t){if(t<0)throw new RangeError;C.refDistance=t},get rolloffFactor(){return C.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;C.rolloffFactor=t},addEventListener:(...t)=>O.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>O.dispatchEvent(t[0]),removeEventListener:(...t)=>O.removeEventListener(t[0],t[1],t[2])};h!==$.coneInnerAngle&&($.coneInnerAngle=h),d!==$.coneOuterAngle&&($.coneOuterAngle=d),p!==$.coneOuterGain&&($.coneOuterGain=p),m!==$.distanceModel&&($.distanceModel=m),f!==$.maxDistance&&($.maxDistance=f),g!==$.orientationX.value&&($.orientationX.value=g),_!==$.orientationY.value&&($.orientationY.value=_),v!==$.orientationZ.value&&($.orientationZ.value=v),y!==$.panningModel&&($.panningModel=y),w!==$.positionX.value&&($.positionX.value=w),b!==$.positionY.value&&($.positionY.value=b),T!==$.positionZ.value&&($.positionZ.value=T),E!==$.refDistance&&($.refDistance=E),x!==$.rolloffFactor&&($.rolloffFactor=x),1===j[0]&&0===j[1]&&0===j[2]||C.setOrientation(...j),0===V[0]&&0===V[1]&&0===V[2]||C.setPosition(...V);return c(He($,C),(()=>{O.connect(C),t(O,L,0,0),L.connect(M).connect(k,0,0),L.connect(D).connect(k,0,1),L.connect(P).connect(k,0,2),L.connect(I).connect(k,0,3),L.connect(F).connect(k,0,4),L.connect(R).connect(k,0,5),k.connect(N).connect(u.destination)}),(()=>{O.disconnect(C),a(O,L,0,0),L.disconnect(M),M.disconnect(k),L.disconnect(D),D.disconnect(k),L.disconnect(P),P.disconnect(k),L.disconnect(I),I.disconnect(k),L.disconnect(F),F.disconnect(k),L.disconnect(R),R.disconnect(k),k.disconnect(N),N.disconnect(u.destination)}))})(Qt,Me,hi,Ye,Je,zi,Qe,ie,an,ci),qi=(t=>(e,n)=>{const i=e.createPanner();return void 0===i.orientationX?t(e,n):(Le(i,n),Ve(i,n,"orientationX"),Ve(i,n,"orientationY"),Ve(i,n,"orientationZ"),Ve(i,n,"positionX"),Ve(i,n,"positionY"),Ve(i,n,"positionZ"),Ne(i,n,"coneInnerAngle"),Ne(i,n,"coneOuterAngle"),Ne(i,n,"coneOuterGain"),Ne(i,n,"distanceModel"),Ne(i,n,"maxDistance"),Ne(i,n,"panningModel"),Ne(i,n,"refDistance"),Ne(i,n,"rolloffFactor"),i)})(Ui),Hi=((t,e,n,i,r,s,o,a,l,c)=>()=>{const u=new WeakMap;let h=null;return{render(d,p){const m=u.get(p);return void 0!==m?Promise.resolve(m):(async(d,p)=>{let m=null,f=s(d);const g={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation},_={...g,coneInnerAngle:f.coneInnerAngle,coneOuterAngle:f.coneOuterAngle,coneOuterGain:f.coneOuterGain,distanceModel:f.distanceModel,maxDistance:f.maxDistance,panningModel:f.panningModel,refDistance:f.refDistance,rolloffFactor:f.rolloffFactor},v=Ft(f,p);if("bufferSize"in f)m=i(p,{...g,gain:1});else if(!v){const t={..._,orientationX:f.orientationX.value,orientationY:f.orientationY.value,orientationZ:f.orientationZ.value,positionX:f.positionX.value,positionY:f.positionY.value,positionZ:f.positionZ.value};f=r(p,t)}if(u.set(p,null===m?f:m),null!==m){if(null===h){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new o(6,d.context.length,p.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),h=(async()=>{const e=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map((async(e,i)=>{const r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0});return await a(t,e,r.offset),r})));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return c(t)})()}const t=await h,s=i(p,{...g,gain:1});await l(d,p,s);const u=[];for(let e=0;e<t.numberOfChannels;e+=1)u.push(t.getChannelData(e));let f=[u[0][0],u[1][0],u[2][0]],v=[u[3][0],u[4][0],u[5][0]],y=i(p,{...g,gain:1}),w=r(p,{..._,orientationX:f[0],orientationY:f[1],orientationZ:f[2],positionX:v[0],positionY:v[1],positionZ:v[2]});s.connect(y).connect(w.inputs[0]),w.connect(m);for(let e=128;e<t.length;e+=128){const t=[u[0][e],u[1][e],u[2][e]],n=[u[3][e],u[4][e],u[5][e]];if(t.some(((t,e)=>t!==f[e]))||n.some(((t,e)=>t!==v[e]))){f=t,v=n;const o=e/p.sampleRate;y.gain.setValueAtTime(0,o),y=i(p,{...g,gain:0}),w=r(p,{..._,orientationX:f[0],orientationY:f[1],orientationZ:f[2],positionX:v[0],positionY:v[1],positionZ:v[2]}),y.gain.setValueAtTime(1,o),s.connect(y).connect(w.inputs[0]),w.connect(m)}}return m}return v?(await t(p,d.orientationX,f.orientationX),await t(p,d.orientationY,f.orientationY),await t(p,d.orientationZ,f.orientationZ),await t(p,d.positionX,f.positionX),await t(p,d.positionY,f.positionY),await t(p,d.positionZ,f.positionZ)):(await a(p,d.orientationX,f.orientationX),await a(p,d.orientationY,f.orientationY),await a(p,d.orientationZ,f.orientationZ),await a(p,d.positionX,f.positionX),await a(p,d.positionY,f.positionY),await a(p,d.positionZ,f.positionZ)),Jt(f)?await l(d,p,f.inputs[0]):await l(d,p,f),f})(d,p)}}})(Jn,hi,_i,Ye,qi,re,Dn,ti,Sn,Di),Gi=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const l=r(t),c={...nn,...a},u=n(l,c),h=s(l);super(t,!1,u,h?i():null),this._nativePannerNode=u,this._orientationX=e(this,h,u.orientationX,Bt,Vt),this._orientationY=e(this,h,u.orientationY,Bt,Vt),this._orientationZ=e(this,h,u.orientationZ,Bt,Vt),this._positionX=e(this,h,u.positionX,Bt,Vt),this._positionY=e(this,h,u.positionY,Bt,Vt),this._positionZ=e(this,h,u.positionZ,Bt,Vt),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(Bn,ni,qi,Hi,On,Pn,ai),Yi=(t=>(e,{disableNormalization:n,imag:i,real:r})=>{const s=i instanceof Float32Array?i:new Float32Array(i),o=r instanceof Float32Array?r:new Float32Array(r),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(i).length<2)throw t();return a})(Nt),Xi=((t,e,n,i)=>class r{constructor(r,s){const o=e(r),a=i({...rn,...s}),l=t(o,a);return n.add(l),l}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===r.prototype||n.has(t)}})(Yi,On,new WeakSet,(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})),Zi=((t,e,n,i,r,s)=>{const o=16385,a=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},h=(t,s,h,d,p)=>{if(1===s)return((t,e,r,s)=>{const h=new Float32Array(o),d=new Float32Array(o);for(let n=0;n<o;n+=1){const t=n/16384*l;h[n]=Math.cos(t),d[n]=Math.sin(t)}const p=n(t,{...c,gain:0}),m=i(t,{...u,curve:h}),f=i(t,{...u,curve:a}),g=n(t,{...c,gain:0}),_=i(t,{...u,curve:d});return{connectGraph(){e.connect(p),e.connect(void 0===f.inputs?f:f.inputs[0]),e.connect(g),f.connect(r),r.connect(void 0===m.inputs?m:m.inputs[0]),r.connect(void 0===_.inputs?_:_.inputs[0]),m.connect(p.gain),_.connect(g.gain),p.connect(s,0,0),g.connect(s,0,1)},disconnectGraph(){e.disconnect(p),e.disconnect(void 0===f.inputs?f:f.inputs[0]),e.disconnect(g),f.disconnect(r),r.disconnect(void 0===m.inputs?m:m.inputs[0]),r.disconnect(void 0===_.inputs?_:_.inputs[0]),m.disconnect(p.gain),_.disconnect(g.gain),p.disconnect(s,0,0),g.disconnect(s,0,1)}}})(t,h,d,p);if(2===s)return((t,r,s,h)=>{const d=new Float32Array(o),p=new Float32Array(o),m=new Float32Array(o),f=new Float32Array(o),g=Math.floor(8192.5);for(let e=0;e<o;e+=1)if(e>g){const t=(e-g)/(16384-g)*l;d[e]=Math.cos(t),p[e]=Math.sin(t),m[e]=0,f[e]=1}else{const t=e/(16384-g)*l;d[e]=1,p[e]=0,m[e]=Math.cos(t),f[e]=Math.sin(t)}const _=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(t,{...c,gain:0}),y=i(t,{...u,curve:d}),w=n(t,{...c,gain:0}),b=i(t,{...u,curve:p}),T=i(t,{...u,curve:a}),E=n(t,{...c,gain:0}),x=i(t,{...u,curve:m}),A=n(t,{...c,gain:0}),C=i(t,{...u,curve:f});return{connectGraph(){r.connect(_),r.connect(void 0===T.inputs?T:T.inputs[0]),_.connect(v,0),_.connect(w,0),_.connect(E,1),_.connect(A,1),T.connect(s),s.connect(void 0===y.inputs?y:y.inputs[0]),s.connect(void 0===b.inputs?b:b.inputs[0]),s.connect(void 0===x.inputs?x:x.inputs[0]),s.connect(void 0===C.inputs?C:C.inputs[0]),y.connect(v.gain),b.connect(w.gain),x.connect(E.gain),C.connect(A.gain),v.connect(h,0,0),E.connect(h,0,0),w.connect(h,0,1),A.connect(h,0,1)},disconnectGraph(){r.disconnect(_),r.disconnect(void 0===T.inputs?T:T.inputs[0]),_.disconnect(v,0),_.disconnect(w,0),_.disconnect(E,1),_.disconnect(A,1),T.disconnect(s),s.disconnect(void 0===y.inputs?y:y.inputs[0]),s.disconnect(void 0===b.inputs?b:b.inputs[0]),s.disconnect(void 0===x.inputs?x:x.inputs[0]),s.disconnect(void 0===C.inputs?C:C.inputs[0]),y.disconnect(v.gain),b.disconnect(w.gain),x.disconnect(E.gain),C.disconnect(A.gain),v.disconnect(h,0,0),E.disconnect(h,0,0),w.disconnect(h,0,1),A.disconnect(h,0,1)}}})(t,h,d,p);throw r()};return(e,{channelCount:i,channelCountMode:o,pan:a,...l})=>{if("max"===o)throw r();const c=t(e,{...l,channelCount:1,channelCountMode:o,numberOfInputs:2}),u=n(e,{...l,channelCount:i,channelCountMode:o,gain:1}),d=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:p,disconnectGraph:m}=h(e,i,u,d,c);Object.defineProperty(d.gain,"defaultValue",{get:()=>0}),Object.defineProperty(d.gain,"maxValue",{get:()=>1}),Object.defineProperty(d.gain,"minValue",{get:()=>-1});const f={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){u.channelCount!==t&&(g&&m(),({connectGraph:p,disconnectGraph:m}=h(e,t,u,d,c)),g&&p()),u.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw r();u.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t},get context(){return u.context},get inputs(){return[u]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get pan(){return d.gain},addEventListener:(...t)=>u.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>u.dispatchEvent(t[0]),removeEventListener:(...t)=>u.removeEventListener(t[0],t[1],t[2])};let g=!1;return s(He(f,c),(()=>{p(),g=!0}),(()=>{m(),g=!1}))}})(hi,qe,Ye,zi,Qe,ci),Ki=((t,e)=>(n,i)=>{const r=i.channelCountMode;if("clamped-max"===r)throw e();if(void 0===n.createStereoPanner)return t(n,i);const s=n.createStereoPanner();return Le(s,i),Ve(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:t=>{if(t!==r)throw e()}}),s})(Zi,Qe),Ji=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const l=s.get(a);return void 0!==l?Promise.resolve(l):(async(o,a)=>{let l=n(o);const c=Ft(l,a);if(!c){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(a,t)}return s.set(a,l),c?await t(a,o.pan,l.pan):await i(a,o.pan,l.pan),Jt(l)?await r(o,a,l.inputs[0]):await r(o,a,l),l})(o,a)}}})(Jn,Ki,re,ti,Sn),Qi=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),l={...sn,...o},c=n(a,l),u=s(a);super(t,!1,c,u?i():null),this._pan=e(this,u,c.pan)}get pan(){return this._pan}})(Bn,ni,Ki,Ji,On,Pn),tr=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ft(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(s,e)}return i.set(s,o),Jt(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o})(r,s)}}})(zi,re,Sn),er=((t,e,n,i,r,s,o)=>class extends t{constructor(t,e){const a=r(t),l={...on,...e},c=n(a,l);super(t,!0,c,s(a)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=c,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(Bn,Me,zi,tr,On,Pn,ai),nr=(t=>null!==t&&t.isSecureContext)(xn),ir=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(xn),rr=new WeakMap,sr=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i})(rr,Dn),or=nr?((t,e,n,i,r,s,o,a,l,c,u,h,d)=>{let p=0;return(m,f,g={credentials:"omit"})=>{const _=u.get(m);if(void 0!==_&&_.has(f))return Promise.resolve();const v=c.get(m);if(void 0!==v){const t=v.get(f);if(void 0!==t)return t}const y=s(m),w=void 0===y.audioWorklet?r(f).then((([t,e])=>{const[i,r]=Tt(t,e);return n(`${i};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${r}\n})})(window,'_AWGS')`)})).then((()=>{const t=d._AWGS.pop();if(void 0===t)throw new SyntaxError;i(y.currentTime,y.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const i=vt.get(y);if(void 0!==i){if(i.has(t))throw e();xt(n),Et(n.parameterDescriptors),i.set(t,n)}else xt(n),Et(n.parameterDescriptors),vt.set(y,new Map([[t,n]]))}),y.sampleRate,void 0,void 0)))})):Promise.all([r(f),Promise.resolve(t(h,h))]).then((([[t,e],n])=>{const i=p+1;p=i;const[r,s]=Tt(t,e),c=new Blob([`${r};((AudioWorkletProcessor,registerProcessor)=>{${s}\n})(${n?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${i}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),u=URL.createObjectURL(c);return y.audioWorklet.addModule(u,g).then((()=>{if(a(y))return y;const t=o(y);return t.audioWorklet.addModule(u,g).then((()=>t))})).then((t=>{if(null===l)throw new SyntaxError;try{new l(t,`__sac${i}`)}catch{throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(u)))}));return void 0===v?c.set(m,new Map([[f,w]])):v.set(f,w),w.then((()=>{const t=u.get(m);void 0===t?u.set(m,new Set([f])):t.add(f)})).finally((()=>{const t=c.get(m);void 0!==t&&t.delete(f)})),w}})(bn,Qe,(t=>e=>new Promise(((n,i)=>{if(null===t)return void i(new SyntaxError);const r=t.document.head;if(null===r)i(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),l=t.onerror,c=()=>{t.onerror=l,URL.revokeObjectURL(a)};t.onerror=(e,n,r,s,o)=>n===a||n===t.location.href&&1===r&&1===s?(c(),i(o),!1):null!==l?l(e,n,r,s,o):void 0,s.onerror=()=>{c(),i(new SyntaxError)},s.onload=()=>{c(),n()},s.src=a,s.type="module",r.appendChild(s)}})))(xn),ir,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw t()})((()=>new DOMException("","AbortError"))),On,sr,Pn,Vn,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n);let s=!1,o=!1;try{await i.audioWorklet.addModule(r);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>s=!0,e.onprocessorerror=()=>o=!0,n.connect(e),n.start(0),await i.startRendering(),await new Promise((t=>setTimeout(t)))}catch{}finally{URL.revokeObjectURL(r)}return s&&!o})(Vn,Dn),xn):void 0,ar=((t,e)=>n=>t(n)||e(n))(Nn,Pn),lr=((t,e,n,i,r,s,o,a,l,c,u)=>(h,d)=>{const p=o(h)?h:s(h);if(r.has(d)){const t=n();return Promise.reject(t)}try{r.add(d)}catch{}return e(l,(()=>l(p)))?p.decodeAudioData(d).then((n=>(Ae(d).catch((()=>{})),e(a,(()=>a(n)))||u(n),t.add(n),n))):new Promise(((e,n)=>{const r=async()=>{try{await Ae(d)}catch{}},s=t=>{n(t),r()};try{p.decodeAudioData(d,(n=>{"function"!=typeof n.copyFromChannel&&(c(n),Lt(n)),t.add(n),r().then((()=>e(n)))}),(t=>{s(null===t?i():t)}))}catch(o){s(o)}}))})(zn,bn,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,On,ar,Rt,Re,Gn,Yn),cr=((t,e,n,i,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y)=>class extends m{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i})}createBufferSource(){return new i(this)}createChannelMerger(t=6){return new s(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new o(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(t=1){return new u(this,{maxDelayTime:t})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(t,e){return new p(this,{feedback:e,feedforward:t})}createOscillator(){return new f(this)}createPanner(){return new g(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new _(this,{...n,imag:e,real:t})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(t,e,n){return c(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t)),(t=>{throw"function"==typeof n&&n(t),t}))}})(or,Wn,Xn,ri,li,pi,fi,yi,Ti,lr,xi,Si,Oi,Fi,Li,Bi,Gi,Xi,Qi,er),ur=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t),o=e(s,r);if(i(s))throw TypeError();super(t,!0,o,null),this._nativeMediaElementAudioSourceNode=o}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Bn,((t,e)=>t.createMediaElementSource(e.mediaElement)),On,Pn),hr=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t);if(i(s))throw new TypeError;const o={...Fe,...r},a=e(s,o);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Bn,((t,e)=>{const n=t.createMediaStreamDestination();return Le(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),On,Pn),dr=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t),o=e(s,r);if(i(s))throw new TypeError;super(t,!0,o,null),this._nativeMediaStreamAudioSourceNode=o}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Bn,((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const i=n.slice(0,1),r=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(r,"mediaStream",{value:e}),r}),On,Pn),pr=((t,e)=>(n,{mediaStreamTrack:i})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(i);const r=new MediaStream([i]),s=n.createMediaStreamSource(r);if("audio"!==i.kind)throw t();if(e(n))throw new TypeError;return s})(Me,Pn),mr=((t,e,n)=>class extends t{constructor(t,i){const r=n(t);super(t,!0,e(r,i),null)}})(Bn,pr,On),fr=((t,e,n,i,r,s,o,a,l)=>class extends t{constructor(t={}){if(null===l)throw new Error("Missing the native AudioContext constructor.");let e;try{e=new l(t)}catch(o){if(12===o.code&&"sampleRate is not in range"===o.message)throw n();throw o}if(null===e)throw i();if(!(t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t))(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:r}=t,{sampleRate:s}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===r?512/s:"interactive"===r||void 0===r?256/s:"playback"===r?1024/s:128*Math.max(2,Math.min(128,Math.round(r*s/128)))/s,this._nativeAudioContext=e,"webkitAudioContext"===l.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Ht(this)})))}createMediaElementSource(t){return new r(this,{mediaElement:t})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(t){return new o(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(cr,Me,Qe,(()=>new DOMException("","UnknownError")),ur,hr,dr,mr,Rn),gr=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(Ni),_r=(t=>(e,n)=>{t(e).add(n)})(gr),vr=(t=>(e,n,i=0,r=0)=>{const s=e[i];if(void 0===s)throw t();return ue(n)?s.connect(n,0,r):s.connect(n,0)})(Nt),yr=(t=>(e,n)=>{t(e).delete(n)})(gr),wr=(t=>(e,n=void 0,i=void 0,r=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?Se(t,e,n).disconnect():ue(n)?void 0===i?e.forEach((t=>t.disconnect(n))):void 0===r?Se(t,e,i).disconnect(n,0):Se(t,e,i).disconnect(n,0,r):void 0===i?e.forEach((t=>t.disconnect(n))):Se(t,e,i).disconnect(n,0))(Nt),br=new WeakMap,Tr=((t,e)=>n=>e(t,n))(br,At),Er=((t,e,n,i,r,s,o,a,l,c,u,h,d)=>(p,m,f,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw l();const _=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(_.some((t=>t<1)))throw l();if(_.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw l();const v=g.channelCount*g.numberOfInputs,y=_.reduce(((t,e)=>t+e),0),w=void 0===f.parameterDescriptors?0:f.parameterDescriptors.length;if(v+w>6||y>6)throw l();const b=new MessageChannel,T=[],E=[];for(let t=0;t<g.numberOfInputs;t+=1)T.push(o(p,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),E.push(r(p,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const x=[];if(void 0!==f.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:i}of f.parameterDescriptors){const r=s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[i]?g.parameterData[i]:void 0===t?0:t});Object.defineProperties(r.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?Bt:e},minValue:{get:()=>void 0===n?Vt:n}}),x.push(r)}const A=i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+w)}),C=We(m,p.sampleRate),S=a(p,C,v+w,Math.max(1,y)),k=r(p,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),O=[];for(let t=0;t<g.numberOfOutputs;t+=1)O.push(i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:_[t]}));for(let t=0;t<g.numberOfInputs;t+=1){T[t].connect(E[t]);for(let e=0;e<g.channelCount;e+=1)E[t].connect(A,e,t*g.channelCount+e)}const M=new me(void 0===f.parameterDescriptors?[]:f.parameterDescriptors.map((({name:t},e)=>{const n=x[e];return n.connect(A,0,v+e),n.start(0),[t,n.offset]})));A.connect(S);let D=g.channelInterpretation,P=null;const I=0===g.numberOfOutputs?[S]:O,F={get bufferSize(){return C},get channelCount(){return g.channelCount},set channelCount(t){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return D},set channelInterpretation(t){for(const e of T)e.channelInterpretation=t;D=t},get context(){return S.context},get inputs(){return T},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return P},set onprocessorerror(t){"function"==typeof P&&F.removeEventListener("processorerror",P),P="function"==typeof t?t:null,"function"==typeof P&&F.addEventListener("processorerror",P)},get parameters(){return M},get port(){return b.port2},addEventListener:(...t)=>S.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,I),disconnect:c.bind(null,I),dispatchEvent:(...t)=>S.dispatchEvent(t[0]),removeEventListener:(...t)=>S.removeEventListener(t[0],t[1],t[2])},R=new Map;var N,L;b.port1.addEventListener=(N=b.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=R.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{u(p.currentTime,p.sampleRate,(()=>e(t)))},R.set(e,t[1]))}}return N.call(b.port1,t[0],t[1],t[2])}),b.port1.removeEventListener=(L=b.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=R.get(t[1]);void 0!==e&&(R.delete(t[1]),t[1]=e)}return L.call(b.port1,t[0],t[1],t[2])});let j=null;Object.defineProperty(b.port1,"onmessage",{get:()=>j,set:t=>{"function"==typeof j&&b.port1.removeEventListener("message",j),j="function"==typeof t?t:null,"function"==typeof j&&(b.port1.addEventListener("message",j),b.port1.start())}}),f.prototype.port=b.port1;let V=null;const B=((t,e,n,i)=>{let r=yt.get(t);void 0===r&&(r=new WeakMap,yt.set(t,r));const s=ze(n,i);return r.set(e,s),s})(p,F,f,g);B.then((t=>V=t));const $=ve(g.numberOfInputs,g.channelCount),W=ve(g.numberOfOutputs,_),z=void 0===f.parameterDescriptors?[]:f.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let U=!0;const q=()=>{g.numberOfOutputs>0&&S.disconnect(k);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=O[t];for(let i=0;i<_[t];i+=1)k.disconnect(n,e+i,i);e+=_[t]}},H=new Map;S.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==V){const i=h(F);for(let r=0;r<C;r+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)ge(t,$[e],n,n,r);void 0!==f.parameterDescriptors&&f.parameterDescriptors.forEach((({name:e},n)=>{ge(t,z,e,v+n,r)}));for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<_[t];e+=1)0===W[t][e].byteLength&&(W[t][e]=new Float32Array(128));try{const t=$.map(((t,e)=>{if(i[e].size>0)return H.set(e,C/128),t;const n=H.get(e);return void 0===n?[]:(t.every((t=>t.every((t=>0===t))))&&(1===n?H.delete(e):H.set(e,n-1)),t)})),n=u(p.currentTime+r/p.sampleRate,p.sampleRate,(()=>V.process(t,W,z)));U=n;for(let i=0,s=0;i<g.numberOfOutputs;i+=1){for(let t=0;t<_[i];t+=1)_e(e,W[i],t,s+t,r);s+=_[i]}}catch(n){U=!1,F.dispatchEvent(new ErrorEvent("processorerror",{colno:n.colno,filename:n.filename,lineno:n.lineno,message:n.message}))}if(!U){for(let t=0;t<g.numberOfInputs;t+=1){T[t].disconnect(E[t]);for(let e=0;e<g.channelCount;e+=1)E[r].disconnect(A,e,t*g.channelCount+e)}if(void 0!==f.parameterDescriptors){const t=f.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=x[e];t.disconnect(A,0,v+e),t.stop()}}A.disconnect(S),S.onaudioprocess=null,G?q():Z();break}}}};let G=!1;const Y=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),X=()=>S.connect(Y).connect(p.destination),Z=()=>{S.disconnect(Y),Y.disconnect()};return X(),d(F,(()=>{if(U){Z(),g.numberOfOutputs>0&&S.connect(k);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=O[t];for(let i=0;i<_[t];i+=1)k.connect(n,e+i,i);e+=_[t]}}G=!0}),(()=>{U&&(X(),q()),G=!1}))})(vr,Nt,Me,hi,qe,_i,Ye,Je,Qe,wr,ir,Tr,ci),xr=((t,e,n,i,r)=>(s,o,a,l,c,u)=>{if(null!==a)try{const e=new a(s,l,u),i=new Map;let o=null;if(Object.defineProperties(e,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>o,set:t=>{"function"==typeof o&&e.removeEventListener("processorerror",o),o="function"==typeof t?t:null,"function"==typeof o&&e.addEventListener("processorerror",o)}}}),e.addEventListener=(d=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=i.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},i.set(e,t[1]))}}return d.call(e,"error",t[1],t[2]),d.call(e,...t)}),e.removeEventListener=(h=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=i.get(t[1]);void 0!==e&&(i.delete(t[1]),t[1]=e)}return h.call(e,"error",t[1],t[2]),h.call(e,t[0],t[1],t[2])}),0!==u.numberOfOutputs){const t=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(s.destination);return r(e,(()=>t.disconnect()),(()=>t.connect(s.destination)))}return e}catch(p){if(11===p.code)throw i();throw p}var h,d;if(void 0===c)throw i();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(u),e(s,o,c,u)})(Me,Er,Ye,Qe,ci),Ar=((t,e,n,i,r,s,o,a,l,c,u,h,d,p,m,f)=>(g,_,v)=>{const y=new WeakMap;let w=null;return{render(b,T){a(T,b);const E=y.get(T);return void 0!==E?Promise.resolve(E):(async(a,b)=>{let T=u(a),E=null;const x=Ft(T,b),A=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(null===h){const t=A.reduce(((t,e)=>t+e),0),n=r(b,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),s=[];for(let e=0;e<a.numberOfOutputs;e+=1)s.push(i(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:A[e]}));const c=o(b,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1});c.connect=e.bind(null,s),c.disconnect=l.bind(null,s),E=[n,s,c]}else x||(T=new h(b,g));if(y.set(b,null===E?T:E[2]),null!==E){if(null===w){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===d)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,n=t+e,l=async()=>{const l=new d(n,128*Math.ceil(a.context.length/128),b.sampleRate),c=[],u=[];for(let t=0;t<_.numberOfInputs;t+=1)c.push(o(l,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),u.push(r(l,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const h=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=s(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await p(l,t,e.offset),e}))),g=i(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<_.numberOfInputs;t+=1){c[t].connect(u[t]);for(let e=0;e<_.channelCount;e+=1)u[t].connect(g,e,t*_.channelCount+e)}for(const[e,n]of h.entries())n.connect(g,0,t+e),n.start(0);return g.connect(l.destination),await Promise.all(c.map((t=>m(a,l,t)))),f(l)};w=ye(a,0===n?null:await l(),b,_,A,v,c)}const t=await w,e=n(b,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[l,u,h]=E;null!==t&&(e.buffer=t,e.start(0)),e.connect(l);for(let n=0,i=0;n<a.numberOfOutputs;n+=1){const t=u[n];for(let e=0;e<A[n];e+=1)l.connect(t,i+e,e);i+=A[n]}return h}if(x)for(const[e,n]of a.parameters.entries())await t(b,n,T.parameters.get(e));else for(const[t,e]of a.parameters.entries())await p(b,e,T.parameters.get(t));return await m(a,b,T),T})(b,T)}}})(Jn,vr,Qn,hi,qe,_i,Ye,yr,wr,ir,re,Vn,Dn,ti,Sn,Di),Cr=(t=>e=>t.get(e))(rr),Sr=(t=>(e,n)=>{t.set(e,n)})(br),kr=nr?((t,e,n,i,r,s,o,a,l,c,u,h,d,p)=>class extends e{constructor(e,p,m){var f;const g=a(e),_=l(g),v=u({...fe,...m});d(v);const y=vt.get(g),w=null==y?void 0:y.get(p),b=_||"closed"!==g.state?g:null!==(f=o(g))&&void 0!==f?f:g,T=r(b,_?null:e.baseLatency,c,p,w,v);super(e,!0,T,_?i(p,v,w):null);const E=[];T.parameters.forEach(((t,e)=>{const i=n(this,_,t);E.push([e,i])})),this._nativeAudioWorkletNode=T,this._onprocessorerror=null,this._parameters=new me(E),_&&t(g,this);const{activeInputs:x}=s(this);h(T,x)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?p(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(_r,Bn,ni,Ar,xr,zt,Cr,On,Pn,Vn,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),Sr,(t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}}),fn):void 0,Or=((t,e)=>(n,i,r)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(s){if("SyntaxError"===s.name)throw t();throw s}})(Qe,Dn),Mr=((t,e,n,i,r,s,o,a)=>(l,c)=>n(l).render(l,c).then((()=>Promise.all(Array.from(i(c)).map((t=>n(t).render(t,c)))))).then((()=>r(c))).then((n=>("function"!=typeof n.copyFromChannel?(o(n),Lt(n)):e(s,(()=>s(n)))||a(n),t.add(n),n))))(zn,bn,Cn,gr,Di,Rt,Gn,Yn),Dr=((t,e,n,i,r)=>class extends t{constructor(t,n,r){let s;if("number"==typeof t&&void 0!==n&&void 0!==r)s={length:n,numberOfChannels:t,sampleRate:r};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");s=t}const{length:o,numberOfChannels:a,sampleRate:l}={...tn,...s},c=i(a,o,l);e(Re,(()=>Re(c)))||c.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(c.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(c,a),this._length=o,this._nativeOfflineAudioContext=c,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,Ht(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(cr,bn,Me,Or,Mr),Pr=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(ft,Nn),Ir=((t,e)=>n=>t.has(n)||e(n))(dt,Ln),Fr=((t,e)=>n=>t.has(n)||e(n))(mt,jn),Rr=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(ft,Pn);function Nr(t,e){if(!t)throw new Error(e)}function Lr(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function jr(t){t.isOffline||"running"===t.state||Br('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Vr=console;function Br(...t){Vr.warn(...t)}function $r(t){return void 0===t}function Wr(t){return!$r(t)}function zr(t){return"number"==typeof t}function Ur(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function qr(t){return Array.isArray(t)}function Hr(t){return"string"==typeof t}function Gr(t){return Hr(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const Yr="object"==typeof self?self:null,Xr=Yr&&(Yr.hasOwnProperty("AudioContext")||Yr.hasOwnProperty("webkitAudioContext"));function Zr(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o}function Kr(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{l(i.next(t))}catch(Jo){s(Jo)}}function a(t){try{l(i.throw(t))}catch(Jo){s(Jo)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}l((i=i.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;class Jr{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(Jo){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function Qr(t){return Fr(t)}function ts(t){return Ir(t)}function es(t){return Rr(t)}function ns(t){return Pr(t)}function is(t){return t instanceof AudioBuffer}function rs(t,e){return"value"===t||Qr(e)||ts(e)||is(e)}function ss(t,...e){if(!e.length)return t;const n=e.shift();if(Ur(t)&&Ur(n))for(const i in n)rs(i,n[i])?t[i]=n[i]:Ur(n[i])?(t[i]||Object.assign(t,{[i]:{}}),ss(t[i],n[i])):Object.assign(t,{[i]:n[i]});return ss(t,...e)}function os(t,e,n=[],i){const r={},s=Array.from(e);if(Ur(s[0])&&i&&!Reflect.has(s[0],i)){Object.keys(s[0]).some((e=>Reflect.has(t,e)))||(ss(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())}if(1===s.length&&Ur(s[0]))ss(r,s[0]);else for(let o=0;o<n.length;o++)Wr(s[o])&&(r[n[o]]=s[o]);return ss(t,r)}function as(t,e){return $r(t)?e:t}function ls(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}class cs{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||Yr&&this.toString()===Yr.TONE_DEBUG_CLASS)&&function(...t){Vr.log(...t)}(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}cs.version=z;const us=1e-6;function hs(t,e){return t>e+us}function ds(t,e){return hs(t,e)||ms(t,e)}function ps(t,e){return t+us<e}function ms(t,e){return Math.abs(t-e)<us}class fs extends cs{constructor(){super(),this.name="Timeline",this._timeline=[];const t=os(fs.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(Nr(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];Nr(ds(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(ms(this._timeline[e].time,t)){for(let n=e;n>=0&&ms(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&ds(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let r=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<r;){let i=Math.floor(n+(r-n)/2);const s=this._timeline[i],o=this._timeline[i+1];if(ms(s[e],t)){for(let n=i;n<this._timeline.length;n++){if(!ms(this._timeline[n][e],t))break;i=n}return i}if(ps(s[e],t)&&hs(o[e],t))return i;hs(s[e],t)?r=i:n=i+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),r=this._search(e);return-1!==i&&-1!==r?(this._timeline[i].time!==t&&(i+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&ms(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&ms(this._timeline[e].time,t);e--)i=e;this._iterate((t=>{e(t)}),i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const gs=[];function _s(t){gs.push(t)}const vs=[];function ys(t){vs.push(t)}class ws extends cs{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{$r(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if($r(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if($r(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(ws.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class bs extends ws{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Ts extends bs{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new fs,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=os(Ts.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new fr(t)}({latencyHint:t.latencyHint}),this._ticker=new Jr(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,gs.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){Nr(ns(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaElementSource(t){Nr(ns(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(t)}createMediaStreamDestination(){Nr(ns(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){Nr(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){Nr(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){Nr(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){Nr(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return Nr(Wr(kr),"This node only works in a secure context (https or localhost)"),new kr(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return Kr(this,void 0,void 0,(function*(){Nr(Wr(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return Kr(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Hr(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return ns(this._context)?this._context.resume():Promise.resolve()}close(){return Kr(this,void 0,void 0,(function*(){var t;ns(this._context)&&(yield this._context.close()),this._initialized&&(t=this,vs.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let r=0;r<n.length;r++)n[r]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const r=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:r+e})};return i(),n}}function Es(t,e){qr(e)?e.forEach((e=>Es(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function xs(t,e){qr(e)?e.forEach((e=>xs(t,e))):Object.defineProperty(t,e,{writable:!0})}const As=()=>{};class Cs extends cs{constructor(){super(),this.name="ToneAudioBuffer",this.onload=As;const t=os(Cs.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&is(t.url)||t.url instanceof Cs?this.set(t.url):Hr(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:As,onload:As,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Ms().sampleRate}set(t){return t instanceof Cs?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return Kr(this,void 0,void 0,(function*(){const e=Cs.load(t).then((t=>{this.set(t),this.onload(this)}));Cs.downloads.push(e);try{yield e}finally{const t=Cs.downloads.indexOf(e);Cs.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=qr(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,r=Ms(),s=r.createBuffer(n,i,r.sampleRate),o=e||1!==n?t:[t];for(let a=0;a<n;a++)s.copyToChannel(o[a],a);return this._buffer=s,this}toMono(t){if(zr(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(zr(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);Nr(n<i,"The start time must be less than the end time");const r=i-n,s=Ms().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let o=0;o<this.numberOfChannels;o++)s.copyToChannel(this.getChannelData(o).subarray(n,i),o);return new Cs(s)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new Cs).fromArray(t)}static fromUrl(t){return Kr(this,void 0,void 0,(function*(){const e=new Cs;return yield e.load(t)}))}static load(t){return Kr(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(Cs.supportsType(t)){i=t;break}t=t.replace(e[0],i)}const n=""===Cs.baseUrl||Cs.baseUrl.endsWith("/")?Cs.baseUrl:Cs.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error(`could not load url: ${t}`);const r=yield i.arrayBuffer();return yield Ms().decodeAudioData(r)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return Kr(this,void 0,void 0,(function*(){for(yield Promise.resolve();Cs.downloads.length;)yield Cs.downloads[0]}))}}Cs.baseUrl="",Cs.downloads=[];class Ss extends Ts{constructor(){var t,e,n;super({clockSource:"offline",context:es(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new Dr(t,e,n)),lookAhead:0,updateInterval:es(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=es(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Kr(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return Kr(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new Cs(e)}))}close(){return Promise.resolve()}}const ks=new class extends bs{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return Kr(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let Os=ks;function Ms(){return Os===ks&&Xr&&function(t){Os=ns(t)?new Ts(t):es(t)?new Ss(t):t}(new Ts),Os}if(Yr&&!Yr.TONE_SILENCE_LOGGING){}function Ds(t){return Math.pow(2,t/12)}let Ps=440;function Is(t){return Math.round(Fs(t))}function Fs(t){return 69+12*Math.log2(t/Ps)}class Rs extends cs{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Rs&&this.fromType(this._val),$r(this._val))return this._noArg();if(Hr(this._val)&&$r(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Ur(this._val)){let t=0;for(const e in this._val)if(Wr(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(Wr(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return Hr(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class Ns extends Rs{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Ns(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let r=1;r<9;r++){const t=Math.pow(2,r);e.push(t+"n."),e.push(t+"n"),e.push(t+"t")}e.push("0");let n=e[0],i=new Ns(this.context,e[0]).toSeconds();return e.forEach((e=>{const r=new Ns(this.context,e).toSeconds();Math.abs(r-t)<Math.abs(i-t)&&(n=e,i=r)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const r=i.toString();r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3)));return[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Is(this.toFrequency())}_now(){return this.context.now()}}class Ls extends Ns{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return Ps}static set A4(t){!function(t){Ps=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:Ls.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=js[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:Ls.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new Ls(this.context,this.valueOf()*Ds(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return Is(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Ls.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);i<0&&(n+=-12*i);return Vs[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return function(t){return Ps*Math.pow(2,(t-69)/12)}(t)}static ftom(t){return Is(t)}}const js={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Vs=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class Bs extends Ns{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class $s extends cs{constructor(){super();const t=os($s.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Ms()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new Ns(this.context,t).toSeconds()}toFrequency(t){return new Ls(this.context,t).toFrequency()}toTicks(t){return new Bs(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{$r(t[n])&&delete e[n]})),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];Wr(n)&&Wr(n.value)&&Wr(n.setValueAtTime)?t[e]=n.value:n instanceof $s?t[e]=n._getPartialProperties(t[e]):qr(n)||zr(n)||Hr(n)||"boolean"==typeof n?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&Wr(this[e])&&(this[e]&&Wr(this[e].value)&&Wr(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof $s?this[e].set(t[e]):this[e]=t[e])})),this}}class Ws extends fs{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return Lr(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let i=n;i<this._timeline.length;i++){const e=this._timeline[i];if(e.state===t)return e}}}class zs extends $s{constructor(){super(os(zs.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=os(zs.getDefaults(),arguments,["param","units","convert"]);for(Nr(Wr(t.param)&&(Qr(t.param)||t.param instanceof zs),"param must be an AudioParam");!Qr(t.param);)t.param=t.param._param;this._swappable=!!Wr(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new fs(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Wr(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign($s.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Wr(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return Wr(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Wr(this.maxValue)&&Wr(this.minValue)&&Lr(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?(e=t,Math.pow(10,e/20)):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t;var e}_toType(t){return this.convert&&"decibels"===this.units?(e=t,Math.log(e)/Math.LN10*20):t;var e}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return Nr(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else r=i.value;else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,n,i.value,i.constant,e))}return this._toType(r)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return Nr(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=ms(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(e);return Nr(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);Nr(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(e);return this._assertRange(i),Nr(isFinite(i)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(i,r,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const r=this._fromType(t[0])*i;this.setValueAtTime(this._toType(r),e);const s=n/(t.length-1);for(let o=1;o<t.length;o++){const n=this._fromType(t[o])*i;this.linearRampToValueAtTime(this._toType(n),e+o*s)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return Nr(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));Nr(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),r=this._events.getAfter(e);return i&&ms(i.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),r=i?i.time:e+2,s=(r-e)/10;for(let n=e;n<r;n+=s)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){Nr(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)}_linearInterpolate(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t))}}class Us extends $s{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return Wr(this.input)?Qr(this.input)||this.input instanceof zs?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Wr(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Wr(t)&&(t instanceof Us||ts(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();Nr(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return Hs(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Br("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return function(t,e,n=0,i=0){if(Wr(e))for(;e instanceof Us;)e=e.input;for(;!ts(t);)Wr(t.output)&&(t=t.output);Qr(e)?t.disconnect(e,n):ts(e)?t.disconnect(e,n,i):t.disconnect()}(this,t,e,n),this}chain(...t){return qs(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),Wr(this.input)&&(this.input instanceof Us?this.input.dispose():ts(this.input)&&this.input.disconnect()),Wr(this.output)&&(this.output instanceof Us?this.output.dispose():ts(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function qs(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof Us?t.connect(e):ts(t)&&Hs(t,e),e)),e)}function Hs(t,e,n=0,i=0){for(Nr(Wr(t),"Cannot connect from undefined node"),Nr(Wr(e),"Cannot connect to undefined node"),(e instanceof Us||ts(e))&&Nr(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Nr(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Us||e instanceof zs;)Wr(e.input)&&(e=e.input);for(;t instanceof Us;)Wr(t.output)&&(t=t.output);Qr(e)?t.connect(e,n):t.connect(e,n,i)}class Gs extends Us{constructor(){super(os(Gs.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=os(Gs.getDefaults(),arguments,["gain","units"]);this.gain=new zs({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),Es(this,"gain")}static getDefaults(){return Object.assign(Us.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Ys extends Us{constructor(t){super(t),this.onended=As,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Gs({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Us.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:As})}_startGain(t,e=1){Nr(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){Nr(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==As&&(this.onended(this),this.onended=As,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Nr(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class Xs extends Ys{constructor(){super(os(Xs.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=os(Xs.getDefaults(),arguments,["offset"]);Hs(this._source,this._gainNode),this.offset=new zs({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Ys.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Zs extends Us{constructor(){super(os(Zs.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=os(Zs.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Xs({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Us.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return Ks(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function Ks(t,e,n,i){(e instanceof zs||Qr(e)||e instanceof Zs&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Zs&&(e.overridden=!0)),Hs(t,e,n,i)}class Js extends zs{constructor(){super(os(Js.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new fs(1/0),this._multiplier=1;const t=os(Js.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(zs.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),r=this._events.get(e),s=Math.round(Math.max(1/n,1));for(let o=0;o<=s;o++){const t=n*o+e,s=this._exponentialApproach(r.time,r.value,i,n,t);this.linearRampToValueAtTime(this._toType(s),t)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max(10*(e-i.time),1)),s=(e-i.time)/r;for(let o=0;o<=r;o++){const t=s*o+i.time,r=this._exponentialInterpolate(i.time,i.value,e,n,t);this.linearRampToValueAtTime(this._toType(r),t)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if($r(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const r=this._events.get(e);return r&&r.time===e&&"setValueAtTime"===r.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),s=Math.sqrt(Math.pow(i,2)-2*r*(e.ticks-t)),o=(-i+s)/r;return(o>0?o:(-i-s)/r)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Qs extends Zs{constructor(){super(os(Qs.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=os(Qs.getDefaults(),arguments,["value"]);this.input=this._param=new Js({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Zs.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class to extends $s{constructor(){super(os(to.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Ws,this._tickOffset=new fs;const t=os(to.getDefaults(),arguments,["frequency"]);this.frequency=new Qs({context:this.context,units:t.units,value:t.frequency}),Es(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},$s.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),Wr(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let r=n,s=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=r.time;const n=this._tickOffset.get(t.time);n&&n.time>=r.time&&(s=n.ticks,e=n.time),"started"===r.state&&"started"!==t.state&&(s+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),r=t})),this._state.remove(i),s}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,r=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(r=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(r+=t.time-e),i=t})),this._state.remove(n),r}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),r=Math.max(n.time,i.time),s=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,(e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e}));let r=null;if(i&&"started"===i.state){const s=Math.max(i.time,t),o=this.frequency.getTicksAtTime(s),a=o-this.frequency.getTicksAtTime(i.time);let l=Math.ceil(a)-a;l=ms(l,1)?0:l;let c=this.frequency.getTimeOfTick(o+l);for(;c<e;){try{n(c,Math.round(this.getTicksAtTime(c)))}catch(Jo){r=Jo;break}c+=this.frequency.getDurationOfTicks(1,c)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class eo extends $s{constructor(){super(os(eo.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=As,this._lastUpdate=0,this._state=new Ws("stopped"),this._boundLoop=this._loop.bind(this);const t=os(eo.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new to({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Es(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign($s.getDefaults(),{callback:As,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){jr(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}ws.mixin(eo);class no extends cs{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=os(no.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:As,onload:As,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return Nr(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=As,i=As){return Hr(e)?this._buffers.set(t.toString(),new Cs(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new Cs(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class io extends Bs{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class ro extends $s{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new fs,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}_s((t=>{t.draw=new ro({context:t})})),ys((t=>{t.draw.dispose()}));class so extends cs{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){Nr(Wr(t.time),"Events must have a time property"),Nr(Wr(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new oo(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class oo{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class ao extends Us{constructor(){super(os(ao.getDefaults(),arguments,["volume"])),this.name="Volume";const t=os(ao.getDefaults(),arguments,["volume"]);this.input=this.output=new Gs({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,Es(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Us.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class lo extends Us{constructor(){super(os(lo.getDefaults(),arguments)),this.name="Destination",this.input=new ao({context:this.context}),this.output=new Gs({context:this.context}),this.volume=this.input.volume;const t=os(lo.getDefaults(),arguments);qs(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Us.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),qs(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}_s((t=>{t.destination=new lo({context:t})})),ys((t=>{t.destination.dispose()}));class co extends cs{constructor(t){super(),this.name="TimelineValue",this._timeline=new fs({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class uo{constructor(t,e){this.id=uo._eventId++;const n=Object.assign(uo.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:As,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}uo._eventId=0;class ho extends uo{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(ho.getDefaults(),e);this.duration=new io(t.context,n.duration).valueOf(),this._interval=new io(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},uo.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new io(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new io(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new io(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class po extends $s{constructor(){super(os(po.getDefaults(),arguments)),this.name="Transport",this._loop=new co(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new fs,this._repeatedEvents=new so,this._syncedSignals=[],this._swingAmount=0;const t=os(po.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new eo({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),Es(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign($s.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new io(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new uo(this,{callback:t,time:new Bs(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){const r=new ho(this,{callback:t,duration:new Ns(this.context,i).toTicks(),interval:new Ns(this.context,e).toTicks(),time:new Bs(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(t,e){const n=new uo(this,{callback:t,once:!0,time:new Bs(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new io(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return Wr(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){qr(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Ns(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Ns(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new io(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new io(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}const n=new Gs(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),xs(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}ws.mixin(po),_s((t=>{t.transport=new po({context:t})})),ys((t=>{t.transport.dispose()}));class mo extends Us{constructor(t){super(t),this.input=void 0,this._state=new Ws("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=As,this._syncedStop=As,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new ao({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,Es(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Us.getDefaults(),{mute:!1,onstop:As,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=$r(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(as(e,0)),t.duration=n?this.toSeconds(n):void 0);const r=this.context.transport.schedule((t=>{this._start(t,e,n)}),i);this._scheduled.push(r),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else jr(this.context),this._start(i,e,n);else Nr(hs(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=$r(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||Wr(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,r)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=As,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class fo extends Ys{constructor(){super(os(fo.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=os(fo.getDefaults(),arguments,["url","onload"]);Hs(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new zs({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Cs(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Ys.getDefaults(),{url:new Cs,loop:!1,loopEnd:0,loopStart:0,onload:As,onerror:As,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){Nr(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(t);this._startGain(r,i),e=this.loop?as(e,this.loopStart):as(e,0);let s=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;ds(s,t)&&(s=(s-e)%n+e),ms(s,this.buffer.duration)&&(s=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,ps(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,s)),Wr(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(r+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function go(t,e){return Kr(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,i=new Ss(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0);return(yield i.render()).getChannelData(0)}))}class _o extends Ys{constructor(){super(os(_o.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=os(_o.getDefaults(),arguments,["frequency","type"]);Hs(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new zs({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new zs({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),Es(this,["frequency","detune"])}static getDefaults(){return Object.assign(Ys.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class vo extends mo{constructor(){super(os(vo.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=os(vo.getDefaults(),arguments,["frequency","type"]);this.frequency=new Zs({context:this.context,units:"frequency",value:t.frequency}),Es(this,"frequency"),this.detune=new Zs({context:this.context,units:"cents",value:t.detune}),Es(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(mo.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new _o({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return vo._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}))}{const t=vo._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(Wr(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),vo._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),vo._periodicWaveCache.length>100&&vo._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Lr(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),r=new Float32Array(n);let s=1;if("custom"===t){if(s=this._partials.length+1,this._partialCount=this._partials.length,n=s,0===this._partials.length)return[i,r]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(s=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],s=Math.max(s,2),n=s):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=s?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(i[o]=-a*Math.sin(e*o),r[o]=a*Math.cos(e*o)):(i[o]=0,r[o]=0)}return[i,r]}_inverseFFT(t,e,n){let i=0;const r=t.length;for(let s=0;s<r;s++)i+=t[s]*Math.cos(s*n)+e[s]*Math.sin(s*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let a=0;a<32;a++)n=Math.max(this._inverseFFT(t,e,a/32*i),n);return r=-this._inverseFFT(t,e,this._phase)/n,s=-1,o=1,Math.max(Math.min(r,o),s);var r,s,o}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return Kr(this,void 0,void 0,(function*(){return go(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}vo._periodicWaveCache=[];class yo extends Us{constructor(){super(Object.assign(os(yo.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return Ks(this,t,e,n),this}}class wo extends yo{constructor(){super(Object.assign(os(wo.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=os(wo.getDefaults(),arguments,["mapping","length"]);qr(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Zs.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,r=e;i<r;i++){const e=i/(r-1)*2-1;n[i]=t(e,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){Nr(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class bo extends yo{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new wo({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class To extends Zs{constructor(){super(Object.assign(os(To.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=os(To.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Gs({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Zs.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Eo extends mo{constructor(){super(os(Eo.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new bo({context:this.context}),this._modulationNode=new Gs({context:this.context});const t=os(Eo.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new vo({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new vo({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new To({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Es(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(vo.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Kr(this,void 0,void 0,(function*(){return go(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class xo extends mo{constructor(){super(os(xo.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Gs({context:this.context,gain:0});const t=os(xo.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new vo({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Zs({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new vo({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new To({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new To({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Es(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(vo.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Kr(this,void 0,void 0,(function*(){return go(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Ao extends mo{constructor(){super(os(Ao.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Gs({context:this.context,gain:0}),this._thresh=new wo({context:this.context,mapping:t=>t<=0?-1:1});const t=os(Ao.getDefaults(),arguments,["frequency","width"]);this.width=new Zs({context:this.context,units:"audioRange",value:t.width}),this._triangle=new vo({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Es(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(mo.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return Kr(this,void 0,void 0,(function*(){return go(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Co extends mo{constructor(){super(os(Co.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=os(Co.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Zs({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Zs({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,Es(this,["frequency","detune"])}static getDefaults(){return Object.assign(vo.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,i)=>t.detune.value=e+n*i))}}get count(){return this._oscillators.length}set count(t){if(Lr(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new vo({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):As});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return Kr(this,void 0,void 0,(function*(){return go(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class So extends mo{constructor(){super(os(So.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new To({context:this.context,value:2});const t=os(So.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Ao({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new vo({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Es(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(mo.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return Kr(this,void 0,void 0,(function*(){return go(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const ko={am:Eo,fat:Co,fm:xo,oscillator:vo,pulse:Ao,pwm:So};class Oo extends mo{constructor(){super(os(Oo.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=os(Oo.getDefaults(),arguments,["frequency","type"]);this.frequency=new Zs({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Zs({context:this.context,units:"cents",value:t.detune}),Es(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(vo.getDefaults(),xo.getDefaults(),Eo.getDefaults(),Co.getDefaults(),Ao.getDefaults(),So.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=ko[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof ko[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&zr(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&zr(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Hr(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return Kr(this,void 0,void 0,(function*(){return go(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function Mo(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Lr(i,t,e),n.set(this,i)}})}}function Do(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Lr(this.toSeconds(i),t,e),n.set(this,i)}})}}class Po extends mo{constructor(){super(os(Po.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=os(Po.getDefaults(),arguments,["url","onload"]);this._buffer=new Cs({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(mo.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:As,onerror:As,playbackRate:1,reverse:!1})}load(t){return Kr(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=As){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?as(e,this._loopStart):as(e,0);const i=this.toSeconds(e),r=n;n=as(n,Math.max(this._buffer.duration-i,0));let s=this.toSeconds(n);s/=this._playbackRate,t=this.toSeconds(t);const o=new fo({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+s),this._state.setStateAtTime("stopped",t+s,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&$r(r)?o.start(t,i):o.start(t,i,s-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Lr(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Lr(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}Zr([Do(0)],Po.prototype,"fadeIn",void 0),Zr([Do(0)],Po.prototype,"fadeOut",void 0);class Io extends Us{constructor(){super(os(Io.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Zs({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=os(Io.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Us.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Hr(t))return t;{let n;for(n in Fo)if(Fo[n][e]===t)return n;return t}}_setCurve(t,e,n){if(Hr(n)&&Reflect.has(Fo,n)){const i=Fo[n];Ur(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!qr(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){Nr(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),r=this.getValueAtTime(t);if(r>0){n=(1-r)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=r&&r<=i[t]){i=this._attackCurve.slice(t),i[0]=r;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){const r=e*this.sustain,s=t+n;this.log("decay",s),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(r,i+s):this._sig.exponentialApproachValueAtTime(r,s,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(Nr(qr(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return Ks(this,t,e,n),this}asArray(t=1024){return Kr(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new Ss(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=i+this.toSeconds(this.release),s=.1*r,o=r+s,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(i+s)/o,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}Zr([Do(0)],Io.prototype,"attack",void 0),Zr([Do(0)],Io.prototype,"decay",void 0),Zr([Mo(0,1)],Io.prototype,"sustain",void 0),Zr([Do(0)],Io.prototype,"release",void 0);const Fo=(()=>{const t=128;let e,n;const i=[];for(e=0;e<t;e++)i[e]=Math.sin(e/127*(Math.PI/2));const r=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;r[e]=t/10+.83*n}r[127]=1;const s=[];for(e=0;e<t;e++)s[e]=Math.ceil(e/127*5)/5;const o=[];for(e=0;e<t;e++)n=e/127,o[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,i=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(i*(1-n))}function l(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:l(a),Out:a},cosine:{In:i,Out:(c=i,c.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:r,Out:l(r)},sine:{In:o,Out:l(o)},step:{In:s,Out:l(s)}};var c})();class Ro extends Us{constructor(){super(os(Ro.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=os(Ro.getDefaults(),arguments);this._volume=this.output=new ao({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Es(this,"volume")}static getDefaults(){return Object.assign(Us.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const i=t[e],r=this.context.transport.schedule((i=>{t[e]=i,n.apply(this,t)}),i);this._scheduledEvents.push(r)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const r=this.toSeconds(n),s=this.toSeconds(e);return this.triggerAttack(t,r,i),this.triggerRelease(r+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class No extends Ro{constructor(){super(os(No.getDefaults(),arguments));const t=os(No.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Ro.getDefaults(),{detune:0,onsilence:As,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof Ls?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}Zr([Do(0)],No.prototype,"portamento",void 0);class Lo extends Io{constructor(){super(os(Lo.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Gs({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class jo extends No{constructor(){super(os(jo.getDefaults(),arguments)),this.name="Synth";const t=os(jo.getDefaults(),arguments);this.oscillator=new Oo(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Lo(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),Es(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(No.getDefaults(),{envelope:Object.assign(ls(Io.getDefaults(),Object.keys(Us.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(ls(Oo.getDefaults(),[...Object.keys(mo.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Vo extends jo{constructor(){super(os(Vo.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=os(Vo.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,Es(this,["oscillator","envelope"])}static getDefaults(){return ss(No.getDefaults(),jo.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof Ls?t.toFrequency():t),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Zr([Mo(0)],Vo.prototype,"octaves",void 0),Zr([Do(0)],Vo.prototype,"pitchDecay",void 0);const Bo=new Set;function $o(t){Bo.add(t)}function Wo(t,e){const n=`registerProcessor("${t}", ${e})`;Bo.add(n)}$o('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');$o("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");$o("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");Wo("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class zo extends Ro{constructor(){super(os(zo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=os(zo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const i=parseInt(n,10);if(Nr(Gr(n)||zr(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),Gr(n)){const i=new Ls(this.context,n).toMidi();e[i]=t.urls[n]}else zr(i)&&isFinite(i)&&(e[i]=t.urls[i])})),this._buffers=new no({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Ro.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:As,onerror:As,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const i=Fs(new Ls(this.context,t).toFrequency()),r=Math.round(i),s=i-r,o=this._findClosest(r),a=r-o,l=this._buffers.get(a),c=Ds(o+s),u=new fo({url:l,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:c}).connect(this.output);u.start(e,0,l.duration/c,n),qr(this._activeSources.get(r))||this._activeSources.set(r,[]),this._activeSources.get(r).push(u),u.onended=()=>{if(this._activeSources&&this._activeSources.has(r)){const t=this._activeSources.get(r),e=t.indexOf(u);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new Ls(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){const r=this.toSeconds(n);return this.triggerAttack(t,r,i),qr(e)?(Nr(qr(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,r+this.toSeconds(i))}))):this.triggerRelease(t,r+this.toSeconds(e)),this}add(t,e,n){if(Nr(Gr(t)||isFinite(t),`note must be a pitch or midi: ${t}`),Gr(t)){const i=new Ls(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}Zr([Do(0)],zo.prototype,"attack",void 0),Zr([Do(0)],zo.prototype,"release",void 0);class Uo extends Us{constructor(){super(Object.assign(os(Uo.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=os(Uo.getDefaults(),arguments,["pan"]);this.pan=new zs({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",Es(this,"pan")}static getDefaults(){return Object.assign(Us.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}Wo("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class qo extends Us{constructor(){super(os(qo.getDefaults(),arguments,["solo"])),this.name="Solo";const t=os(qo.getDefaults(),arguments,["solo"]);this.input=this.output=new Gs({context:this.context}),qo._allSolos.has(this.context)||qo._allSolos.set(this.context,new Set),qo._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Us.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),qo._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){qo._soloed.has(this.context)||qo._soloed.set(this.context,new Set),qo._soloed.get(this.context).add(this)}_removeSolo(){qo._soloed.has(this.context)&&qo._soloed.get(this.context).delete(this)}_isSoloed(){return qo._soloed.has(this.context)&&qo._soloed.get(this.context).has(this)}_noSolos(){return!qo._soloed.has(this.context)||qo._soloed.has(this.context)&&0===qo._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),qo._allSolos.get(this.context).delete(this),this._removeSolo(),this}}qo._allSolos=new Map,qo._soloed=new Map;class Ho extends Us{constructor(){super(os(Ho.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=os(Ho.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Uo({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new ao({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,Es(this,["pan","volume"])}static getDefaults(){return Object.assign(Us.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Go extends Us{constructor(){super(os(Go.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=os(Go.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new qo({solo:t.solo,context:this.context}),this._panVol=this.output=new Ho({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Es(this,["pan","volume"])}static getDefaults(){return Object.assign(Us.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return Go.buses.has(t)||Go.buses.set(t,new Gs({context:this.context})),Go.buses.get(t)}send(t,e=0){const n=this._getBus(t),i=new Gs({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Go.buses=new Map;class Yo extends Us{constructor(){super(...arguments),this.name="Listener",this.positionX=new zs({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new zs({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new zs({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new zs({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new zs({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new zs({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new zs({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new zs({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new zs({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Us.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}_s((t=>{t.listener=new Yo({context:t})})),ys((t=>{t.listener.dispose()})),Ms().transport,Ms().destination,Ms().destination,Ms().listener,Ms().draw;const Xo=Ms();class Zo{constructor(t,e,n,i,r="div"){this.parent=t,this.object=e,this.property=n,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(i),this.$name=document.createElement("div"),this.$name.classList.add("name"),Zo.nextNameID=Zo.nextNameID||0,this.$name.id="lil-gui-name-"+ ++Zo.nextNameID,this.$widget=document.createElement(r),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}name(t){return this._name=t,this.$name.innerHTML=t,this}onChange(t){return this._onChange=t,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),void 0!==this._onFinishChange&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(t=!0){return this.disable(!t)}disable(t=!0){return t===this._disabled||(this._disabled=t,this.domElement.classList.toggle("disabled",t),this.$disable.toggleAttribute("disabled",t)),this}show(t=!0){return this._hidden=!t,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(t){const e=this.parent.add(this.object,this.property,t);return e.name(this._name),this.destroy(),e}min(t){return this}max(t){return this}step(t){return this}decimals(t){return this}listen(t=!0){return this._listening=t,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const t=this.save();t!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=t}getValue(){return this.object[this.property]}setValue(t){return this.object[this.property]=t,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(t){return this.setValue(t),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class Ko extends Zo{constructor(t,e,n){super(t,e,n,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",(()=>{this.setValue(this.$input.checked),this._callOnFinishChange()})),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function Jo(t){let e,n;return(e=t.match(/(#|0x)?([a-f0-9]{6})/i))?n=e[2]:(e=t.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?n=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=t.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!n&&"#"+n}const Qo={isPrimitive:!0,match:t=>"string"==typeof t,fromHexString:Jo,toHexString:Jo},ta={isPrimitive:!0,match:t=>"number"==typeof t,fromHexString:t=>parseInt(t.substring(1),16),toHexString:t=>"#"+t.toString(16).padStart(6,0)},ea={isPrimitive:!1,match:Array.isArray,fromHexString(t,e,n=1){const i=ta.fromHexString(t);e[0]=(i>>16&255)/255*n,e[1]=(i>>8&255)/255*n,e[2]=(255&i)/255*n},toHexString:([t,e,n],i=1)=>ta.toHexString(t*(i=255/i)<<16^e*i<<8^n*i<<0)},na={isPrimitive:!1,match:t=>Object(t)===t,fromHexString(t,e,n=1){const i=ta.fromHexString(t);e.r=(i>>16&255)/255*n,e.g=(i>>8&255)/255*n,e.b=(255&i)/255*n},toHexString:({r:t,g:e,b:n},i=1)=>ta.toHexString(t*(i=255/i)<<16^e*i<<8^n*i<<0)},ia=[Qo,ta,ea,na];class ra extends Zo{constructor(t,e,n,i){var r;super(t,e,n,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=(r=this.initialValue,ia.find((t=>t.match(r)))),this._rgbScale=i,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",(()=>{this._setValueFromHexString(this.$input.value)})),this.$input.addEventListener("blur",(()=>{this._callOnFinishChange()})),this.$text.addEventListener("input",(()=>{const t=Jo(this.$text.value);t&&this._setValueFromHexString(t)})),this.$text.addEventListener("focus",(()=>{this._textFocused=!0,this.$text.select()})),this.$text.addEventListener("blur",(()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()})),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(t){if(this._format.isPrimitive){const e=this._format.fromHexString(t);this.setValue(e)}else this._format.fromHexString(t,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(t){return this._setValueFromHexString(t),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class sa extends Zo{constructor(t,e,n){super(t,e,n,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",(t=>{t.preventDefault(),this.getValue().call(this.object)})),this.$button.addEventListener("touchstart",(()=>{}),{passive:!0}),this.$disable=this.$button}}class oa extends Zo{constructor(t,e,n,i,r,s){super(t,e,n,"number"),this._initInput(),this.min(i),this.max(r);const o=void 0!==s;this.step(o?s:this._getImplicitStep(),o),this.updateDisplay()}decimals(t){return this._decimals=t,this.updateDisplay(),this}min(t){return this._min=t,this._onUpdateMinMax(),this}max(t){return this._max=t,this._onUpdateMinMax(),this}step(t,e=!0){return this._step=t,this._stepExplicit=e,this}updateDisplay(){const t=this.getValue();if(this._hasSlider){let e=(t-this._min)/(this._max-this._min);e=Math.max(0,Math.min(e,1)),this.$fill.style.width=100*e+"%"}return this._inputFocused||(this.$input.value=void 0===this._decimals?t:t.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$disable=this.$input;const t=t=>{const e=parseFloat(this.$input.value);isNaN(e)||(this._snapClampSetValue(e+t),this.$input.value=this.getValue())};let e,n,i,r,s,o=!1;const a=t=>{if(o){const i=t.clientX-e,r=t.clientY-n;Math.abs(r)>5?(t.preventDefault(),this.$input.blur(),o=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(i)>5&&l()}if(!o){const e=t.clientY-i;s-=e*this._step*this._arrowKeyMultiplier(t),r+s>this._max?s=this._max-r:r+s<this._min&&(s=this._min-r),this._snapClampSetValue(r+s)}i=t.clientY},l=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",l)};this.$input.addEventListener("input",(()=>{let t=parseFloat(this.$input.value);isNaN(t)||(this._stepExplicit&&(t=this._snap(t)),this.setValue(this._clamp(t)))})),this.$input.addEventListener("keydown",(e=>{"Enter"===e.code&&this.$input.blur(),"ArrowUp"===e.code&&(e.preventDefault(),t(this._step*this._arrowKeyMultiplier(e))),"ArrowDown"===e.code&&(e.preventDefault(),t(this._step*this._arrowKeyMultiplier(e)*-1))})),this.$input.addEventListener("wheel",(e=>{this._inputFocused&&(e.preventDefault(),t(this._step*this._normalizeMouseWheel(e)))}),{passive:!1}),this.$input.addEventListener("mousedown",(t=>{e=t.clientX,n=i=t.clientY,o=!0,r=this.getValue(),s=0,window.addEventListener("mousemove",a),window.addEventListener("mouseup",l)})),this.$input.addEventListener("focus",(()=>{this._inputFocused=!0})),this.$input.addEventListener("blur",(()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()}))}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=t=>{const e=this.$slider.getBoundingClientRect();let n=(i=t,r=e.left,s=e.right,o=this._min,(i-r)/(s-r)*(this._max-o)+o);var i,r,s,o;this._snapClampSetValue(n)},e=e=>{t(e.clientX)},n=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",n)};let i,r,s=!1;const o=e=>{e.preventDefault(),this._setDraggingStyle(!0),t(e.touches[0].clientX),s=!1},a=e=>{if(s){const t=e.touches[0].clientX-i,n=e.touches[0].clientY-r;Math.abs(t)>Math.abs(n)?o(e):(window.removeEventListener("touchmove",a),window.removeEventListener("touchend",l))}else e.preventDefault(),t(e.touches[0].clientX)},l=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",a),window.removeEventListener("touchend",l)},c=this._callOnFinishChange.bind(this);let u;this.$slider.addEventListener("mousedown",(i=>{this._setDraggingStyle(!0),t(i.clientX),window.addEventListener("mousemove",e),window.addEventListener("mouseup",n)})),this.$slider.addEventListener("touchstart",(t=>{t.touches.length>1||(this._hasScrollBar?(i=t.touches[0].clientX,r=t.touches[0].clientY,s=!0):o(t),window.addEventListener("touchmove",a,{passive:!1}),window.addEventListener("touchend",l))}),{passive:!1}),this.$slider.addEventListener("wheel",(t=>{if(Math.abs(t.deltaX)<Math.abs(t.deltaY)&&this._hasScrollBar)return;t.preventDefault();const e=this._normalizeMouseWheel(t)*this._step;this._snapClampSetValue(this.getValue()+e),this.$input.value=this.getValue(),clearTimeout(u),u=setTimeout(c,400)}),{passive:!1})}_setDraggingStyle(t,e="horizontal"){this.$slider&&this.$slider.classList.toggle("active",t),document.body.classList.toggle("lil-gui-dragging",t),document.body.classList.toggle("lil-gui-"+e,t)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(t){let{deltaX:e,deltaY:n}=t;return Math.floor(t.deltaY)!==t.deltaY&&t.wheelDelta&&(e=0,n=-t.wheelDelta/120,n*=this._stepExplicit?1:10),e+-n}_arrowKeyMultiplier(t){let e=this._stepExplicit?1:10;return t.shiftKey?e*=10:t.altKey&&(e/=10),e}_snap(t){const e=Math.round(t/this._step)*this._step;return parseFloat(e.toPrecision(15))}_clamp(t){return t<this._min&&(t=this._min),t>this._max&&(t=this._max),t}_snapClampSetValue(t){this.setValue(this._clamp(this._snap(t)))}get _hasScrollBar(){const t=this.parent.root.$children;return t.scrollHeight>t.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}}class aa extends Zo{constructor(t,e,n,i){super(t,e,n,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(i)?i:Object.values(i),this._names=Array.isArray(i)?i:Object.keys(i),this._names.forEach((t=>{const e=document.createElement("option");e.innerHTML=t,this.$select.appendChild(e)})),this.$select.addEventListener("change",(()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()})),this.$select.addEventListener("focus",(()=>{this.$display.classList.add("focus")})),this.$select.addEventListener("blur",(()=>{this.$display.classList.remove("focus")})),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const t=this.getValue(),e=this._values.indexOf(t);return this.$select.selectedIndex=e,this.$display.innerHTML=-1===e?t:this._names[e],this}}class la extends Zo{constructor(t,e,n){super(t,e,n,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",(()=>{this.setValue(this.$input.value)})),this.$input.addEventListener("keydown",(t=>{"Enter"===t.code&&this.$input.blur()})),this.$input.addEventListener("blur",(()=>{this._callOnFinishChange()})),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let ca=!1;class ua{constructor({parent:t,autoPlace:e=void 0===t,container:n,width:i,title:r="Controls",injectStyles:s=!0,touchStyles:o=!0}={}){if(this.parent=t,this.root=t?t.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",(()=>this.openAnimated(this._closed))),this.$title.addEventListener("keydown",(t=>{"Enter"!==t.code&&"Space"!==t.code||(t.preventDefault(),this.$title.click())})),this.$title.addEventListener("touchstart",(()=>{}),{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(r),o&&this.domElement.classList.add("allow-touch-styles"),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),!ca&&s&&(function(t){const e=document.createElement("style");e.innerHTML='.lil-gui{--background-color:#1f1f1f;--text-color:#ebebeb;--title-background-color:#111;--title-text-color:#ebebeb;--widget-color:#424242;--hover-color:#4f4f4f;--focus-color:#595959;--number-color:#2cc9ff;--string-color:#a2db3c;--font-size:11px;--input-font-size:11px;--font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;--font-family-mono:Menlo,Monaco,Consolas,"Droid Sans Mono",monospace;--padding:4px;--spacing:4px;--widget-height:20px;--name-width:45%;--slider-knob-width:2px;--slider-input-width:27%;--color-input-width:27%;--slider-input-min-width:45px;--color-input-min-width:45px;--folder-indent:7px;--widget-padding:0 0 0 3px;--widget-border-radius:2px;--checkbox-size:calc(var(--widget-height)*0.75);--scrollbar-width:5px;background-color:var(--background-color);color:var(--text-color);font-family:var(--font-family);font-size:var(--font-size);font-style:normal;font-weight:400;line-height:1;text-align:left;touch-action:manipulation;user-select:none;-webkit-user-select:none}.lil-gui,.lil-gui *{box-sizing:border-box;margin:0;padding:0}.lil-gui.root{display:flex;flex-direction:column;width:var(--width,245px)}.lil-gui.root>.title{background:var(--title-background-color);color:var(--title-text-color)}.lil-gui.root>.children{overflow-x:hidden;overflow-y:auto}.lil-gui.root>.children::-webkit-scrollbar{background:var(--background-color);height:var(--scrollbar-width);width:var(--scrollbar-width)}.lil-gui.root>.children::-webkit-scrollbar-thumb{background:var(--focus-color);border-radius:var(--scrollbar-width)}.lil-gui.force-touch-styles{--widget-height:28px;--padding:6px;--spacing:6px;--font-size:13px;--input-font-size:16px;--folder-indent:10px;--scrollbar-width:7px;--slider-input-min-width:50px;--color-input-min-width:65px}.lil-gui.autoPlace{max-height:100%;position:fixed;right:15px;top:0;z-index:1001}.lil-gui .controller{align-items:center;display:flex;margin:var(--spacing) 0;padding:0 var(--padding)}.lil-gui .controller.disabled{opacity:.5}.lil-gui .controller.disabled,.lil-gui .controller.disabled *{pointer-events:none!important}.lil-gui .controller>.name{flex-shrink:0;line-height:var(--widget-height);min-width:var(--name-width);padding-right:var(--spacing);white-space:pre}.lil-gui .controller .widget{align-items:center;display:flex;min-height:var(--widget-height);position:relative;width:100%}.lil-gui .controller.string input{color:var(--string-color)}.lil-gui .controller.boolean .widget{cursor:pointer}.lil-gui .controller.color .display{border-radius:var(--widget-border-radius);height:var(--widget-height);position:relative;width:100%}.lil-gui .controller.color input[type=color]{cursor:pointer;height:100%;opacity:0;width:100%}.lil-gui .controller.color input[type=text]{flex-shrink:0;font-family:var(--font-family-mono);margin-left:var(--spacing);min-width:var(--color-input-min-width);width:var(--color-input-width)}.lil-gui .controller.option select{max-width:100%;opacity:0;position:absolute;width:100%}.lil-gui .controller.option .display{background:var(--widget-color);border-radius:var(--widget-border-radius);height:var(--widget-height);line-height:var(--widget-height);max-width:100%;overflow:hidden;padding-left:.55em;padding-right:1.75em;pointer-events:none;position:relative;word-break:break-all}.lil-gui .controller.option .display.active{background:var(--focus-color)}.lil-gui .controller.option .display:after{bottom:0;content:"";font-family:lil-gui;padding-right:.375em;position:absolute;right:0;top:0}.lil-gui .controller.option .widget,.lil-gui .controller.option select{cursor:pointer}.lil-gui .controller.number input{color:var(--number-color)}.lil-gui .controller.number.hasSlider input{flex-shrink:0;margin-left:var(--spacing);min-width:var(--slider-input-min-width);width:var(--slider-input-width)}.lil-gui .controller.number .slider{background-color:var(--widget-color);border-radius:var(--widget-border-radius);cursor:ew-resize;height:var(--widget-height);overflow:hidden;padding-right:var(--slider-knob-width);touch-action:pan-y;width:100%}.lil-gui .controller.number .slider.active{background-color:var(--focus-color)}.lil-gui .controller.number .slider.active .fill{opacity:.95}.lil-gui .controller.number .fill{border-right:var(--slider-knob-width) solid var(--number-color);box-sizing:content-box;height:100%}.lil-gui-dragging .lil-gui{--hover-color:var(--widget-color)}.lil-gui-dragging *{cursor:ew-resize!important}.lil-gui-dragging.lil-gui-vertical *{cursor:ns-resize!important}.lil-gui .title{--title-height:calc(var(--widget-height) + var(--spacing)*1.25);-webkit-tap-highlight-color:transparent;text-decoration-skip:objects;cursor:pointer;font-weight:600;height:var(--title-height);line-height:calc(var(--title-height) - 4px);outline:none;padding:0 var(--padding)}.lil-gui .title:before{content:"";display:inline-block;font-family:lil-gui;padding-right:2px}.lil-gui .title:active{background:var(--title-background-color);opacity:.75}.lil-gui.root>.title:focus{text-decoration:none!important}.lil-gui.closed>.title:before{content:""}.lil-gui.closed>.children{opacity:0;transform:translateY(-7px)}.lil-gui.closed:not(.transition)>.children{display:none}.lil-gui.transition>.children{overflow:hidden;pointer-events:none;transition-duration:.3s;transition-property:height,opacity,transform;transition-timing-function:cubic-bezier(.2,.6,.35,1)}.lil-gui .children:empty:before{content:"Empty";display:block;font-style:italic;height:var(--widget-height);line-height:var(--widget-height);margin:var(--spacing) 0;opacity:.5;padding:0 var(--padding)}.lil-gui.root>.children>.lil-gui>.title{border-width:0;border-bottom:1px solid var(--widget-color);border-left:0 solid var(--widget-color);border-right:0 solid var(--widget-color);border-top:1px solid var(--widget-color);transition:border-color .3s}.lil-gui.root>.children>.lil-gui.closed>.title{border-bottom-color:transparent}.lil-gui+.controller{border-top:1px solid var(--widget-color);margin-top:0;padding-top:var(--spacing)}.lil-gui .lil-gui .lil-gui>.title{border:none}.lil-gui .lil-gui .lil-gui>.children{border:none;border-left:2px solid var(--widget-color);margin-left:var(--folder-indent)}.lil-gui .lil-gui .controller{border:none}.lil-gui input{-webkit-tap-highlight-color:transparent;background:var(--widget-color);border:0;border-radius:var(--widget-border-radius);color:var(--text-color);font-family:var(--font-family);font-size:var(--input-font-size);height:var(--widget-height);outline:none;width:100%}.lil-gui input:disabled{opacity:1}.lil-gui input[type=number],.lil-gui input[type=text]{padding:var(--widget-padding)}.lil-gui input[type=number]:focus,.lil-gui input[type=text]:focus{background:var(--focus-color)}.lil-gui input::-webkit-inner-spin-button,.lil-gui input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.lil-gui input[type=number]{-moz-appearance:textfield}.lil-gui input[type=checkbox]{appearance:none;-webkit-appearance:none;border-radius:var(--widget-border-radius);cursor:pointer;height:var(--checkbox-size);text-align:center;width:var(--checkbox-size)}.lil-gui input[type=checkbox]:checked:before{content:"";font-family:lil-gui;font-size:var(--checkbox-size);line-height:var(--checkbox-size)}.lil-gui button{-webkit-tap-highlight-color:transparent;background:var(--widget-color);border:1px solid var(--widget-color);border-radius:var(--widget-border-radius);color:var(--text-color);cursor:pointer;font-family:var(--font-family);font-size:var(--font-size);height:var(--widget-height);line-height:calc(var(--widget-height) - 4px);outline:none;text-align:center;text-transform:none;width:100%}.lil-gui button:active{background:var(--focus-color)}@font-face{font-family:lil-gui;src:url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff")}@media (pointer:coarse){.lil-gui.allow-touch-styles{--widget-height:28px;--padding:6px;--spacing:6px;--font-size:13px;--input-font-size:16px;--folder-indent:10px;--scrollbar-width:7px;--slider-input-min-width:50px;--color-input-min-width:65px}}@media (hover:hover){.lil-gui .controller.color .display:hover:before{border:1px solid #fff9;border-radius:var(--widget-border-radius);bottom:0;content:" ";display:block;left:0;position:absolute;right:0;top:0}.lil-gui .controller.option .display.focus{background:var(--focus-color)}.lil-gui .controller.option .widget:hover .display{background:var(--hover-color)}.lil-gui .controller.number .slider:hover{background-color:var(--hover-color)}body:not(.lil-gui-dragging) .lil-gui .title:hover{background:var(--title-background-color);opacity:.85}.lil-gui .title:focus{text-decoration:underline var(--focus-color)}.lil-gui input:hover{background:var(--hover-color)}.lil-gui input:active{background:var(--focus-color)}.lil-gui input[type=checkbox]:focus{box-shadow:inset 0 0 0 1px var(--focus-color)}.lil-gui button:hover{background:var(--hover-color);border-color:var(--hover-color)}.lil-gui button:focus{border-color:var(--focus-color)}}';const n=document.querySelector("head link[rel=stylesheet], head style");n?document.head.insertBefore(e,n):document.head.appendChild(e)}(),ca=!0),n?n.appendChild(this.domElement):e&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),i&&this.domElement.style.setProperty("--width",i+"px"),this.domElement.addEventListener("keydown",(t=>t.stopPropagation())),this.domElement.addEventListener("keyup",(t=>t.stopPropagation()))}add(t,e,n,i,r){if(Object(n)===n)return new aa(this,t,e,n);switch(typeof t[e]){case"number":return new oa(this,t,e,n,i,r);case"boolean":return new Ko(this,t,e);case"string":return new la(this,t,e);case"function":return new sa(this,t,e)}}addColor(t,e,n=1){return new ra(this,t,e,n)}addFolder(t){return new ua({parent:this,title:t})}load(t,e=!0){return t.controllers&&this.controllers.forEach((e=>{e instanceof sa||e._name in t.controllers&&e.load(t.controllers[e._name])})),e&&t.folders&&this.folders.forEach((e=>{e._title in t.folders&&e.load(t.folders[e._title])})),this}save(t=!0){const e={controllers:{},folders:{}};return this.controllers.forEach((t=>{if(!(t instanceof sa)){if(t._name in e.controllers)throw new Error(`Cannot save GUI with duplicate property "${t._name}"`);e.controllers[t._name]=t.save()}})),t&&this.folders.forEach((t=>{if(t._title in e.folders)throw new Error(`Cannot save GUI with duplicate folder "${t._title}"`);e.folders[t._title]=t.save()})),e}open(t=!0){return this._closed=!t,this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}show(t=!0){return this._hidden=!t,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(t=!0){return this._closed=!t,this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame((()=>{const e=this.$children.clientHeight;this.$children.style.height=e+"px",this.domElement.classList.add("transition");const n=t=>{t.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);const i=t?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!t),requestAnimationFrame((()=>{this.$children.style.height=i+"px"}))})),this}title(t){return this._title=t,this.$title.innerHTML=t,this}reset(t=!0){return(t?this.controllersRecursive():this.controllers).forEach((t=>t.reset())),this}onChange(t){return this._onChange=t,this}_callOnChange(t){this.parent&&this.parent._callOnChange(t),void 0!==this._onChange&&this._onChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(t){this.parent&&this.parent._callOnFinishChange(t),void 0!==this._onFinishChange&&this._onFinishChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach((t=>t.destroy()))}controllersRecursive(){let t=Array.from(this.controllers);return this.folders.forEach((e=>{t=t.concat(e.controllersRecursive())})),t}foldersRecursive(){let t=Array.from(this.folders);return this.folders.forEach((e=>{t=t.concat(e.foldersRecursive())})),t}}const ha={type:"change"},da={type:"start"},pa={type:"end"},ma=new a,fa=new l,ga=Math.cos(70*c.DEG2RAD);class _a extends t{constructor(t,a){super(),this.object=t,this.domElement=a,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new e,this.cursor=new e,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:n.ROTATE,MIDDLE:n.DOLLY,RIGHT:n.PAN},this.touches={ONE:i.ROTATE,TWO:i.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",J),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",J),this._domElementKeyEvents=null},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(ha),l.update(),u=c.NONE},this.update=function(){const n=new e,i=(new s).setFromUnitVectors(t.up,new e(0,1,0)),r=i.clone().invert(),o=new e,a=new s,g=new e,_=2*Math.PI;return function(s=null){const v=l.object.position;n.copy(v).sub(l.target),n.applyQuaternion(i),d.setFromVector3(n),l.autoRotate&&u===c.NONE&&D(function(t){return null!==t?2*Math.PI/60*l.autoRotateSpeed*t:2*Math.PI/60/60*l.autoRotateSpeed}(s)),l.enableDamping?(d.theta+=p.theta*l.dampingFactor,d.phi+=p.phi*l.dampingFactor):(d.theta+=p.theta,d.phi+=p.phi);let y=l.minAzimuthAngle,w=l.maxAzimuthAngle;isFinite(y)&&isFinite(w)&&(y<-Math.PI?y+=_:y>Math.PI&&(y-=_),w<-Math.PI?w+=_:w>Math.PI&&(w-=_),d.theta=y<=w?Math.max(y,Math.min(w,d.theta)):d.theta>(y+w)/2?Math.max(y,d.theta):Math.min(w,d.theta)),d.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,d.phi)),d.makeSafe(),!0===l.enableDamping?l.target.addScaledVector(f,l.dampingFactor):l.target.add(f),l.target.sub(l.cursor),l.target.clampLength(l.minTargetRadius,l.maxTargetRadius),l.target.add(l.cursor),l.zoomToCursor&&S||l.object.isOrthographicCamera?d.radius=V(d.radius):d.radius=V(d.radius*m),n.setFromSpherical(d),n.applyQuaternion(r),v.copy(l.target).add(n),l.object.lookAt(l.target),!0===l.enableDamping?(p.theta*=1-l.dampingFactor,p.phi*=1-l.dampingFactor,f.multiplyScalar(1-l.dampingFactor)):(p.set(0,0,0),f.set(0,0,0));let b=!1;if(l.zoomToCursor&&S){let i=null;if(l.object.isPerspectiveCamera){const t=n.length();i=V(t*m);const e=t-i;l.object.position.addScaledVector(A,e),l.object.updateMatrixWorld()}else if(l.object.isOrthographicCamera){const t=new e(C.x,C.y,0);t.unproject(l.object),l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/m)),l.object.updateProjectionMatrix(),b=!0;const r=new e(C.x,C.y,0);r.unproject(l.object),l.object.position.sub(r).add(t),l.object.updateMatrixWorld(),i=n.length()}else l.zoomToCursor=!1;null!==i&&(this.screenSpacePanning?l.target.set(0,0,-1).transformDirection(l.object.matrix).multiplyScalar(i).add(l.object.position):(ma.origin.copy(l.object.position),ma.direction.set(0,0,-1).transformDirection(l.object.matrix),Math.abs(l.object.up.dot(ma.direction))<ga?t.lookAt(l.target):(fa.setFromNormalAndCoplanarPoint(l.object.up,l.target),ma.intersectPlane(fa,l.target))))}else l.object.isOrthographicCamera&&(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/m)),l.object.updateProjectionMatrix(),b=!0);return m=1,S=!1,!!(b||o.distanceToSquared(l.object.position)>h||8*(1-a.dot(l.object.quaternion))>h||g.distanceToSquared(l.target)>0)&&(l.dispatchEvent(ha),o.copy(l.object.position),a.copy(l.object.quaternion),g.copy(l.target),!0)}}(),this.dispose=function(){l.domElement.removeEventListener("contextmenu",Q),l.domElement.removeEventListener("pointerdown",Y),l.domElement.removeEventListener("pointercancel",Z),l.domElement.removeEventListener("wheel",K),l.domElement.removeEventListener("pointermove",X),l.domElement.removeEventListener("pointerup",Z),null!==l._domElementKeyEvents&&(l._domElementKeyEvents.removeEventListener("keydown",J),l._domElementKeyEvents=null)};const l=this,c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let u=c.NONE;const h=1e-6,d=new r,p=new r;let m=1;const f=new e,g=new o,_=new o,v=new o,y=new o,w=new o,b=new o,T=new o,E=new o,x=new o,A=new e,C=new o;let S=!1;const k=[],O={};function M(t){const e=Math.abs(t)/(100*(0|window.devicePixelRatio));return Math.pow(.95,l.zoomSpeed*e)}function D(t){p.theta-=t}function P(t){p.phi-=t}const I=function(){const t=new e;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),f.add(t)}}(),F=function(){const t=new e;return function(e,n){!0===l.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(l.object.up,t)),t.multiplyScalar(e),f.add(t)}}(),R=function(){const t=new e;return function(e,n){const i=l.domElement;if(l.object.isPerspectiveCamera){const r=l.object.position;t.copy(r).sub(l.target);let s=t.length();s*=Math.tan(l.object.fov/2*Math.PI/180),I(2*e*s/i.clientHeight,l.object.matrix),F(2*n*s/i.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(I(e*(l.object.right-l.object.left)/l.object.zoom/i.clientWidth,l.object.matrix),F(n*(l.object.top-l.object.bottom)/l.object.zoom/i.clientHeight,l.object.matrix)):l.enablePan=!1}}();function N(t){l.object.isPerspectiveCamera||l.object.isOrthographicCamera?m/=t:l.enableZoom=!1}function L(t){l.object.isPerspectiveCamera||l.object.isOrthographicCamera?m*=t:l.enableZoom=!1}function j(t,e){if(!l.zoomToCursor)return;S=!0;const n=l.domElement.getBoundingClientRect(),i=t-n.left,r=e-n.top,s=n.width,o=n.height;C.x=i/s*2-1,C.y=-r/o*2+1,A.set(C.x,C.y,1).unproject(l.object).sub(l.object.position).normalize()}function V(t){return Math.max(l.minDistance,Math.min(l.maxDistance,t))}function B(t){g.set(t.clientX,t.clientY)}function $(t){y.set(t.clientX,t.clientY)}function W(t){if(1===k.length)g.set(t.pageX,t.pageY);else{const e=et(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);g.set(n,i)}}function z(t){if(1===k.length)y.set(t.pageX,t.pageY);else{const e=et(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);y.set(n,i)}}function U(t){const e=et(t),n=t.pageX-e.x,i=t.pageY-e.y,r=Math.sqrt(n*n+i*i);T.set(0,r)}function q(t){if(1==k.length)_.set(t.pageX,t.pageY);else{const e=et(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);_.set(n,i)}v.subVectors(_,g).multiplyScalar(l.rotateSpeed);const e=l.domElement;D(2*Math.PI*v.x/e.clientHeight),P(2*Math.PI*v.y/e.clientHeight),g.copy(_)}function H(t){if(1===k.length)w.set(t.pageX,t.pageY);else{const e=et(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);w.set(n,i)}b.subVectors(w,y).multiplyScalar(l.panSpeed),R(b.x,b.y),y.copy(w)}function G(t){const e=et(t),n=t.pageX-e.x,i=t.pageY-e.y,r=Math.sqrt(n*n+i*i);E.set(0,r),x.set(0,Math.pow(E.y/T.y,l.zoomSpeed)),N(x.y),T.copy(E);j(.5*(t.pageX+e.x),.5*(t.pageY+e.y))}function Y(t){!1!==l.enabled&&(0===k.length&&(l.domElement.setPointerCapture(t.pointerId),l.domElement.addEventListener("pointermove",X),l.domElement.addEventListener("pointerup",Z)),function(t){k.push(t.pointerId)}(t),"touch"===t.pointerType?function(t){switch(tt(t),k.length){case 1:switch(l.touches.ONE){case i.ROTATE:if(!1===l.enableRotate)return;W(t),u=c.TOUCH_ROTATE;break;case i.PAN:if(!1===l.enablePan)return;z(t),u=c.TOUCH_PAN;break;default:u=c.NONE}break;case 2:switch(l.touches.TWO){case i.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&U(t),l.enablePan&&z(t)}(t),u=c.TOUCH_DOLLY_PAN;break;case i.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&U(t),l.enableRotate&&W(t)}(t),u=c.TOUCH_DOLLY_ROTATE;break;default:u=c.NONE}break;default:u=c.NONE}u!==c.NONE&&l.dispatchEvent(da)}(t):function(t){let e;switch(t.button){case 0:e=l.mouseButtons.LEFT;break;case 1:e=l.mouseButtons.MIDDLE;break;case 2:e=l.mouseButtons.RIGHT;break;default:e=-1}switch(e){case n.DOLLY:if(!1===l.enableZoom)return;!function(t){j(t.clientX,t.clientX),T.set(t.clientX,t.clientY)}(t),u=c.DOLLY;break;case n.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enablePan)return;$(t),u=c.PAN}else{if(!1===l.enableRotate)return;B(t),u=c.ROTATE}break;case n.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enableRotate)return;B(t),u=c.ROTATE}else{if(!1===l.enablePan)return;$(t),u=c.PAN}break;default:u=c.NONE}u!==c.NONE&&l.dispatchEvent(da)}(t))}function X(t){!1!==l.enabled&&("touch"===t.pointerType?function(t){switch(tt(t),u){case c.TOUCH_ROTATE:if(!1===l.enableRotate)return;q(t),l.update();break;case c.TOUCH_PAN:if(!1===l.enablePan)return;H(t),l.update();break;case c.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&G(t),l.enablePan&&H(t)}(t),l.update();break;case c.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&G(t),l.enableRotate&&q(t)}(t),l.update();break;default:u=c.NONE}}(t):function(t){switch(u){case c.ROTATE:if(!1===l.enableRotate)return;!function(t){_.set(t.clientX,t.clientY),v.subVectors(_,g).multiplyScalar(l.rotateSpeed);const e=l.domElement;D(2*Math.PI*v.x/e.clientHeight),P(2*Math.PI*v.y/e.clientHeight),g.copy(_),l.update()}(t);break;case c.DOLLY:if(!1===l.enableZoom)return;!function(t){E.set(t.clientX,t.clientY),x.subVectors(E,T),x.y>0?N(M(x.y)):x.y<0&&L(M(x.y)),T.copy(E),l.update()}(t);break;case c.PAN:if(!1===l.enablePan)return;!function(t){w.set(t.clientX,t.clientY),b.subVectors(w,y).multiplyScalar(l.panSpeed),R(b.x,b.y),y.copy(w),l.update()}(t)}}(t))}function Z(t){!function(t){delete O[t.pointerId];for(let e=0;e<k.length;e++)if(k[e]==t.pointerId)return void k.splice(e,1)}(t),0===k.length&&(l.domElement.releasePointerCapture(t.pointerId),l.domElement.removeEventListener("pointermove",X),l.domElement.removeEventListener("pointerup",Z)),l.dispatchEvent(pa),u=c.NONE}function K(t){!1!==l.enabled&&!1!==l.enableZoom&&u===c.NONE&&(t.preventDefault(),l.dispatchEvent(da),function(t){j(t.clientX,t.clientY),t.deltaY<0?L(M(t.deltaY)):t.deltaY>0&&N(M(t.deltaY)),l.update()}(t),l.dispatchEvent(pa))}function J(t){!1!==l.enabled&&!1!==l.enablePan&&function(t){let e=!1;switch(t.code){case l.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?P(2*Math.PI*l.rotateSpeed/l.domElement.clientHeight):R(0,l.keyPanSpeed),e=!0;break;case l.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?P(-2*Math.PI*l.rotateSpeed/l.domElement.clientHeight):R(0,-l.keyPanSpeed),e=!0;break;case l.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?D(2*Math.PI*l.rotateSpeed/l.domElement.clientHeight):R(l.keyPanSpeed,0),e=!0;break;case l.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?D(-2*Math.PI*l.rotateSpeed/l.domElement.clientHeight):R(-l.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),l.update())}(t)}function Q(t){!1!==l.enabled&&t.preventDefault()}function tt(t){let e=O[t.pointerId];void 0===e&&(e=new o,O[t.pointerId]=e),e.set(t.pageX,t.pageY)}function et(t){const e=t.pointerId===k[0]?k[1]:k[0];return O[e]}l.domElement.addEventListener("contextmenu",Q),l.domElement.addEventListener("pointerdown",Y),l.domElement.addEventListener("pointercancel",Z),l.domElement.addEventListener("wheel",K,{passive:!1}),this.update()}}class va{constructor(t,n,i,r,s){this.scene=t,this.renderer=n,this.camera=i,this.mousePos=new o,this.raycaster=new u,this.raycaster.params.Line.threshold=.1,this.grabDistance=0,this.active=!1,this.physicsObject=null,this.controls=s,this.arrow=new h(new e(0,1,0),new e(0,0,0),15,6710886),this.arrow.setLength(15,3,1),this.scene.add(this.arrow),this.arrow.line.material.transparent=!0,this.arrow.cone.material.transparent=!0,this.arrow.line.material.opacity=.5,this.arrow.cone.material.opacity=.5,this.arrow.visible=!1,this.previouslySelected=null,this.higlightColor=16711680,this.localHit=new e,this.worldHit=new e,this.currentWorld=new e,r.addEventListener("pointerdown",this.onPointer.bind(this),!0),document.addEventListener("pointermove",this.onPointer.bind(this),!0),document.addEventListener("pointerup",this.onPointer.bind(this),!0),document.addEventListener("pointerout",this.onPointer.bind(this),!0),r.addEventListener("dblclick",this.onPointer.bind(this),!1)}updateRaycaster(t,e){var n=this.renderer.domElement.getBoundingClientRect();this.mousePos.x=(t-n.left)/n.width*2-1,this.mousePos.y=-(e-n.top)/n.height*2+1,this.raycaster.setFromCamera(this.mousePos,this.camera)}start(t,e){this.physicsObject=null,this.updateRaycaster(t,e);let n=this.raycaster.intersectObjects(this.scene.children);for(let i=0;i<n.length;i++){let t=n[i].object;if(t.bodyID&&t.bodyID>0){this.physicsObject=t,this.grabDistance=n[0].distance;let e=this.raycaster.ray.origin.clone();e.addScaledVector(this.raycaster.ray.direction,this.grabDistance),this.arrow.position.copy(e),this.active=!0,this.controls.enabled=!1,this.localHit=t.worldToLocal(e.clone()),this.worldHit.copy(e),this.currentWorld.copy(e),this.arrow.visible=!0;break}}}move(t,e){if(this.active){this.updateRaycaster(t,e);let n=this.raycaster.ray.origin.clone();n.addScaledVector(this.raycaster.ray.direction,this.grabDistance),this.currentWorld.copy(n),this.update(),this.physicsObject}}update(){this.worldHit&&this.localHit&&this.currentWorld&&this.arrow&&this.physicsObject&&(this.worldHit.copy(this.localHit),this.physicsObject.localToWorld(this.worldHit),this.arrow.position.copy(this.worldHit),this.arrow.setDirection(this.currentWorld.clone().sub(this.worldHit).normalize()),this.arrow.setLength(this.currentWorld.clone().sub(this.worldHit).length()))}end(t){this.physicsObject=null,this.active=!1,this.controls.enabled=!0,this.arrow.visible=!1,this.mouseDown=!1}onPointer(t){"pointerdown"==t.type?(this.start(t.clientX,t.clientY),this.mouseDown=!0):"pointermove"==t.type&&this.mouseDown?this.active&&this.move(t.clientX,t.clientY):"pointerup"==t.type&&this.end(t),"dblclick"==t.type&&(this.start(t.clientX,t.clientY),this.doubleClick=!0,this.physicsObject?this.physicsObject==this.previouslySelected?(this.physicsObject.material.emissive.setHex(0),this.previouslySelected=null):(this.previouslySelected&&this.previouslySelected.material.emissive.setHex(0),this.physicsObject.material.emissive.setHex(this.higlightColor),this.previouslySelected=this.physicsObject):this.previouslySelected&&(this.previouslySelected.material.emissive.setHex(0),this.previouslySelected=null))}}class ya{constructor(t){this.dtypes={"<u1":{name:"uint8",size:8,arrayConstructor:Uint8Array},"|u1":{name:"uint8",size:8,arrayConstructor:Uint8Array},"<u2":{name:"uint16",size:16,arrayConstructor:Uint16Array},"|i1":{name:"int8",size:8,arrayConstructor:Int8Array},"<i2":{name:"int16",size:16,arrayConstructor:Int16Array},"<u4":{name:"uint32",size:32,arrayConstructor:Int32Array},"<i4":{name:"int32",size:32,arrayConstructor:Int32Array},"<u8":{name:"uint64",size:64,arrayConstructor:BigUint64Array},"<i8":{name:"int64",size:64,arrayConstructor:BigInt64Array},"<f4":{name:"float32",size:32,arrayConstructor:Float32Array},"<f8":{name:"float64",size:64,arrayConstructor:Float64Array}}}parse(t){const e=new DataView(t.slice(8,10)).getUint8(0),n=10+e,i=new TextDecoder("utf-8").decode(new Uint8Array(t.slice(10,10+e))),r=JSON.parse(i.toLowerCase().replace(/'/g,'"').replace("(","[").replace(/,*\),*/g,"]")),s=r.shape,o=this.dtypes[r.descr],a=new o.arrayConstructor(t,n);return{dtype:o.name,data:a,shape:s,fortranOrder:r.fortran_order}}async load(t,e,n){n=n||{};const i=await fetch(t,{...n}),r=await i.arrayBuffer(),s=this.parse(r);return e?e(s):s}}const wa=new Map([[0,"A0"],[1,"A#0"],[2,"B0"],[3,"C1"],[4,"C#1"],[5,"D1"],[6,"D#1"],[7,"E1"],[8,"F1"],[9,"F#1"],[10,"G1"],[11,"G#1"],[12,"A1"],[13,"A#1"],[14,"B1"],[15,"C2"],[16,"C#2"],[17,"D2"],[18,"D#2"],[19,"E2"],[20,"F2"],[21,"F#2"],[22,"G2"],[23,"G#2"],[24,"A2"],[25,"A#2"],[26,"B2"],[27,"C3"],[28,"C#3"],[29,"D3"],[30,"D#3"],[31,"E3"],[32,"F3"],[33,"F#3"],[34,"G3"],[35,"G#3"],[36,"A3"],[37,"A#3"],[38,"B3"],[39,"C4"],[40,"C#4"],[41,"D4"],[42,"D#4"],[43,"E4"],[44,"F4"],[45,"F#4"],[46,"G4"],[47,"G#4"],[48,"A4"],[49,"A#4"],[50,"B4"],[51,"C5"],[52,"C#5"],[53,"D5"],[54,"D#5"],[55,"E5"],[56,"F5"],[57,"F#5"],[58,"G5"],[59,"G#5"],[60,"A5"],[61,"A#5"],[62,"B5"],[63,"C6"],[64,"C#6"],[65,"D6"],[66,"D#6"],[67,"E6"],[68,"F6"],[69,"F#6"],[70,"G6"],[71,"G#6"],[72,"A6"],[73,"A#6"],[74,"B6"],[75,"C7"],[76,"C#7"],[77,"D7"],[78,"D#7"],[79,"E7"],[80,"F7"],[81,"F#7"],[82,"G7"],[83,"G#7"],[84,"A7"],[85,"A#7"],[86,"B7"],[87,"C8"]]);class ba extends d{constructor(t,n={}){super(t),this.isReflector=!0,this.type="Reflector",this.camera=new p;const i=this;void 0!==n.color?new m(n.color):new m(8355711);const r=n.textureWidth||512,s=n.textureHeight||512,o=n.clipBias||0;n.shader||ba.ReflectorShader;const a=void 0!==n.multisample?n.multisample:4,c=n.texture||void 0,u=new l,h=new e,d=new e,T=new e,E=new f,x=new e(0,0,-1),A=new g,C=new e,S=new e,k=new g,O=new f,M=this.camera,D=new _(r,s,{samples:a,type:v});this.material=new y({map:c}),this.material.uniforms={tDiffuse:{value:D.texture},textureMatrix:{value:O}},this.material.onBeforeCompile=t=>{let e=t.vertexShader.indexOf("void main() {");t.vertexShader=t.vertexShader.slice(0,e)+"\nuniform mat4 textureMatrix;\nvarying vec4 vUv3;\n"+t.vertexShader.slice(e-1,-1)+"\tvUv3 = textureMatrix * vec4( position, 1.0 ); }",e=t.fragmentShader.indexOf("void main() {"),t.fragmentShader="\nuniform sampler2D tDiffuse; \n varying vec4 vUv3;\n"+t.fragmentShader.slice(0,e)+t.fragmentShader.slice(e-1,-1)+"\tgl_FragColor = vec4( mix( texture2DProj( tDiffuse,  vUv3 ).rgb, gl_FragColor.rgb , 0.5), 1.0 );\n\t\t\t\t}",t.uniforms.tDiffuse={value:D.texture},t.uniforms.textureMatrix={value:O},this.material.uniforms=t.uniforms,this.material.userData.shader=t},this.receiveShadow=!0,this.onBeforeRender=function(t,e,n){if(d.setFromMatrixPosition(i.matrixWorld),T.setFromMatrixPosition(n.matrixWorld),E.extractRotation(i.matrixWorld),h.set(0,0,1),h.applyMatrix4(E),C.subVectors(d,T),C.dot(h)>0)return;C.reflect(h).negate(),C.add(d),E.extractRotation(n.matrixWorld),x.set(0,0,-1),x.applyMatrix4(E),x.add(T),S.subVectors(d,x),S.reflect(h).negate(),S.add(d),M.position.copy(C),M.up.set(0,1,0),M.up.applyMatrix4(E),M.up.reflect(h),M.lookAt(S),M.far=n.far,M.updateMatrixWorld(),M.projectionMatrix.copy(n.projectionMatrix),O.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),O.multiply(M.projectionMatrix),O.multiply(M.matrixWorldInverse),O.multiply(i.matrixWorld),u.setFromNormalAndCoplanarPoint(h,d),u.applyMatrix4(M.matrixWorldInverse),A.set(u.normal.x,u.normal.y,u.normal.z,u.constant);const r=M.projectionMatrix;k.x=(Math.sign(A.x)+r.elements[8])/r.elements[0],k.y=(Math.sign(A.y)+r.elements[9])/r.elements[5],k.z=-1,k.w=(1+r.elements[10])/r.elements[14],A.multiplyScalar(2/A.dot(k)),r.elements[2]=A.x,r.elements[6]=A.y,r.elements[10]=A.z+1-o,r.elements[14]=A.w,i.visible=!1;const s=t.getRenderTarget(),a=t.xr.enabled,l=t.shadowMap.autoUpdate,c=t.outputEncoding,p=t.toneMapping;t.xr.enabled=!1,t.shadowMap.autoUpdate=!1,t.outputEncoding=w,t.toneMapping=b,t.setRenderTarget(D),t.state.buffers.depth.setMask(!0),!1===t.autoClear&&t.clear(),t.render(e,M),t.xr.enabled=a,t.shadowMap.autoUpdate=l,t.outputEncoding=c,t.toneMapping=p,t.setRenderTarget(s);const m=n.viewport;void 0!==m&&t.state.viewport(m),i.visible=!0},this.getRenderTarget=function(){return D},this.dispose=function(){D.dispose(),i.material.dispose()}}}async function Ta(){this.scene.remove(this.scene.getObjectByName("MuJoCo Root")),[this.model,this.state,this.simulation,this.bodies,this.lights]=await xa(this.mujoco,this.params.scene,this),this.prevActivated.fill(!1),"paws_with_piano/scene.xml"===this.params.scene?(this.camera.frustum.near=.01,this.camera.frustum.far=100,this.functions.setCamera("paws_and_piano_cam")):this.params.scene.includes("piano")?(this.camera.position.set(-.41,.77,-.75),this.controls.target.set(.08,-.01,-.05)):this.params.scene.includes("go2")&&(this.camera.position.set(1.5,1.5,1),this.controls.target.set(0,0,.3)),this.controls.update(),this.simulation.forward();for(let t=0;t<this.updateGUICallbacks.length;t++)this.updateGUICallbacks[t](this.model,this.simulation,this.params)}function Ea(t){t.params.scene=t.params.scene||"piano_with_shadow_hands/scene.xml",t.gui.add(t.params,"scene",{"Piano with Hands":"piano_with_shadow_hands/scene.xml","Unitree Go2 Robot":"unitree_go2/scene.xml","Paws with Piano":"paws_with_piano/scene.xml"}).name("Scene").onChange((e=>{Ta.call(t)})),t.gui.add(t.params,"song",{"Turkish March":"turkish_march_actions.npy","Fur Elise":"fur_elise_actions.npy","Piano Sonata No. 16 K545":"k545_actions.npy","Nocturne Op. 9 No. 2":"nocturne_actions.npy","Twinkle Twinkle":"twinkle_twinkle_actions.npy"}).name("Song").onChange((e=>{t.npyjs.load("./examples/scenes/piano_with_shadow_hands/"+e,(e=>{t.pianoControl=e,t.controlFrameNumber=0,t.simulation.resetData(),t.simulation.forward(),t.prevActivated.fill(!1),t.params.songPaused=!1,t.sampler.releaseAll()}))})),document.addEventListener("visibilitychange",(()=>{"visible"!=document.visibilityState&&t.sampler.releaseAll()}));let e="",n="";document.addEventListener("keydown",(i=>{"F1"===i.key&&(t.params.help=!t.params.help,(()=>{if(t.params.help){const t=document.createElement("div");t.style.position="absolute",t.style.top="10px",t.style.left="10px",t.style.color="white",t.style.font="normal 18px Arial",t.style.backgroundColor="rgba(0, 0, 0, 0.5)",t.style.padding="10px",t.style.borderRadius="10px",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="center",t.style.justifyContent="center",t.style.width="400px",t.style.height="400px",t.style.overflow="auto",t.style.zIndex="1000";const i=document.createElement("div");i.style.font="bold 24px Arial",i.innerHTML="",t.appendChild(i);const r=document.createElement("table");r.style.width="100%",r.style.marginTop="10px",t.appendChild(r);const s=document.createElement("tbody");r.appendChild(s);const o=document.createElement("tr");s.appendChild(o);const a=document.createElement("td");a.style.width="50%",a.style.textAlign="right",a.style.paddingRight="10px",o.appendChild(a);const l=document.createElement("td");l.style.width="50%",l.style.textAlign="left",l.style.paddingLeft="10px",o.appendChild(l);const c=document.createElement("div");c.innerHTML=n,a.appendChild(c);const u=document.createElement("div");u.innerHTML=e,l.appendChild(u);const h=document.createElement("button");h.innerHTML="Close",h.style.position="absolute",h.style.top="10px",h.style.right="10px",h.style.zIndex="1001",h.onclick=()=>{t.remove()},t.appendChild(h),document.body.appendChild(t)}else document.body.removeChild(document.body.lastChild)})(),i.preventDefault())})),e+="F1<br>",n+="Help<br>";let i=t.gui.addFolder("Simulation");const r=i.add(t.params,"paused").name("Pause Simulation");r.onChange((e=>{if(e){const e=document.createElement("div");e.style.position="absolute",e.style.top="10px",e.style.left="10px",e.style.color="white",e.style.font="normal 18px Arial",e.innerHTML="pause",t.container.appendChild(e)}else t.container.removeChild(t.container.lastChild)})),document.addEventListener("keydown",(e=>{"Space"===e.code&&(t.params.paused=!t.params.paused,r.setValue(t.params.paused),e.preventDefault())})),n+="Play / Pause<br>",e+="Space<br>";const s=i.add(t.params,"songPaused").name("Pause Song").listen();document.addEventListener("keydown",(e=>{"KeyP"===e.code&&(t.params.songPaused=!t.params.songPaused,s.setValue(t.params.songPaused),e.preventDefault())})),n+="Play / Pause Song<br>",e+="P<br>";const o=()=>{t.controlFrameNumber=0,t.simulation.resetData(),t.simulation.forward();for(let e=0;e<t.model.nbody();e++)if(t.bodies[e]){if(t.bodies[e].name.indexOf("piano/")<0)continue;if(t.bodies[e].name.indexOf("key")<0)continue;t.bodies[e].name.indexOf("white")>=0?t.bodies[e].children[0].material.color.setRGB(.9,.9,.9):t.bodies[e].children[0].material.color.setRGB(.1,.1,.1)}};i.add({reset:()=>{o()}},"reset").name("Reset"),document.addEventListener("keydown",(t=>{"Backspace"===t.code&&(o(),t.preventDefault())})),n+="Reset simulation<br>",e+="Backspace<br>",i.add(t.params,"ctrlnoiserate",0,2,.01).name("Noise rate"),i.add(t.params,"ctrlnoisestd",0,2,.01).name("Noise scale"),i.close();let a=i.addFolder("Actuators");const l=(e,n,i)=>{let r=e.actuator_ctrlrange(),s=[];for(let o=0;o<e.nu();o++){if(!e.actuator_ctrllimited()[o])continue;let i="Actuator "+o;t.params[i]=0;let l=a.add(t.params,i,r[2*o],r[2*o+1],.01).name(i).listen();s.push(l),l.onChange((t=>{n.ctrl()[o]=t}))}return s};let c=l(t.model,t.simulation,t.params);t.updateGUICallbacks.push(((e,n,i)=>{for(let t=0;t<c.length;t++)c[t].destroy();c=l(e,n,t.params)})),a.close(),document.addEventListener("keydown",(e=>{e.ctrlKey&&"KeyA"===e.code&&(t.camera.position.set(-.41,.77,-.75),t.controls.target.set(.08,-.01,-.05),t.controls.update(),e.preventDefault())})),n+="Reset free camera<br>",e+="Ctrl A<br>",t.gui.open()}async function xa(t,e,n){try{if(n.model=t.Model.load_from_xml("/working/"+e),!n.model)throw new Error("mujoco.Model.load_from_xml returned null or undefined.")}catch(g){throw g}n.state=new t.State(n.model),n.simulation=new t.Simulation(n.model,n.state);let i=n.model,r=n.state,s=n.simulation,a=new TextDecoder("utf-8"),l=a.decode(i.names()).split(a.decode(new ArrayBuffer(1))),c=new T;c.name="MuJoCo Root",n.scene.add(c),n.camera.position.set(-.41,.77,-.75),n.controls.target.set(.08,-.01,-.05),n.controls.update();let u={},h={},p=[],f=new y;f.color=new m(1,1,1);for(let _=0;_<i.ngeom();_++){if(!(i.geom_group()[_]<3))continue;let e=i.geom_bodyid()[_],n=i.geom_type()[_],r=[i.geom_size()[3*_+0],i.geom_size()[3*_+1],i.geom_size()[3*_+2]];e in u||(u[e]=new T,u[e].name=l[e+1],u[e].bodyID=e,u[e].has_custom_mesh=!1);let s,a=new E(.5*r[0]);if(n==t.mjtGeom.mjGEOM_PLANE.value);else if(n==t.mjtGeom.mjGEOM_HFIELD.value);else if(n==t.mjtGeom.mjGEOM_SPHERE.value)a=new E(r[0]);else if(n==t.mjtGeom.mjGEOM_CAPSULE.value)a=new x(r[0],2*r[1],20,20);else if(n==t.mjtGeom.mjGEOM_ELLIPSOID.value)a=new E(1);else if(n==t.mjtGeom.mjGEOM_CYLINDER.value)a=new A(r[0],r[0],2*r[1]);else if(n==t.mjtGeom.mjGEOM_BOX.value)a=new C(2*r[0],2*r[2],2*r[1]);else if(n==t.mjtGeom.mjGEOM_MESH.value){let t=i.geom_dataid()[_];if(t in h)a=h[t];else{a=new S;let e=i.mesh_vert().subarray(3*i.mesh_vertadr()[t],3*(i.mesh_vertadr()[t]+i.mesh_vertnum()[t]));for(let t=0;t<e.length;t+=3){let n=e[t+1];e[t+1]=e[t+2],e[t+2]=-n}let n=i.mesh_normal().subarray(3*i.mesh_vertadr()[t],3*(i.mesh_vertadr()[t]+i.mesh_vertnum()[t]));for(let t=0;t<n.length;t+=3){let e=n[t+1];n[t+1]=n[t+2],n[t+2]=-e}let r=i.mesh_texcoord().subarray(2*i.mesh_texcoordadr()[t],2*(i.mesh_texcoordadr()[t]+i.mesh_vertnum()[t])),s=i.mesh_face().subarray(3*i.mesh_faceadr()[t],3*(i.mesh_faceadr()[t]+i.mesh_facenum()[t]));a.setAttribute("position",new k(e,3)),a.setAttribute("normal",new k(n,3)),a.setAttribute("uv",new k(r,2)),a.setIndex(Array.from(s)),h[t]=a}u[e].has_custom_mesh=!0}let c=[i.geom_rgba()[4*_+0],i.geom_rgba()[4*_+1],i.geom_rgba()[4*_+2],i.geom_rgba()[4*_+3]];if(-1!=i.geom_matid()[_]){let t=i.geom_matid()[_];c=[i.mat_rgba()[4*t+0],i.mat_rgba()[4*t+1],i.mat_rgba()[4*t+2],i.mat_rgba()[4*t+3]],s=void 0;let e=i.mat_texid()[t];if(-1!=e){let t=i.tex_width()[e],n=i.tex_height()[e],r=i.tex_adr()[e],a=i.tex_rgb(),l=new Uint8Array(t*n*4);for(let e=0;e<t*n;e++)l[4*e+0]=a[r+(3*e+0)],l[4*e+1]=a[r+(3*e+1)],l[4*e+2]=a[r+(3*e+2)],l[4*e+3]=1;s=new O(l,t,n,M,D),2==e?(s.repeat=new o(50,50),s.wrapS=P,s.wrapT=P):(s.repeat=new o(1,1),s.wrapS=P,s.wrapT=P),s.needsUpdate=!0}}f=new y({color:new m(c[0],c[1],c[2]),transparent:c[3]<1,opacity:c[3],specularIntensity:-1!=i.geom_matid()[_]?.5*i.mat_specular()[i.geom_matid()[_]]:void 0,reflectivity:-1!=i.geom_matid()[_]?i.mat_reflectance()[i.geom_matid()[_]]:void 0,roughness:-1!=i.geom_matid()[_]?1-i.mat_shininess()[i.geom_matid()[_]]:void 0,metalness:-1!=i.geom_matid()[_]?.1:void 0,map:s});let p=new d;0==n?(p=new ba(new I(100,100),{clipBias:.003,texture:s}),p.rotateX(-Math.PI/2)):p=new d(a,f),p.castShadow=0!=_,p.receiveShadow=7!=n,p.bodyID=e,u[e].add(p),Aa(i.geom_pos(),_,p.position),0!=n&&Ca(i.geom_quat(),_,p.quaternion),4==n&&p.scale.set(r[0],r[2],r[1])}for(let o=0;o<i.nlight();o++){let t=new F;t=i.light_directional()[o]?new R:new F,t.decay=100*i.light_attenuation()[o],t.penumbra=.5,t.castShadow=!0,t.shadow.mapSize.width=1024,t.shadow.mapSize.height=1024,t.shadow.camera.near=1,t.shadow.camera.far=10,u[0]?u[0].add(t):c.add(t),p.push(t)}for(let o=0;o<i.nbody();o++)0!=o&&u[0]?(u[o]||(u[o]=new T,u[o].name=l[o+1],u[o].bodyID=o,u[o].has_custom_mesh=!1),u[0].add(u[o])):c.add(u[o]);return[i,r,s,u,p]}function Aa(t,e,n,i=!0){return i?n.set(t[3*e+0],t[3*e+2],-t[3*e+1]):n.set(t[3*e+0],t[3*e+1],t[3*e+2])}function Ca(t,e,n,i=!0){return i?n.set(-t[4*e+1],-t[4*e+3],t[4*e+2],-t[4*e+0]):n.set(t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3])}function Sa(t){return t.set(t.x,-t.z,t.y)}const ka={},Oa=function(t,e,n){let i=Promise.resolve();if(e&&e.length>0){const t=document.getElementsByTagName("link");i=Promise.all(e.map((e=>{if(e=function(t,e){return new URL(t,e).href}(e,n),e in ka)return;ka[e]=!0;const i=e.endsWith(".css"),r=i?'[rel="stylesheet"]':"";if(!!n)for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.href===e&&(!i||"stylesheet"===r.rel))return}else if(document.querySelector(`link[href="${e}"]${r}`))return;const s=document.createElement("link");return s.rel=i?"stylesheet":"modulepreload",i||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),i?new Promise(((t,n)=>{s.addEventListener("load",t),s.addEventListener("error",(()=>n(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}return i.then((()=>t())).catch((t=>{const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=t,window.dispatchEvent(e),!e.defaultPrevented)throw t}))};var Ma,Da=(Ma=import.meta.url,async function(t={}){var e,n,i=void 0!==t?t:{};i.ready=new Promise((function(t,i){e=t,n=i})),["_main","_fflush","___getTypeName","__embind_initialize_bindings","onRuntimeInitialized"].forEach((t=>{Object.getOwnPropertyDescriptor(i.ready,t)||Object.defineProperty(i.ready,t,{get:()=>rt("You are getting "+t+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js"),set:()=>rt("You are setting "+t+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")})}));var r=Object.assign({},i),s=[],o="./this.program",a=(t,e)=>{throw e},l="object"==typeof window,c="function"==typeof importScripts,u="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,h=!l&&!u&&!c;if(i.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");var d,p,m,f="";if(u){if("undefined"==typeof process||!process.release||"node"!==process.release.name)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");var g=process.versions.node,_=g.split(".").slice(0,3);if((_=1e4*_[0]+100*_[1]+1*_[2])<101900)throw new Error("This emscripten-generated code requires node v10.19.19.0 (detected v"+g+")");const{createRequire:t}=await Oa((()=>import("./__vite-browser-external-FmFgRqLi.js")),__vite__mapDeps([]),import.meta.url);var v=t(import.meta.url),y=v("fs"),w=v("path");f=c?w.dirname(f)+"/":v("url").fileURLToPath(new URL("./",import.meta.url)),d=(t,e)=>(t=pt(t)?new URL(t):w.normalize(t),y.readFileSync(t,e?void 0:"utf8")),m=t=>{var e=d(t,!0);return e.buffer||(e=new Uint8Array(e)),k(e.buffer),e},p=(t,e,n)=>{t=pt(t)?new URL(t):w.normalize(t),y.readFile(t,(function(t,i){t?n(t):e(i.buffer)}))},process.argv.length>1&&(o=process.argv[1].replace(/\\/g,"/")),s=process.argv.slice(2),a=(t,e)=>{throw process.exitCode=t,e},i.inspect=function(){return"[Emscripten Module object]"}}else if(h){if("object"==typeof process&&"function"==typeof v||"object"==typeof window||"function"==typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");"undefined"!=typeof read&&(d=function(t){return read(t)}),m=function(t){let e;return"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(e=read(t,"binary"),k("object"==typeof e),e)},p=function(t,e,n){setTimeout((()=>e(m(t))),0)},"undefined"==typeof clearTimeout&&(globalThis.clearTimeout=t=>{}),"undefined"!=typeof scriptArgs?s=scriptArgs:void 0!==arguments&&(s=arguments),"function"==typeof quit&&(a=(t,e)=>{throw setTimeout((()=>{if(!(e instanceof wt)){let t=e;e&&"object"==typeof e&&e.stack&&(t=[e,e.stack]),A("exiting due to exception: "+t)}quit(t)})),e}),"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)}else{if(!l&&!c)throw new Error("environment detection error");if(c?f=self.location.href:"undefined"!=typeof document&&document.currentScript&&(f=document.currentScript.src),Ma&&(f=Ma),f=0!==f.indexOf("blob:")?f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):"","object"!=typeof window&&"function"!=typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");d=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},c&&(m=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),p=(t,e,n)=>{var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=()=>{200==i.status||0==i.status&&i.response?e(i.response):n()},i.onerror=n,i.send(null)}}var b,T,E,x=i.print||void 0,A=i.printErr||void 0;Object.assign(i,r),r=null,b="fetchSettings",Object.getOwnPropertyDescriptor(i,b)&&rt("`Module."+b+"` was supplied but `"+b+"` not included in INCOMING_MODULE_JS_API"),i.arguments&&(s=i.arguments),_t("arguments","arguments_"),i.thisProgram&&(o=i.thisProgram),_t("thisProgram","thisProgram"),i.quit&&(a=i.quit),_t("quit","quit_"),k(void 0===i.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),k(void 0===i.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),k(void 0===i.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),k(void 0===i.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),k(void 0===i.read,"Module.read option was removed (modify read_ in JS)"),k(void 0===i.readAsync,"Module.readAsync option was removed (modify readAsync in JS)"),k(void 0===i.readBinary,"Module.readBinary option was removed (modify readBinary in JS)"),k(void 0===i.setWindowTitle,"Module.setWindowTitle option was removed (modify setWindowTitle in JS)"),k(void 0===i.TOTAL_MEMORY,"Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),_t("read","read_"),_t("readAsync","readAsync"),_t("readBinary","readBinary"),_t("setWindowTitle","setWindowTitle"),k(!h,"shell environment detected but not enabled at build time.  Add 'shell' to `-sENVIRONMENT` to enable."),i.wasmBinary&&(T=i.wasmBinary),_t("wasmBinary","wasmBinary"),i.noExitRuntime,_t("noExitRuntime","noExitRuntime"),"object"!=typeof WebAssembly&&rt("no native wasm support detected");var C,S=!1;function k(t,e){t||rt("Assertion failed"+(e?": "+e:""))}var O,M,D,P,I,F,R,N,L,j="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function V(t,e,n){for(var i=e+n,r=e;t[r]&&!(r>=i);)++r;if(r-e>16&&t.buffer&&j)return j.decode(t.subarray(e,r));for(var s="";e<r;){var o=t[e++];if(128&o){var a=63&t[e++];if(192!=(224&o)){var l=63&t[e++];if(224==(240&o)?o=(15&o)<<12|a<<6|l:(240!=(248&o)&&Et("Invalid UTF-8 leading byte "+Tt(o)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),o=(7&o)<<18|a<<12|l<<6|63&t[e++]),o<65536)s+=String.fromCharCode(o);else{var c=o-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&o)<<6|a)}else s+=String.fromCharCode(o)}return s}function B(t,e){return k("number"==typeof t),t?V(M,t,e):""}function $(t,e,n,i){if(!(i>0))return 0;for(var r=n,s=n+i-1,o=0;o<t.length;++o){var a=t.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++o)),a<=127){if(n>=s)break;e[n++]=a}else if(a<=2047){if(n+1>=s)break;e[n++]=192|a>>6,e[n++]=128|63&a}else if(a<=65535){if(n+2>=s)break;e[n++]=224|a>>12,e[n++]=128|a>>6&63,e[n++]=128|63&a}else{if(n+3>=s)break;a>1114111&&Et("Invalid Unicode code point "+Tt(a)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),e[n++]=240|a>>18,e[n++]=128|a>>12&63,e[n++]=128|a>>6&63,e[n++]=128|63&a}}return e[n]=0,n-r}function W(t){for(var e=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i<=127?e++:i<=2047?e+=2:i>=55296&&i<=57343?(e+=4,++n):e+=3}return e}function z(){var t=E.buffer;i.HEAP8=O=new Int8Array(t),i.HEAP16=D=new Int16Array(t),i.HEAP32=I=new Int32Array(t),i.HEAPU8=M=new Uint8Array(t),i.HEAPU16=P=new Uint16Array(t),i.HEAPU32=F=new Uint32Array(t),i.HEAPF32=R=new Float32Array(t),i.HEAPF64=N=new Float64Array(t)}function U(){if(!S){var t=Nn();0==t&&(t+=4);var e=F[t>>2],n=F[t+4>>2];34821223==e&&2310721022==n||rt("Stack overflow! Stack cookie has been overwritten at "+Tt(t)+", expected hex dwords 0x89BACDFE and 0x2135467, but received "+Tt(n)+" "+Tt(e)),1668509029!==F[0]&&rt("Runtime error: The application has corrupted its heap memory area (address zero)!")}}k(!i.STACK_SIZE,"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time"),k("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&null!=Int32Array.prototype.subarray&&null!=Int32Array.prototype.set,"JS engine does not provide full typed array support"),k(!i.wasmMemory,"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),k(!i.INITIAL_MEMORY,"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically"),function(){var t=new Int16Array(1),e=new Int8Array(t.buffer);if(t[0]=25459,115!==e[0]||99!==e[1])throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"}();var q=[],H=[],G=[],Y=[],X=!1,Z=0;k(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),k(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),k(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),k(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var K=0,J=null,Q=null,tt={};function et(t){for(var e=t;;){if(!tt[t])return t;t=e+Math.random()}}function nt(t){K++,i.monitorRunDependencies&&i.monitorRunDependencies(K),t?(k(!tt[t]),tt[t]=1,null===J&&"undefined"!=typeof setInterval&&(J=setInterval((function(){if(S)return clearInterval(J),void(J=null);var t=!1;for(var e in tt)t||(t=!0,A("still waiting on run dependencies:")),A("dependency: "+e);t&&A("(end of list)")}),1e4))):A("warning: run dependency added without ID")}function it(t){if(K--,i.monitorRunDependencies&&i.monitorRunDependencies(K),t?(k(tt[t]),delete tt[t]):A("warning: run dependency removed without ID"),0==K&&(null!==J&&(clearInterval(J),J=null),Q)){var e=Q;Q=null,e()}}function rt(t){i.onAbort&&i.onAbort(t),A(t="Aborted("+t+")"),S=!0,C=1;var e=new WebAssembly.RuntimeError(t);throw n(e),e}var st,ot,at,lt,ct,ut,ht="data:application/octet-stream;base64,";function dt(t){return t.startsWith(ht)}function pt(t){return t.startsWith("file://")}function mt(t,e){return function(){var n=t,r=e;return r=i.asm,k(X,"native function `"+n+"` called before runtime initialization"),r[t]||k(r[t],"exported native function `"+n+"` not found"),r[t].apply(null,arguments)}}function ft(t){try{if(t==st&&T)return new Uint8Array(T);if(m)return m(t);throw"both async and sync fetching of the wasm failed"}catch(A){rt(A)}}function gt(t,e,n){return function(t){if(!T&&(l||c)){if("function"==typeof fetch&&!pt(t))return fetch(t,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+t+"'";return e.arrayBuffer()})).catch((function(){return ft(t)}));if(p)return new Promise((function(e,n){p(t,(function(t){e(new Uint8Array(t))}),n)}))}return Promise.resolve().then((function(){return ft(t)}))}(t).then((function(t){return WebAssembly.instantiate(t,e)})).then((function(t){return t})).then(n,(function(t){A("failed to asynchronously prepare wasm: "+t),pt(st)&&A("warning: Loading from a file URI ("+st+") is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing"),rt(t)}))}function _t(t,e){Object.getOwnPropertyDescriptor(i,t)||Object.defineProperty(i,t,{configurable:!0,get:function(){rt("Module."+t+" has been replaced with plain "+e+" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}})}function vt(t){return"FS_createPath"===t||"FS_createDataFile"===t||"FS_createPreloadedFile"===t||"FS_unlink"===t||"addRunDependency"===t||"FS_createLazyFile"===t||"FS_createDevice"===t||"removeRunDependency"===t}function yt(t){Object.getOwnPropertyDescriptor(i,t)||Object.defineProperty(i,t,{configurable:!0,get:function(){var e="'"+t+"' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)";vt(t)&&(e+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),rt(e)}})}function wt(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function bt(t){for(;t.length>0;)t.shift()(i)}function Tt(t){return k("number"==typeof t),"0x"+t.toString(16).padStart(8,"0")}function Et(t){Et.shown||(Et.shown={}),Et.shown[t]||(Et.shown[t]=1,u&&(t="warning: "+t),A(t))}function xt(t){this.excPtr=t,this.ptr=t-24,this.set_type=function(t){F[this.ptr+4>>2]=t},this.get_type=function(){return F[this.ptr+4>>2]},this.set_destructor=function(t){F[this.ptr+8>>2]=t},this.get_destructor=function(){return F[this.ptr+8>>2]},this.set_refcount=function(t){I[this.ptr>>2]=t},this.set_caught=function(t){t=t?1:0,O[this.ptr+12>>0]=t},this.get_caught=function(){return 0!=O[this.ptr+12>>0]},this.set_rethrown=function(t){t=t?1:0,O[this.ptr+13>>0]=t},this.get_rethrown=function(){return 0!=O[this.ptr+13>>0]},this.init=function(t,e){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(e),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var t=I[this.ptr>>2];I[this.ptr>>2]=t+1},this.release_ref=function(){var t=I[this.ptr>>2];return I[this.ptr>>2]=t-1,k(t>0),1===t},this.set_adjusted_ptr=function(t){F[this.ptr+16>>2]=t},this.get_adjusted_ptr=function(){return F[this.ptr+16>>2]},this.get_exception_ptr=function(){if($n(this.get_type()))return F[this.excPtr>>2];var t=this.get_adjusted_ptr();return 0!==t?t:this.excPtr}}i.locateFile?dt(st="mujoco_wasm.wasm")||(ot=st,st=i.locateFile?i.locateFile(ot,f):f+ot):st=new URL(""+new URL("../assets/mujoco_wasm-DMfm32Ve.wasm",import.meta.url).href,import.meta.url).href,ct="buffer",ut="Please use HEAP8.buffer or wasmMemory.buffer","undefined"!=typeof globalThis&&Object.defineProperty(globalThis,ct,{configurable:!0,get:function(){Et("`"+ct+"` is not longer defined by emscripten. "+ut)}});var At={isAbs:t=>"/"===t.charAt(0),splitPath:t=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1),normalizeArray:(t,e)=>{for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];"."===r?t.splice(i,1):".."===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n;n--)t.unshift("..");return t},normalize:t=>{var e=At.isAbs(t),n="/"===t.substr(-1);return t=At.normalizeArray(t.split("/").filter((t=>!!t)),!e).join("/"),t||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t},dirname:t=>{var e=At.splitPath(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},basename:t=>{if("/"===t)return"/";var e=(t=(t=At.normalize(t)).replace(/\/$/,"")).lastIndexOf("/");return-1===e?t:t.substr(e+1)},join:function(){var t=Array.prototype.slice.call(arguments);return At.normalize(t.join("/"))},join2:(t,e)=>At.normalize(t+"/"+e)},Ct={resolve:function(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var i=n>=0?arguments[n]:Ft.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");if(!i)return"";t=i+"/"+t,e=At.isAbs(i)}return t=At.normalizeArray(t.split("/").filter((t=>!!t)),!e).join("/"),(e?"/":"")+t||"."},relative:(t,e)=>{function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=Ct.resolve(t).substr(1),e=Ct.resolve(e).substr(1);for(var i=n(t.split("/")),r=n(e.split("/")),s=Math.min(i.length,r.length),o=s,a=0;a<s;a++)if(i[a]!==r[a]){o=a;break}var l=[];for(a=o;a<i.length;a++)l.push("..");return(l=l.concat(r.slice(o))).join("/")}};function St(t,e,n){var i=W(t)+1,r=new Array(i),s=$(t,r,0,r.length);return e&&(r.length=s),r}var kt={ttys:[],init:function(){},shutdown:function(){},register:function(t,e){kt.ttys[t]={input:[],output:[],ops:e},Ft.registerDevice(t,kt.stream_ops)},stream_ops:{open:function(t){var e=kt.ttys[t.node.rdev];if(!e)throw new Ft.ErrnoError(43);t.tty=e,t.seekable=!1},close:function(t){t.tty.ops.fsync(t.tty)},fsync:function(t){t.tty.ops.fsync(t.tty)},read:function(t,e,n,i,r){if(!t.tty||!t.tty.ops.get_char)throw new Ft.ErrnoError(60);for(var s=0,o=0;o<i;o++){var a;try{a=t.tty.ops.get_char(t.tty)}catch(Jo){throw new Ft.ErrnoError(29)}if(void 0===a&&0===s)throw new Ft.ErrnoError(6);if(null==a)break;s++,e[n+o]=a}return s&&(t.node.timestamp=Date.now()),s},write:function(t,e,n,i,r){if(!t.tty||!t.tty.ops.put_char)throw new Ft.ErrnoError(60);try{for(var s=0;s<i;s++)t.tty.ops.put_char(t.tty,e[n+s])}catch(Jo){throw new Ft.ErrnoError(29)}return i&&(t.node.timestamp=Date.now()),s}},default_tty_ops:{get_char:function(t){if(!t.input.length){var e=null;if(u){var n=Buffer.alloc(256),i=0;try{i=y.readSync(process.stdin.fd,n,0,256,-1)}catch(Jo){if(!Jo.toString().includes("EOF"))throw Jo;i=0}e=i>0?n.slice(0,i).toString("utf-8"):null}else"undefined"!=typeof window&&"function"==typeof window.prompt?null!==(e=window.prompt("Input: "))&&(e+="\n"):"function"==typeof readline&&null!==(e=readline())&&(e+="\n");if(!e)return null;t.input=St(e,!0)}return t.input.shift()},put_char:function(t,e){null===e||10===e?(x(V(t.output,0)),t.output=[]):0!=e&&t.output.push(e)},fsync:function(t){t.output&&t.output.length>0&&(x(V(t.output,0)),t.output=[])}},default_tty1_ops:{put_char:function(t,e){null===e||10===e?(A(V(t.output,0)),t.output=[]):0!=e&&t.output.push(e)},fsync:function(t){t.output&&t.output.length>0&&(A(V(t.output,0)),t.output=[])}}};function Ot(t){rt("internal error: mmapAlloc called but `emscripten_builtin_memalign` native symbol not exported")}var Mt={ops_table:null,mount:function(t){return Mt.createNode(null,"/",16895,0)},createNode:function(t,e,n,i){if(Ft.isBlkdev(n)||Ft.isFIFO(n))throw new Ft.ErrnoError(63);Mt.ops_table||(Mt.ops_table={dir:{node:{getattr:Mt.node_ops.getattr,setattr:Mt.node_ops.setattr,lookup:Mt.node_ops.lookup,mknod:Mt.node_ops.mknod,rename:Mt.node_ops.rename,unlink:Mt.node_ops.unlink,rmdir:Mt.node_ops.rmdir,readdir:Mt.node_ops.readdir,symlink:Mt.node_ops.symlink},stream:{llseek:Mt.stream_ops.llseek}},file:{node:{getattr:Mt.node_ops.getattr,setattr:Mt.node_ops.setattr},stream:{llseek:Mt.stream_ops.llseek,read:Mt.stream_ops.read,write:Mt.stream_ops.write,allocate:Mt.stream_ops.allocate,mmap:Mt.stream_ops.mmap,msync:Mt.stream_ops.msync}},link:{node:{getattr:Mt.node_ops.getattr,setattr:Mt.node_ops.setattr,readlink:Mt.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Mt.node_ops.getattr,setattr:Mt.node_ops.setattr},stream:Ft.chrdev_stream_ops}});var r=Ft.createNode(t,e,n,i);return Ft.isDir(r.mode)?(r.node_ops=Mt.ops_table.dir.node,r.stream_ops=Mt.ops_table.dir.stream,r.contents={}):Ft.isFile(r.mode)?(r.node_ops=Mt.ops_table.file.node,r.stream_ops=Mt.ops_table.file.stream,r.usedBytes=0,r.contents=null):Ft.isLink(r.mode)?(r.node_ops=Mt.ops_table.link.node,r.stream_ops=Mt.ops_table.link.stream):Ft.isChrdev(r.mode)&&(r.node_ops=Mt.ops_table.chrdev.node,r.stream_ops=Mt.ops_table.chrdev.stream),r.timestamp=Date.now(),t&&(t.contents[e]=r,t.timestamp=r.timestamp),r},getFileDataAsTypedArray:function(t){return t.contents?t.contents.subarray?t.contents.subarray(0,t.usedBytes):new Uint8Array(t.contents):new Uint8Array(0)},expandFileStorage:function(t,e){var n=t.contents?t.contents.length:0;if(!(n>=e)){e=Math.max(e,n*(n<1048576?2:1.125)>>>0),0!=n&&(e=Math.max(e,256));var i=t.contents;t.contents=new Uint8Array(e),t.usedBytes>0&&t.contents.set(i.subarray(0,t.usedBytes),0)}},resizeFileStorage:function(t,e){if(t.usedBytes!=e)if(0==e)t.contents=null,t.usedBytes=0;else{var n=t.contents;t.contents=new Uint8Array(e),n&&t.contents.set(n.subarray(0,Math.min(e,t.usedBytes))),t.usedBytes=e}},node_ops:{getattr:function(t){var e={};return e.dev=Ft.isChrdev(t.mode)?t.id:1,e.ino=t.id,e.mode=t.mode,e.nlink=1,e.uid=0,e.gid=0,e.rdev=t.rdev,Ft.isDir(t.mode)?e.size=4096:Ft.isFile(t.mode)?e.size=t.usedBytes:Ft.isLink(t.mode)?e.size=t.link.length:e.size=0,e.atime=new Date(t.timestamp),e.mtime=new Date(t.timestamp),e.ctime=new Date(t.timestamp),e.blksize=4096,e.blocks=Math.ceil(e.size/e.blksize),e},setattr:function(t,e){void 0!==e.mode&&(t.mode=e.mode),void 0!==e.timestamp&&(t.timestamp=e.timestamp),void 0!==e.size&&Mt.resizeFileStorage(t,e.size)},lookup:function(t,e){throw Ft.genericErrors[44]},mknod:function(t,e,n,i){return Mt.createNode(t,e,n,i)},rename:function(t,e,n){if(Ft.isDir(t.mode)){var i;try{i=Ft.lookupNode(e,n)}catch(Jo){}if(i)for(var r in i.contents)throw new Ft.ErrnoError(55)}delete t.parent.contents[t.name],t.parent.timestamp=Date.now(),t.name=n,e.contents[n]=t,e.timestamp=t.parent.timestamp,t.parent=e},unlink:function(t,e){delete t.contents[e],t.timestamp=Date.now()},rmdir:function(t,e){var n=Ft.lookupNode(t,e);for(var i in n.contents)throw new Ft.ErrnoError(55);delete t.contents[e],t.timestamp=Date.now()},readdir:function(t){var e=[".",".."];for(var n in t.contents)t.contents.hasOwnProperty(n)&&e.push(n);return e},symlink:function(t,e,n){var i=Mt.createNode(t,e,41471,0);return i.link=n,i},readlink:function(t){if(!Ft.isLink(t.mode))throw new Ft.ErrnoError(28);return t.link}},stream_ops:{read:function(t,e,n,i,r){var s=t.node.contents;if(r>=t.node.usedBytes)return 0;var o=Math.min(t.node.usedBytes-r,i);if(k(o>=0),o>8&&s.subarray)e.set(s.subarray(r,r+o),n);else for(var a=0;a<o;a++)e[n+a]=s[r+a];return o},write:function(t,e,n,i,r,s){if(k(!(e instanceof ArrayBuffer)),e.buffer===O.buffer&&(s=!1),!i)return 0;var o=t.node;if(o.timestamp=Date.now(),e.subarray&&(!o.contents||o.contents.subarray)){if(s)return k(0===r,"canOwn must imply no weird position inside the file"),o.contents=e.subarray(n,n+i),o.usedBytes=i,i;if(0===o.usedBytes&&0===r)return o.contents=e.slice(n,n+i),o.usedBytes=i,i;if(r+i<=o.usedBytes)return o.contents.set(e.subarray(n,n+i),r),i}if(Mt.expandFileStorage(o,r+i),o.contents.subarray&&e.subarray)o.contents.set(e.subarray(n,n+i),r);else for(var a=0;a<i;a++)o.contents[r+a]=e[n+a];return o.usedBytes=Math.max(o.usedBytes,r+i),i},llseek:function(t,e,n){var i=e;if(1===n?i+=t.position:2===n&&Ft.isFile(t.node.mode)&&(i+=t.node.usedBytes),i<0)throw new Ft.ErrnoError(28);return i},allocate:function(t,e,n){Mt.expandFileStorage(t.node,e+n),t.node.usedBytes=Math.max(t.node.usedBytes,e+n)},mmap:function(t,e,n,i,r){if(!Ft.isFile(t.node.mode))throw new Ft.ErrnoError(43);var s,o,a=t.node.contents;if(2&r||a.buffer!==O.buffer){if((n>0||n+e<a.length)&&(a=a.subarray?a.subarray(n,n+e):Array.prototype.slice.call(a,n,n+e)),o=!0,!(s=Ot()))throw new Ft.ErrnoError(48);O.set(a,s)}else o=!1,s=a.byteOffset;return{ptr:s,allocated:o}},msync:function(t,e,n,i,r){return Mt.stream_ops.write(t,e,0,i,n,!1),0}}},Dt={0:"Success",1:"Arg list too long",2:"Permission denied",3:"Address already in use",4:"Address not available",5:"Address family not supported by protocol family",6:"No more processes",7:"Socket already connected",8:"Bad file number",9:"Trying to read unreadable message",10:"Mount device busy",11:"Operation canceled",12:"No children",13:"Connection aborted",14:"Connection refused",15:"Connection reset by peer",16:"File locking deadlock error",17:"Destination address required",18:"Math arg out of domain of func",19:"Quota exceeded",20:"File exists",21:"Bad address",22:"File too large",23:"Host is unreachable",24:"Identifier removed",25:"Illegal byte sequence",26:"Connection already in progress",27:"Interrupted system call",28:"Invalid argument",29:"I/O error",30:"Socket is already connected",31:"Is a directory",32:"Too many symbolic links",33:"Too many open files",34:"Too many links",35:"Message too long",36:"Multihop attempted",37:"File or path name too long",38:"Network interface is not configured",39:"Connection reset by network",40:"Network is unreachable",41:"Too many open files in system",42:"No buffer space available",43:"No such device",44:"No such file or directory",45:"Exec format error",46:"No record locks available",47:"The link has been severed",48:"Not enough core",49:"No message of desired type",50:"Protocol not available",51:"No space left on device",52:"Function not implemented",53:"Socket is not connected",54:"Not a directory",55:"Directory not empty",56:"State not recoverable",57:"Socket operation on non-socket",59:"Not a typewriter",60:"No such device or address",61:"Value too large for defined data type",62:"Previous owner died",63:"Not super-user",64:"Broken pipe",65:"Protocol error",66:"Unknown protocol",67:"Protocol wrong type for socket",68:"Math result not representable",69:"Read only file system",70:"Illegal seek",71:"No such process",72:"Stale file handle",73:"Connection timed out",74:"Text file busy",75:"Cross-device link",100:"Device not a stream",101:"Bad font file fmt",102:"Invalid slot",103:"Invalid request code",104:"No anode",105:"Block device required",106:"Channel number out of range",107:"Level 3 halted",108:"Level 3 reset",109:"Link number out of range",110:"Protocol driver not attached",111:"No CSI structure available",112:"Level 2 halted",113:"Invalid exchange",114:"Invalid request descriptor",115:"Exchange full",116:"No data (for no delay io)",117:"Timer expired",118:"Out of streams resources",119:"Machine is not on the network",120:"Package not installed",121:"The object is remote",122:"Advertise error",123:"Srmount error",124:"Communication error on send",125:"Cross mount point (not really error)",126:"Given log. name not unique",127:"f.d. invalid for this operation",128:"Remote address changed",129:"Can   access a needed shared lib",130:"Accessing a corrupted shared lib",131:".lib section in a.out corrupted",132:"Attempting to link in too many libs",133:"Attempting to exec a shared library",135:"Streams pipe error",136:"Too many users",137:"Socket type not supported",138:"Not supported",139:"Protocol family not supported",140:"Can't send after socket shutdown",141:"Too many references",142:"Host is down",148:"No medium (in tape drive)",156:"Level 2 not synchronized"},Pt={};function It(t){return t.replace(/\b_Z[\w\d_]+/g,(function(t){var e,n=(e=t,Et("warning: build with -sDEMANGLE_SUPPORT to link in libcxxabi demangling"),e);return t===n?t:n+" ["+t+"]"}))}var Ft={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(t,e={})=>{if(!(t=Ct.resolve(t)))return{path:"",node:null};if((e=Object.assign({follow_mount:!0,recurse_count:0},e)).recurse_count>8)throw new Ft.ErrnoError(32);for(var n=t.split("/").filter((t=>!!t)),i=Ft.root,r="/",s=0;s<n.length;s++){var o=s===n.length-1;if(o&&e.parent)break;if(i=Ft.lookupNode(i,n[s]),r=At.join2(r,n[s]),Ft.isMountpoint(i)&&(!o||o&&e.follow_mount)&&(i=i.mounted.root),!o||e.follow)for(var a=0;Ft.isLink(i.mode);){var l=Ft.readlink(r);if(r=Ct.resolve(At.dirname(r),l),i=Ft.lookupPath(r,{recurse_count:e.recurse_count+1}).node,a++>40)throw new Ft.ErrnoError(32)}}return{path:r,node:i}},getPath:t=>{for(var e;;){if(Ft.isRoot(t)){var n=t.mount.mountpoint;return e?"/"!==n[n.length-1]?n+"/"+e:n+e:n}e=e?t.name+"/"+e:t.name,t=t.parent}},hashName:(t,e)=>{for(var n=0,i=0;i<e.length;i++)n=(n<<5)-n+e.charCodeAt(i)|0;return(t+n>>>0)%Ft.nameTable.length},hashAddNode:t=>{var e=Ft.hashName(t.parent.id,t.name);t.name_next=Ft.nameTable[e],Ft.nameTable[e]=t},hashRemoveNode:t=>{var e=Ft.hashName(t.parent.id,t.name);if(Ft.nameTable[e]===t)Ft.nameTable[e]=t.name_next;else for(var n=Ft.nameTable[e];n;){if(n.name_next===t){n.name_next=t.name_next;break}n=n.name_next}},lookupNode:(t,e)=>{var n=Ft.mayLookup(t);if(n)throw new Ft.ErrnoError(n,t);for(var i=Ft.hashName(t.id,e),r=Ft.nameTable[i];r;r=r.name_next){var s=r.name;if(r.parent.id===t.id&&s===e)return r}return Ft.lookup(t,e)},createNode:(t,e,n,i)=>{k("object"==typeof t);var r=new Ft.FSNode(t,e,n,i);return Ft.hashAddNode(r),r},destroyNode:t=>{Ft.hashRemoveNode(t)},isRoot:t=>t===t.parent,isMountpoint:t=>!!t.mounted,isFile:t=>32768==(61440&t),isDir:t=>16384==(61440&t),isLink:t=>40960==(61440&t),isChrdev:t=>8192==(61440&t),isBlkdev:t=>24576==(61440&t),isFIFO:t=>4096==(61440&t),isSocket:t=>49152==(49152&t),flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:t=>{var e=Ft.flagModes[t];if(void 0===e)throw new Error("Unknown file open mode: "+t);return e},flagsToPermissionString:t=>{var e=["r","w","rw"][3&t];return 512&t&&(e+="w"),e},nodePermissions:(t,e)=>Ft.ignorePermissions||(!e.includes("r")||292&t.mode)&&(!e.includes("w")||146&t.mode)&&(!e.includes("x")||73&t.mode)?0:2,mayLookup:t=>{var e=Ft.nodePermissions(t,"x");return e||(t.node_ops.lookup?0:2)},mayCreate:(t,e)=>{try{return Ft.lookupNode(t,e),20}catch(Jo){}return Ft.nodePermissions(t,"wx")},mayDelete:(t,e,n)=>{var i;try{i=Ft.lookupNode(t,e)}catch(Jo){return Jo.errno}var r=Ft.nodePermissions(t,"wx");if(r)return r;if(n){if(!Ft.isDir(i.mode))return 54;if(Ft.isRoot(i)||Ft.getPath(i)===Ft.cwd())return 10}else if(Ft.isDir(i.mode))return 31;return 0},mayOpen:(t,e)=>t?Ft.isLink(t.mode)?32:Ft.isDir(t.mode)&&("r"!==Ft.flagsToPermissionString(e)||512&e)?31:Ft.nodePermissions(t,Ft.flagsToPermissionString(e)):44,MAX_OPEN_FDS:4096,nextfd:(t=0,e=Ft.MAX_OPEN_FDS)=>{for(var n=t;n<=e;n++)if(!Ft.streams[n])return n;throw new Ft.ErrnoError(33)},getStream:t=>Ft.streams[t],createStream:(t,e,n)=>{Ft.FSStream||(Ft.FSStream=function(){this.shared={}},Ft.FSStream.prototype={},Object.defineProperties(Ft.FSStream.prototype,{object:{get:function(){return this.node},set:function(t){this.node=t}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return 0!=(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}},flags:{get:function(){return this.shared.flags},set:function(t){this.shared.flags=t}},position:{get:function(){return this.shared.position},set:function(t){this.shared.position=t}}})),t=Object.assign(new Ft.FSStream,t);var i=Ft.nextfd(e,n);return t.fd=i,Ft.streams[i]=t,t},closeStream:t=>{Ft.streams[t]=null},chrdev_stream_ops:{open:t=>{var e=Ft.getDevice(t.node.rdev);t.stream_ops=e.stream_ops,t.stream_ops.open&&t.stream_ops.open(t)},llseek:()=>{throw new Ft.ErrnoError(70)}},major:t=>t>>8,minor:t=>255&t,makedev:(t,e)=>t<<8|e,registerDevice:(t,e)=>{Ft.devices[t]={stream_ops:e}},getDevice:t=>Ft.devices[t],getMounts:t=>{for(var e=[],n=[t];n.length;){var i=n.pop();e.push(i),n.push.apply(n,i.mounts)}return e},syncfs:(t,e)=>{"function"==typeof t&&(e=t,t=!1),Ft.syncFSRequests++,Ft.syncFSRequests>1&&A("warning: "+Ft.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var n=Ft.getMounts(Ft.root.mount),i=0;function r(t){return k(Ft.syncFSRequests>0),Ft.syncFSRequests--,e(t)}function s(t){if(t)return s.errored?void 0:(s.errored=!0,r(t));++i>=n.length&&r(null)}n.forEach((e=>{if(!e.type.syncfs)return s(null);e.type.syncfs(e,t,s)}))},mount:(t,e,n)=>{if("string"==typeof t)throw t;var i,r="/"===n,s=!n;if(r&&Ft.root)throw new Ft.ErrnoError(10);if(!r&&!s){var o=Ft.lookupPath(n,{follow_mount:!1});if(n=o.path,i=o.node,Ft.isMountpoint(i))throw new Ft.ErrnoError(10);if(!Ft.isDir(i.mode))throw new Ft.ErrnoError(54)}var a={type:t,opts:e,mountpoint:n,mounts:[]},l=t.mount(a);return l.mount=a,a.root=l,r?Ft.root=l:i&&(i.mounted=a,i.mount&&i.mount.mounts.push(a)),l},unmount:t=>{var e=Ft.lookupPath(t,{follow_mount:!1});if(!Ft.isMountpoint(e.node))throw new Ft.ErrnoError(28);var n=e.node,i=n.mounted,r=Ft.getMounts(i);Object.keys(Ft.nameTable).forEach((t=>{for(var e=Ft.nameTable[t];e;){var n=e.name_next;r.includes(e.mount)&&Ft.destroyNode(e),e=n}})),n.mounted=null;var s=n.mount.mounts.indexOf(i);k(-1!==s),n.mount.mounts.splice(s,1)},lookup:(t,e)=>t.node_ops.lookup(t,e),mknod:(t,e,n)=>{var i=Ft.lookupPath(t,{parent:!0}).node,r=At.basename(t);if(!r||"."===r||".."===r)throw new Ft.ErrnoError(28);var s=Ft.mayCreate(i,r);if(s)throw new Ft.ErrnoError(s);if(!i.node_ops.mknod)throw new Ft.ErrnoError(63);return i.node_ops.mknod(i,r,e,n)},create:(t,e)=>(e=void 0!==e?e:438,e&=4095,e|=32768,Ft.mknod(t,e,0)),mkdir:(t,e)=>(e=void 0!==e?e:511,e&=1023,e|=16384,Ft.mknod(t,e,0)),mkdirTree:(t,e)=>{for(var n=t.split("/"),i="",r=0;r<n.length;++r)if(n[r]){i+="/"+n[r];try{Ft.mkdir(i,e)}catch(Jo){if(20!=Jo.errno)throw Jo}}},mkdev:(t,e,n)=>(void 0===n&&(n=e,e=438),e|=8192,Ft.mknod(t,e,n)),symlink:(t,e)=>{if(!Ct.resolve(t))throw new Ft.ErrnoError(44);var n=Ft.lookupPath(e,{parent:!0}).node;if(!n)throw new Ft.ErrnoError(44);var i=At.basename(e),r=Ft.mayCreate(n,i);if(r)throw new Ft.ErrnoError(r);if(!n.node_ops.symlink)throw new Ft.ErrnoError(63);return n.node_ops.symlink(n,i,t)},rename:(t,e)=>{var n,i,r=At.dirname(t),s=At.dirname(e),o=At.basename(t),a=At.basename(e);if(n=Ft.lookupPath(t,{parent:!0}).node,i=Ft.lookupPath(e,{parent:!0}).node,!n||!i)throw new Ft.ErrnoError(44);if(n.mount!==i.mount)throw new Ft.ErrnoError(75);var l,c=Ft.lookupNode(n,o),u=Ct.relative(t,s);if("."!==u.charAt(0))throw new Ft.ErrnoError(28);if("."!==(u=Ct.relative(e,r)).charAt(0))throw new Ft.ErrnoError(55);try{l=Ft.lookupNode(i,a)}catch(Jo){}if(c!==l){var h=Ft.isDir(c.mode),d=Ft.mayDelete(n,o,h);if(d)throw new Ft.ErrnoError(d);if(d=l?Ft.mayDelete(i,a,h):Ft.mayCreate(i,a))throw new Ft.ErrnoError(d);if(!n.node_ops.rename)throw new Ft.ErrnoError(63);if(Ft.isMountpoint(c)||l&&Ft.isMountpoint(l))throw new Ft.ErrnoError(10);if(i!==n&&(d=Ft.nodePermissions(n,"w")))throw new Ft.ErrnoError(d);Ft.hashRemoveNode(c);try{n.node_ops.rename(c,i,a)}catch(Jo){throw Jo}finally{Ft.hashAddNode(c)}}},rmdir:t=>{var e=Ft.lookupPath(t,{parent:!0}).node,n=At.basename(t),i=Ft.lookupNode(e,n),r=Ft.mayDelete(e,n,!0);if(r)throw new Ft.ErrnoError(r);if(!e.node_ops.rmdir)throw new Ft.ErrnoError(63);if(Ft.isMountpoint(i))throw new Ft.ErrnoError(10);e.node_ops.rmdir(e,n),Ft.destroyNode(i)},readdir:t=>{var e=Ft.lookupPath(t,{follow:!0}).node;if(!e.node_ops.readdir)throw new Ft.ErrnoError(54);return e.node_ops.readdir(e)},unlink:t=>{var e=Ft.lookupPath(t,{parent:!0}).node;if(!e)throw new Ft.ErrnoError(44);var n=At.basename(t),i=Ft.lookupNode(e,n),r=Ft.mayDelete(e,n,!1);if(r)throw new Ft.ErrnoError(r);if(!e.node_ops.unlink)throw new Ft.ErrnoError(63);if(Ft.isMountpoint(i))throw new Ft.ErrnoError(10);e.node_ops.unlink(e,n),Ft.destroyNode(i)},readlink:t=>{var e=Ft.lookupPath(t).node;if(!e)throw new Ft.ErrnoError(44);if(!e.node_ops.readlink)throw new Ft.ErrnoError(28);return Ct.resolve(Ft.getPath(e.parent),e.node_ops.readlink(e))},stat:(t,e)=>{var n=Ft.lookupPath(t,{follow:!e}).node;if(!n)throw new Ft.ErrnoError(44);if(!n.node_ops.getattr)throw new Ft.ErrnoError(63);return n.node_ops.getattr(n)},lstat:t=>Ft.stat(t,!0),chmod:(t,e,n)=>{var i;if(!(i="string"==typeof t?Ft.lookupPath(t,{follow:!n}).node:t).node_ops.setattr)throw new Ft.ErrnoError(63);i.node_ops.setattr(i,{mode:4095&e|-4096&i.mode,timestamp:Date.now()})},lchmod:(t,e)=>{Ft.chmod(t,e,!0)},fchmod:(t,e)=>{var n=Ft.getStream(t);if(!n)throw new Ft.ErrnoError(8);Ft.chmod(n.node,e)},chown:(t,e,n,i)=>{var r;if(!(r="string"==typeof t?Ft.lookupPath(t,{follow:!i}).node:t).node_ops.setattr)throw new Ft.ErrnoError(63);r.node_ops.setattr(r,{timestamp:Date.now()})},lchown:(t,e,n)=>{Ft.chown(t,e,n,!0)},fchown:(t,e,n)=>{var i=Ft.getStream(t);if(!i)throw new Ft.ErrnoError(8);Ft.chown(i.node,e,n)},truncate:(t,e)=>{if(e<0)throw new Ft.ErrnoError(28);var n;if(!(n="string"==typeof t?Ft.lookupPath(t,{follow:!0}).node:t).node_ops.setattr)throw new Ft.ErrnoError(63);if(Ft.isDir(n.mode))throw new Ft.ErrnoError(31);if(!Ft.isFile(n.mode))throw new Ft.ErrnoError(28);var i=Ft.nodePermissions(n,"w");if(i)throw new Ft.ErrnoError(i);n.node_ops.setattr(n,{size:e,timestamp:Date.now()})},ftruncate:(t,e)=>{var n=Ft.getStream(t);if(!n)throw new Ft.ErrnoError(8);if(0==(2097155&n.flags))throw new Ft.ErrnoError(28);Ft.truncate(n.node,e)},utime:(t,e,n)=>{var i=Ft.lookupPath(t,{follow:!0}).node;i.node_ops.setattr(i,{timestamp:Math.max(e,n)})},open:(t,e,n)=>{if(""===t)throw new Ft.ErrnoError(44);var r;if(n=void 0===n?438:n,n=64&(e="string"==typeof e?Ft.modeStringToFlags(e):e)?4095&n|32768:0,"object"==typeof t)r=t;else{t=At.normalize(t);try{r=Ft.lookupPath(t,{follow:!(131072&e)}).node}catch(Jo){}}var s=!1;if(64&e)if(r){if(128&e)throw new Ft.ErrnoError(20)}else r=Ft.mknod(t,n,0),s=!0;if(!r)throw new Ft.ErrnoError(44);if(Ft.isChrdev(r.mode)&&(e&=-513),65536&e&&!Ft.isDir(r.mode))throw new Ft.ErrnoError(54);if(!s){var o=Ft.mayOpen(r,e);if(o)throw new Ft.ErrnoError(o)}512&e&&!s&&Ft.truncate(r,0),e&=-131713;var a=Ft.createStream({node:r,path:Ft.getPath(r),flags:e,seekable:!0,position:0,stream_ops:r.stream_ops,ungotten:[],error:!1});return a.stream_ops.open&&a.stream_ops.open(a),!i.logReadFiles||1&e||(Ft.readFiles||(Ft.readFiles={}),t in Ft.readFiles||(Ft.readFiles[t]=1)),a},close:t=>{if(Ft.isClosed(t))throw new Ft.ErrnoError(8);t.getdents&&(t.getdents=null);try{t.stream_ops.close&&t.stream_ops.close(t)}catch(Jo){throw Jo}finally{Ft.closeStream(t.fd)}t.fd=null},isClosed:t=>null===t.fd,llseek:(t,e,n)=>{if(Ft.isClosed(t))throw new Ft.ErrnoError(8);if(!t.seekable||!t.stream_ops.llseek)throw new Ft.ErrnoError(70);if(0!=n&&1!=n&&2!=n)throw new Ft.ErrnoError(28);return t.position=t.stream_ops.llseek(t,e,n),t.ungotten=[],t.position},read:(t,e,n,i,r)=>{if(i<0||r<0)throw new Ft.ErrnoError(28);if(Ft.isClosed(t))throw new Ft.ErrnoError(8);if(1==(2097155&t.flags))throw new Ft.ErrnoError(8);if(Ft.isDir(t.node.mode))throw new Ft.ErrnoError(31);if(!t.stream_ops.read)throw new Ft.ErrnoError(28);var s=void 0!==r;if(s){if(!t.seekable)throw new Ft.ErrnoError(70)}else r=t.position;var o=t.stream_ops.read(t,e,n,i,r);return s||(t.position+=o),o},write:(t,e,n,i,r,s)=>{if(i<0||r<0)throw new Ft.ErrnoError(28);if(Ft.isClosed(t))throw new Ft.ErrnoError(8);if(0==(2097155&t.flags))throw new Ft.ErrnoError(8);if(Ft.isDir(t.node.mode))throw new Ft.ErrnoError(31);if(!t.stream_ops.write)throw new Ft.ErrnoError(28);t.seekable&&1024&t.flags&&Ft.llseek(t,0,2);var o=void 0!==r;if(o){if(!t.seekable)throw new Ft.ErrnoError(70)}else r=t.position;var a=t.stream_ops.write(t,e,n,i,r,s);return o||(t.position+=a),a},allocate:(t,e,n)=>{if(Ft.isClosed(t))throw new Ft.ErrnoError(8);if(e<0||n<=0)throw new Ft.ErrnoError(28);if(0==(2097155&t.flags))throw new Ft.ErrnoError(8);if(!Ft.isFile(t.node.mode)&&!Ft.isDir(t.node.mode))throw new Ft.ErrnoError(43);if(!t.stream_ops.allocate)throw new Ft.ErrnoError(138);t.stream_ops.allocate(t,e,n)},mmap:(t,e,n,i,r)=>{if(0!=(2&i)&&0==(2&r)&&2!=(2097155&t.flags))throw new Ft.ErrnoError(2);if(1==(2097155&t.flags))throw new Ft.ErrnoError(2);if(!t.stream_ops.mmap)throw new Ft.ErrnoError(43);return t.stream_ops.mmap(t,e,n,i,r)},msync:(t,e,n,i,r)=>t.stream_ops.msync?t.stream_ops.msync(t,e,n,i,r):0,munmap:t=>0,ioctl:(t,e,n)=>{if(!t.stream_ops.ioctl)throw new Ft.ErrnoError(59);return t.stream_ops.ioctl(t,e,n)},readFile:(t,e={})=>{if(e.flags=e.flags||0,e.encoding=e.encoding||"binary","utf8"!==e.encoding&&"binary"!==e.encoding)throw new Error('Invalid encoding type "'+e.encoding+'"');var n,i=Ft.open(t,e.flags),r=Ft.stat(t).size,s=new Uint8Array(r);return Ft.read(i,s,0,r,0),"utf8"===e.encoding?n=V(s,0):"binary"===e.encoding&&(n=s),Ft.close(i),n},writeFile:(t,e,n={})=>{n.flags=n.flags||577;var i=Ft.open(t,n.flags,n.mode);if("string"==typeof e){var r=new Uint8Array(W(e)+1),s=$(e,r,0,r.length);Ft.write(i,r,0,s,void 0,n.canOwn)}else{if(!ArrayBuffer.isView(e))throw new Error("Unsupported data type");Ft.write(i,e,0,e.byteLength,void 0,n.canOwn)}Ft.close(i)},cwd:()=>Ft.currentPath,chdir:t=>{var e=Ft.lookupPath(t,{follow:!0});if(null===e.node)throw new Ft.ErrnoError(44);if(!Ft.isDir(e.node.mode))throw new Ft.ErrnoError(54);var n=Ft.nodePermissions(e.node,"x");if(n)throw new Ft.ErrnoError(n);Ft.currentPath=e.path},createDefaultDirectories:()=>{Ft.mkdir("/tmp"),Ft.mkdir("/home"),Ft.mkdir("/home/web_user")},createDefaultDevices:()=>{Ft.mkdir("/dev"),Ft.registerDevice(Ft.makedev(1,3),{read:()=>0,write:(t,e,n,i,r)=>i}),Ft.mkdev("/dev/null",Ft.makedev(1,3)),kt.register(Ft.makedev(5,0),kt.default_tty_ops),kt.register(Ft.makedev(6,0),kt.default_tty1_ops),Ft.mkdev("/dev/tty",Ft.makedev(5,0)),Ft.mkdev("/dev/tty1",Ft.makedev(6,0));var t=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return()=>(crypto.getRandomValues(t),t[0])}if(u)try{var e=v("crypto");return()=>e.randomBytes(1)[0]}catch(Jo){}return()=>rt("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: function(array) { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")}();Ft.createDevice("/dev","random",t),Ft.createDevice("/dev","urandom",t),Ft.mkdir("/dev/shm"),Ft.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{Ft.mkdir("/proc");var t=Ft.mkdir("/proc/self");Ft.mkdir("/proc/self/fd"),Ft.mount({mount:()=>{var e=Ft.createNode(t,"fd",16895,73);return e.node_ops={lookup:(t,e)=>{var n=+e,i=Ft.getStream(n);if(!i)throw new Ft.ErrnoError(8);var r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path}};return r.parent=r,r}},e}},{},"/proc/self/fd")},createStandardStreams:()=>{i.stdin?Ft.createDevice("/dev","stdin",i.stdin):Ft.symlink("/dev/tty","/dev/stdin"),i.stdout?Ft.createDevice("/dev","stdout",null,i.stdout):Ft.symlink("/dev/tty","/dev/stdout"),i.stderr?Ft.createDevice("/dev","stderr",null,i.stderr):Ft.symlink("/dev/tty1","/dev/stderr");var t=Ft.open("/dev/stdin",0),e=Ft.open("/dev/stdout",1),n=Ft.open("/dev/stderr",1);k(0===t.fd,"invalid handle for stdin ("+t.fd+")"),k(1===e.fd,"invalid handle for stdout ("+e.fd+")"),k(2===n.fd,"invalid handle for stderr ("+n.fd+")")},ensureErrnoError:()=>{Ft.ErrnoError||(Ft.ErrnoError=function(t,e){this.name="ErrnoError",this.node=e,this.setErrno=function(t){for(var e in this.errno=t,Pt)if(Pt[e]===t){this.code=e;break}},this.setErrno(t),this.message=Dt[t],this.stack&&(Object.defineProperty(this,"stack",{value:(new Error).stack,writable:!0}),this.stack=It(this.stack))},Ft.ErrnoError.prototype=new Error,Ft.ErrnoError.prototype.constructor=Ft.ErrnoError,[44].forEach((t=>{Ft.genericErrors[t]=new Ft.ErrnoError(t),Ft.genericErrors[t].stack="<generic error, no stack>"})))},staticInit:()=>{Ft.ensureErrnoError(),Ft.nameTable=new Array(4096),Ft.mount(Mt,{},"/"),Ft.createDefaultDirectories(),Ft.createDefaultDevices(),Ft.createSpecialDirectories(),Ft.filesystems={MEMFS:Mt}},init:(t,e,n)=>{k(!Ft.init.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),Ft.init.initialized=!0,Ft.ensureErrnoError(),i.stdin=t||i.stdin,i.stdout=e||i.stdout,i.stderr=n||i.stderr,Ft.createStandardStreams()},quit:()=>{Ft.init.initialized=!1,Dn(0);for(var t=0;t<Ft.streams.length;t++){var e=Ft.streams[t];e&&Ft.close(e)}},getMode:(t,e)=>{var n=0;return t&&(n|=365),e&&(n|=146),n},findObject:(t,e)=>{var n=Ft.analyzePath(t,e);return n.exists?n.object:null},analyzePath:(t,e)=>{try{t=(i=Ft.lookupPath(t,{follow:!e})).path}catch(Jo){}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var i=Ft.lookupPath(t,{parent:!0});n.parentExists=!0,n.parentPath=i.path,n.parentObject=i.node,n.name=At.basename(t),i=Ft.lookupPath(t,{follow:!e}),n.exists=!0,n.path=i.path,n.object=i.node,n.name=i.node.name,n.isRoot="/"===i.path}catch(Jo){n.error=Jo.errno}return n},createPath:(t,e,n,i)=>{t="string"==typeof t?t:Ft.getPath(t);for(var r=e.split("/").reverse();r.length;){var s=r.pop();if(s){var o=At.join2(t,s);try{Ft.mkdir(o)}catch(Jo){}t=o}}return o},createFile:(t,e,n,i,r)=>{var s=At.join2("string"==typeof t?t:Ft.getPath(t),e),o=Ft.getMode(i,r);return Ft.create(s,o)},createDataFile:(t,e,n,i,r,s)=>{var o=e;t&&(t="string"==typeof t?t:Ft.getPath(t),o=e?At.join2(t,e):t);var a=Ft.getMode(i,r),l=Ft.create(o,a);if(n){if("string"==typeof n){for(var c=new Array(n.length),u=0,h=n.length;u<h;++u)c[u]=n.charCodeAt(u);n=c}Ft.chmod(l,146|a);var d=Ft.open(l,577);Ft.write(d,n,0,n.length,0,s),Ft.close(d),Ft.chmod(l,a)}return l},createDevice:(t,e,n,i)=>{var r=At.join2("string"==typeof t?t:Ft.getPath(t),e),s=Ft.getMode(!!n,!!i);Ft.createDevice.major||(Ft.createDevice.major=64);var o=Ft.makedev(Ft.createDevice.major++,0);return Ft.registerDevice(o,{open:t=>{t.seekable=!1},close:t=>{i&&i.buffer&&i.buffer.length&&i(10)},read:(t,e,i,r,s)=>{for(var o=0,a=0;a<r;a++){var l;try{l=n()}catch(Jo){throw new Ft.ErrnoError(29)}if(void 0===l&&0===o)throw new Ft.ErrnoError(6);if(null==l)break;o++,e[i+a]=l}return o&&(t.node.timestamp=Date.now()),o},write:(t,e,n,r,s)=>{for(var o=0;o<r;o++)try{i(e[n+o])}catch(Jo){throw new Ft.ErrnoError(29)}return r&&(t.node.timestamp=Date.now()),o}}),Ft.mkdev(r,s,o)},forceLoadFile:t=>{if(t.isDevice||t.isFolder||t.link||t.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!d)throw new Error("Cannot load without read() or XMLHttpRequest.");try{t.contents=St(d(t.url),!0),t.usedBytes=t.contents.length}catch(Jo){throw new Ft.ErrnoError(29)}},createLazyFile:(t,e,n,i,r)=>{function s(){this.lengthKnown=!1,this.chunks=[]}if(s.prototype.get=function(t){if(!(t>this.length-1||t<0)){var e=t%this.chunkSize,n=t/this.chunkSize|0;return this.getter(n)[e]}},s.prototype.setDataGetter=function(t){this.getter=t},s.prototype.cacheLength=function(){var t=new XMLHttpRequest;if(t.open("HEAD",n,!1),t.send(null),!(t.status>=200&&t.status<300||304===t.status))throw new Error("Couldn't load "+n+". Status: "+t.status);var e,i=Number(t.getResponseHeader("Content-length")),r=(e=t.getResponseHeader("Accept-Ranges"))&&"bytes"===e,s=(e=t.getResponseHeader("Content-Encoding"))&&"gzip"===e,o=1048576;r||(o=i);var a=this;a.setDataGetter((t=>{var e=t*o,r=(t+1)*o-1;if(r=Math.min(r,i-1),void 0===a.chunks[t]&&(a.chunks[t]=((t,e)=>{if(t>e)throw new Error("invalid range ("+t+", "+e+") or no bytes requested!");if(e>i-1)throw new Error("only "+i+" bytes available! programmer error!");var r=new XMLHttpRequest;if(r.open("GET",n,!1),i!==o&&r.setRequestHeader("Range","bytes="+t+"-"+e),r.responseType="arraybuffer",r.overrideMimeType&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.send(null),!(r.status>=200&&r.status<300||304===r.status))throw new Error("Couldn't load "+n+". Status: "+r.status);return void 0!==r.response?new Uint8Array(r.response||[]):St(r.responseText||"",!0)})(e,r)),void 0===a.chunks[t])throw new Error("doXHR failed!");return a.chunks[t]})),!s&&i||(o=i=1,i=this.getter(0).length,o=i,x("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=i,this._chunkSize=o,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!c)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var o=new s;Object.defineProperties(o,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var a={isDevice:!1,contents:o}}else a={isDevice:!1,url:n};var l=Ft.createFile(t,e,a,i,r);a.contents?l.contents=a.contents:a.url&&(l.contents=null,l.url=a.url),Object.defineProperties(l,{usedBytes:{get:function(){return this.contents.length}}});var u={};function h(t,e,n,i,r){var s=t.node.contents;if(r>=s.length)return 0;var o=Math.min(s.length-r,i);if(k(o>=0),s.slice)for(var a=0;a<o;a++)e[n+a]=s[r+a];else for(a=0;a<o;a++)e[n+a]=s.get(r+a);return o}return Object.keys(l.stream_ops).forEach((t=>{var e=l.stream_ops[t];u[t]=function(){return Ft.forceLoadFile(l),e.apply(null,arguments)}})),u.read=(t,e,n,i,r)=>(Ft.forceLoadFile(l),h(t,e,n,i,r)),u.mmap=(t,e,n,i,r)=>{Ft.forceLoadFile(l);var s=Ot();if(!s)throw new Ft.ErrnoError(48);return h(t,O,s,e,n),{ptr:s,allocated:!0}},l.stream_ops=u,l},createPreloadedFile:(t,e,n,i,r,s,o,a,l,c)=>{var u=e?Ct.resolve(At.join2(t,e)):t,h=et("cp "+u);function d(n){function d(n){c&&c(),a||Ft.createDataFile(t,e,n,i,r,l),s&&s(),it(h)}Browser.handledByPreloadPlugin(n,u,d,(()=>{o&&o(),it(h)}))||d(n)}nt(h),"string"==typeof n?function(t,e,n,i){var r=et("al "+t);p(t,(n=>{k(n,'Loading data file "'+t+'" failed (no arrayBuffer).'),e(new Uint8Array(n)),r&&it(r)}),(e=>{if(!n)throw'Loading data file "'+t+'" failed.';n()})),r&&nt(r)}(n,(t=>d(t)),o):d(n)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(t,e=(()=>{}),n=(()=>{}))=>{var i=Ft.indexedDB();try{var r=i.open(Ft.DB_NAME(),Ft.DB_VERSION)}catch(Jo){return n(Jo)}r.onupgradeneeded=()=>{x("creating db"),r.result.createObjectStore(Ft.DB_STORE_NAME)},r.onsuccess=()=>{var i=r.result.transaction([Ft.DB_STORE_NAME],"readwrite"),s=i.objectStore(Ft.DB_STORE_NAME),o=0,a=0,l=t.length;function c(){0==a?e():n()}t.forEach((t=>{var e=s.put(Ft.analyzePath(t).object.contents,t);e.onsuccess=()=>{++o+a==l&&c()},e.onerror=()=>{a++,o+a==l&&c()}})),i.onerror=n},r.onerror=n},loadFilesFromDB:(t,e=(()=>{}),n=(()=>{}))=>{var i=Ft.indexedDB();try{var r=i.open(Ft.DB_NAME(),Ft.DB_VERSION)}catch(Jo){return n(Jo)}r.onupgradeneeded=n,r.onsuccess=()=>{var i=r.result;try{var s=i.transaction([Ft.DB_STORE_NAME],"readonly")}catch(Jo){return void n(Jo)}var o=s.objectStore(Ft.DB_STORE_NAME),a=0,l=0,c=t.length;function u(){0==l?e():n()}t.forEach((t=>{var e=o.get(t);e.onsuccess=()=>{Ft.analyzePath(t).exists&&Ft.unlink(t),Ft.createDataFile(At.dirname(t),At.basename(t),e.result,!0,!0,!0),++a+l==c&&u()},e.onerror=()=>{l++,a+l==c&&u()}})),s.onerror=n},r.onerror=n},absolutePath:()=>{rt("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder:()=>{rt("FS.createFolder has been removed; use FS.mkdir instead")},createLink:()=>{rt("FS.createLink has been removed; use FS.symlink instead")},joinPath:()=>{rt("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc:()=>{rt("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath:()=>{rt("FS.standardizePath has been removed; use PATH.normalize instead")}},Rt={DEFAULT_POLLMASK:5,calculateAt:function(t,e,n){if(At.isAbs(e))return e;var i;if(i=-100===t?Ft.cwd():Rt.getStreamFromFD(t).path,0==e.length){if(!n)throw new Ft.ErrnoError(44);return i}return At.join2(i,e)},doStat:function(t,e,n){try{var i=t(e)}catch(Jo){if(Jo&&Jo.node&&At.normalize(e)!==At.normalize(Ft.getPath(Jo.node)))return-54;throw Jo}I[n>>2]=i.dev,I[n+8>>2]=i.ino,I[n+12>>2]=i.mode,F[n+16>>2]=i.nlink,I[n+20>>2]=i.uid,I[n+24>>2]=i.gid,I[n+28>>2]=i.rdev,lt=[i.size>>>0,(at=i.size,+Math.abs(at)>=1?at>0?(0|Math.min(+Math.floor(at/4294967296),4294967295))>>>0:~~+Math.ceil((at-+(~~at>>>0))/4294967296)>>>0:0)],I[n+40>>2]=lt[0],I[n+44>>2]=lt[1],I[n+48>>2]=4096,I[n+52>>2]=i.blocks;var r=i.atime.getTime(),s=i.mtime.getTime(),o=i.ctime.getTime();return lt=[Math.floor(r/1e3)>>>0,(at=Math.floor(r/1e3),+Math.abs(at)>=1?at>0?(0|Math.min(+Math.floor(at/4294967296),4294967295))>>>0:~~+Math.ceil((at-+(~~at>>>0))/4294967296)>>>0:0)],I[n+56>>2]=lt[0],I[n+60>>2]=lt[1],F[n+64>>2]=r%1e3*1e3,lt=[Math.floor(s/1e3)>>>0,(at=Math.floor(s/1e3),+Math.abs(at)>=1?at>0?(0|Math.min(+Math.floor(at/4294967296),4294967295))>>>0:~~+Math.ceil((at-+(~~at>>>0))/4294967296)>>>0:0)],I[n+72>>2]=lt[0],I[n+76>>2]=lt[1],F[n+80>>2]=s%1e3*1e3,lt=[Math.floor(o/1e3)>>>0,(at=Math.floor(o/1e3),+Math.abs(at)>=1?at>0?(0|Math.min(+Math.floor(at/4294967296),4294967295))>>>0:~~+Math.ceil((at-+(~~at>>>0))/4294967296)>>>0:0)],I[n+88>>2]=lt[0],I[n+92>>2]=lt[1],F[n+96>>2]=o%1e3*1e3,lt=[i.ino>>>0,(at=i.ino,+Math.abs(at)>=1?at>0?(0|Math.min(+Math.floor(at/4294967296),4294967295))>>>0:~~+Math.ceil((at-+(~~at>>>0))/4294967296)>>>0:0)],I[n+104>>2]=lt[0],I[n+108>>2]=lt[1],0},doMsync:function(t,e,n,i,r){if(!Ft.isFile(e.node.mode))throw new Ft.ErrnoError(43);if(2&i)return 0;var s=M.slice(t,t+n);Ft.msync(e,s,r,n,i)},varargs:void 0,get:function(){return k(null!=Rt.varargs),Rt.varargs+=4,I[Rt.varargs-4>>2]},getStr:function(t){return B(t)},getStreamFromFD:function(t){var e=Ft.getStream(t);if(!e)throw new Ft.ErrnoError(8);return e}},Nt={};function Lt(t){for(;t.length;){var e=t.pop();t.pop()(e)}}function jt(t){return this.fromWireType(I[t>>2])}var Vt={},Bt={},$t={},Wt=48,zt=57;function Ut(t){if(void 0===t)return"_unknown";var e=(t=t.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return e>=Wt&&e<=zt?"_"+t:t}function qt(t,e){return{[t=Ut(t)]:function(){return e.apply(this,arguments)}}[t]}function Ht(t,e){var n=qt(e,(function(t){this.name=e,this.message=t;var n=new Error(t).stack;void 0!==n&&(this.stack=this.toString()+"\n"+n.replace(/^Error(:[^\n]*)?\n/,""))}));return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},n}var Gt=void 0;function Yt(t){throw new Gt(t)}function Xt(t,e,n){function i(e){var i=n(e);i.length!==t.length&&Yt("Mismatched type converter count");for(var r=0;r<t.length;++r)ee(t[r],i[r])}t.forEach((function(t){$t[t]=e}));var r=new Array(e.length),s=[],o=0;e.forEach(((t,e)=>{Bt.hasOwnProperty(t)?r[e]=Bt[t]:(s.push(t),Vt.hasOwnProperty(t)||(Vt[t]=[]),Vt[t].push((()=>{r[e]=Bt[t],++o===s.length&&i(r)})))})),0===s.length&&i(r)}function Zt(t){switch(t){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+t)}}var Kt=void 0;function Jt(t){for(var e="",n=t;M[n];)e+=Kt[M[n++]];return e}var Qt=void 0;function te(t){throw new Qt(t)}function ee(t,e,n={}){if(!("argPackAdvance"in e))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=e.name;if(t||te('type "'+i+'" must have a positive integer typeid pointer'),Bt.hasOwnProperty(t)){if(n.ignoreDuplicateRegistrations)return;te("Cannot register type '"+i+"' twice")}if(Bt[t]=e,delete $t[t],Vt.hasOwnProperty(t)){var r=Vt[t];delete Vt[t],r.forEach((t=>t()))}}function ne(t){if(!(this instanceof Ae))return!1;if(!(t instanceof Ae))return!1;for(var e=this.$$.ptrType.registeredClass,n=this.$$.ptr,i=t.$$.ptrType.registeredClass,r=t.$$.ptr;e.baseClass;)n=e.upcast(n),e=e.baseClass;for(;i.baseClass;)r=i.upcast(r),i=i.baseClass;return e===i&&n===r}function ie(t){return{count:t.count,deleteScheduled:t.deleteScheduled,preservePointerOnDelete:t.preservePointerOnDelete,ptr:t.ptr,ptrType:t.ptrType,smartPtr:t.smartPtr,smartPtrType:t.smartPtrType}}function re(t){te(t.$$.ptrType.registeredClass.name+" instance already deleted")}var se=!1;function oe(t){}function ae(t){t.count.value-=1,0===t.count.value&&function(t){t.smartPtr?t.smartPtrType.rawDestructor(t.smartPtr):t.ptrType.registeredClass.rawDestructor(t.ptr)}(t)}function le(t,e,n){if(e===n)return t;if(void 0===n.baseClass)return null;var i=le(t,e,n.baseClass);return null===i?null:n.downcast(i)}var ce={};function ue(){return Object.keys(ge).length}function he(){var t=[];for(var e in ge)ge.hasOwnProperty(e)&&t.push(ge[e]);return t}var de=[];function pe(){for(;de.length;){var t=de.pop();t.$$.deleteScheduled=!1,t.delete()}}var me=void 0;function fe(t){me=t,de.length&&me&&me(pe)}var ge={};function _e(t,e){return e=function(t,e){for(void 0===e&&te("ptr should not be undefined");t.baseClass;)e=t.upcast(e),t=t.baseClass;return e}(t,e),ge[e]}function ve(t,e){return e.ptrType&&e.ptr||Yt("makeClassHandle requires ptr and ptrType"),!!e.smartPtrType!=!!e.smartPtr&&Yt("Both smartPtrType and smartPtr must be specified"),e.count={value:1},we(Object.create(t,{$$:{value:e}}))}function ye(t){var e=this.getPointee(t);if(!e)return this.destructor(t),null;var n=_e(this.registeredClass,e);if(void 0!==n){if(0===n.$$.count.value)return n.$$.ptr=e,n.$$.smartPtr=t,n.clone();var i=n.clone();return this.destructor(t),i}function r(){return this.isSmartPointer?ve(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:e,smartPtrType:this,smartPtr:t}):ve(this.registeredClass.instancePrototype,{ptrType:this,ptr:t})}var s,o=this.registeredClass.getActualType(e),a=ce[o];if(!a)return r.call(this);s=this.isConst?a.constPointerType:a.pointerType;var l=le(e,this.registeredClass,s.registeredClass);return null===l?r.call(this):this.isSmartPointer?ve(s.registeredClass.instancePrototype,{ptrType:s,ptr:l,smartPtrType:this,smartPtr:t}):ve(s.registeredClass.instancePrototype,{ptrType:s,ptr:l})}function we(t){return"undefined"==typeof FinalizationRegistry?(we=t=>t,t):(se=new FinalizationRegistry((t=>{ae(t.$$)})),we=t=>{var e=t.$$;if(e.smartPtr){var n={$$:e},i=e.ptrType.registeredClass;n.leakWarning=new Error("Embind found a leaked C++ instance "+i.name+" <"+Tt(e.ptr)+">.\nWe'll free it automatically in this case, but this functionality is not reliable across various environments.\nMake sure to invoke .delete() manually once you're done with the instance instead.\nOriginally allocated"),"captureStackTrace"in Error&&Error.captureStackTrace(n.leakWarning,ye),se.register(t,n,t)}return t},oe=t=>se.unregister(t),we(t))}function be(){if(this.$$.ptr||re(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var t=we(Object.create(Object.getPrototypeOf(this),{$$:{value:ie(this.$$)}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t}function Te(){this.$$.ptr||re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&te("Object already scheduled for deletion"),oe(this),ae(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Ee(){return!this.$$.ptr}function xe(){return this.$$.ptr||re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&te("Object already scheduled for deletion"),de.push(this),1===de.length&&me&&me(pe),this.$$.deleteScheduled=!0,this}function Ae(){}function Ce(t,e,n){if(void 0===t[e].overloadTable){var i=t[e];t[e]=function(){return t[e].overloadTable.hasOwnProperty(arguments.length)||te("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+t[e].overloadTable+")!"),t[e].overloadTable[arguments.length].apply(this,arguments)},t[e].overloadTable=[],t[e].overloadTable[i.argCount]=i}}function Se(t,e,n){i.hasOwnProperty(t)?(te("Cannot register public name '"+t+"' twice"),Ce(i,t,t),i.hasOwnProperty(n)&&te("Cannot register multiple overloads of a function with the same number of arguments ("+n+")!"),i[t].overloadTable[n]=e):i[t]=e}function ke(t,e,n,i,r,s,o,a){this.name=t,this.constructor=e,this.instancePrototype=n,this.rawDestructor=i,this.baseClass=r,this.getActualType=s,this.upcast=o,this.downcast=a,this.pureVirtualFunctions=[]}function Oe(t,e,n){for(;e!==n;)e.upcast||te("Expected null or instance of "+n.name+", got an instance of "+e.name),t=e.upcast(t),e=e.baseClass;return t}function Me(t,e){if(null===e)return this.isReference&&te("null is not a valid "+this.name),0;e.$$||te('Cannot pass "'+tn(e)+'" as a '+this.name),e.$$.ptr||te("Cannot pass deleted object as a pointer of type "+this.name);var n=e.$$.ptrType.registeredClass;return Oe(e.$$.ptr,n,this.registeredClass)}function De(t,e){var n;if(null===e)return this.isReference&&te("null is not a valid "+this.name),this.isSmartPointer?(n=this.rawConstructor(),null!==t&&t.push(this.rawDestructor,n),n):0;e.$$||te('Cannot pass "'+tn(e)+'" as a '+this.name),e.$$.ptr||te("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&e.$$.ptrType.isConst&&te("Cannot convert argument of type "+(e.$$.smartPtrType?e.$$.smartPtrType.name:e.$$.ptrType.name)+" to parameter type "+this.name);var i=e.$$.ptrType.registeredClass;if(n=Oe(e.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(void 0===e.$$.smartPtr&&te("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:e.$$.smartPtrType===this?n=e.$$.smartPtr:te("Cannot convert argument of type "+(e.$$.smartPtrType?e.$$.smartPtrType.name:e.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:n=e.$$.smartPtr;break;case 2:if(e.$$.smartPtrType===this)n=e.$$.smartPtr;else{var r=e.clone();n=this.rawShare(n,Ke.toHandle((function(){r.delete()}))),null!==t&&t.push(this.rawDestructor,n)}break;default:te("Unsupporting sharing policy")}return n}function Pe(t,e){if(null===e)return this.isReference&&te("null is not a valid "+this.name),0;e.$$||te('Cannot pass "'+tn(e)+'" as a '+this.name),e.$$.ptr||te("Cannot pass deleted object as a pointer of type "+this.name),e.$$.ptrType.isConst&&te("Cannot convert argument of type "+e.$$.ptrType.name+" to parameter type "+this.name);var n=e.$$.ptrType.registeredClass;return Oe(e.$$.ptr,n,this.registeredClass)}function Ie(t){return this.rawGetPointee&&(t=this.rawGetPointee(t)),t}function Fe(t){this.rawDestructor&&this.rawDestructor(t)}function Re(t){null!==t&&t.delete()}function Ne(t,e,n,i,r,s,o,a,l,c,u){this.name=t,this.registeredClass=e,this.isReference=n,this.isConst=i,this.isSmartPointer=r,this.pointeeType=s,this.sharingPolicy=o,this.rawGetPointee=a,this.rawConstructor=l,this.rawShare=c,this.rawDestructor=u,r||void 0!==e.baseClass?this.toWireType=De:i?(this.toWireType=Me,this.destructorFunction=null):(this.toWireType=Pe,this.destructorFunction=null)}var Le=[];function je(t){var e=Le[t];return e||(t>=Le.length&&(Le.length=t+1),Le[t]=e=L.get(t)),k(L.get(t)==e,"JavaScript-side Wasm function table mirror is out of date!"),e}function Ve(t,e,n){return t.includes("j")?function(t,e,n){k("dynCall_"+t in i,"bad function pointer type - dynCall function not found for sig '"+t+"'"),n&&n.length?k(n.length===t.substring(1).replace(/j/g,"--").length):k(1==t.length);var r=i["dynCall_"+t];return n&&n.length?r.apply(null,[e].concat(n)):r.call(null,e)}(t,e,n):(k(je(e),"missing table entry in dynCall: "+e),je(e).apply(null,n))}function Be(t,e){var n=(t=Jt(t)).includes("j")?function(t,e){k(t.includes("j")||t.includes("p"),"getDynCaller should only be called with i64 sigs");var n=[];return function(){return n.length=0,Object.assign(n,arguments),Ve(t,e,n)}}(t,e):je(e);return"function"!=typeof n&&te("unknown function pointer with signature "+t+": "+e),n}var $e=void 0;function We(t){var e=Pn(t),n=Jt(e);return On(e),n}function ze(t,e){var n=[],i={};throw e.forEach((function t(e){i[e]||Bt[e]||($t[e]?$t[e].forEach(t):(n.push(e),i[e]=!0))})),new $e(t+": "+n.map(We).join([", "]))}function Ue(t,e,n,i,r,s){var o=e.length;o<2&&te("argTypes array size mismatch! Must at least get return value and 'this' types!"),k(!s,"Async bindings are only supported with JSPI.");for(var a=null!==e[1]&&null!==n,l=!1,c=1;c<e.length;++c)if(null!==e[c]&&void 0===e[c].destructorFunction){l=!0;break}var u="void"!==e[0].name,h="",d="";for(c=0;c<o-2;++c)h+=(0!==c?", ":"")+"arg"+c,d+=(0!==c?", ":"")+"arg"+c+"Wired";var p="return function "+Ut(t)+"("+h+") {\nif (arguments.length !== "+(o-2)+") {\nthrowBindingError('function "+t+" called with ' + arguments.length + ' arguments, expected "+(o-2)+" args!');\n}\n";l&&(p+="var destructors = [];\n");var m=l?"destructors":"null",f=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],g=[te,i,r,Lt,e[0],e[1]];for(a&&(p+="var thisWired = classParam.toWireType("+m+", this);\n"),c=0;c<o-2;++c)p+="var arg"+c+"Wired = argType"+c+".toWireType("+m+", arg"+c+"); // "+e[c+2].name+"\n",f.push("argType"+c),g.push(e[c+2]);if(a&&(d="thisWired"+(d.length>0?", ":"")+d),p+=(u||s?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+");\n",l)p+="runDestructors(destructors);\n";else for(c=a?1:2;c<e.length;++c){var _=1===c?"thisWired":"arg"+(c-2)+"Wired";null!==e[c].destructorFunction&&(p+=_+"_dtor("+_+"); // "+e[c].name+"\n",f.push(_+"_dtor"),g.push(e[c].destructorFunction))}u&&(p+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),p+="}\n",f.push(p);var v=function(t,e){if(!(t instanceof Function))throw new TypeError("new_ called with constructor type "+typeof t+" which is not a function");var n=qt(t.name||"unknownFunctionName",(function(){}));n.prototype=t.prototype;var i=new n,r=t.apply(i,e);return r instanceof Object?r:i}(Function,f).apply(null,g);return v}function qe(t,e){for(var n=[],i=0;i<t;i++)n.push(F[e+4*i>>2]);return n}var He=[],Ge=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Ye(t){t>4&&0==--Ge[t].refcount&&(Ge[t]=void 0,He.push(t))}function Xe(){for(var t=0,e=5;e<Ge.length;++e)void 0!==Ge[e]&&++t;return t}function Ze(){for(var t=5;t<Ge.length;++t)if(void 0!==Ge[t])return Ge[t];return null}var Ke={toValue:t=>(t||te("Cannot use deleted val. handle = "+t),Ge[t].value),toHandle:t=>{switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var e=He.length?He.pop():Ge.length;return Ge[e]={refcount:1,value:t},e}}};function Je(t,e,n){switch(e){case 0:return function(t){var e=n?O:M;return this.fromWireType(e[t])};case 1:return function(t){var e=n?D:P;return this.fromWireType(e[t>>1])};case 2:return function(t){var e=n?I:F;return this.fromWireType(e[t>>2])};default:throw new TypeError("Unknown integer type: "+t)}}function Qe(t,e){var n=Bt[t];return void 0===n&&te(e+" has unknown type "+We(t)),n}function tn(t){if(null===t)return"null";var e=typeof t;return"object"===e||"array"===e||"function"===e?t.toString():""+t}function en(t,e){switch(e){case 2:return function(t){return this.fromWireType(R[t>>2])};case 3:return function(t){return this.fromWireType(N[t>>3])};default:throw new TypeError("Unknown float type: "+t)}}function nn(t,e,n){switch(e){case 0:return n?function(t){return O[t]}:function(t){return M[t]};case 1:return n?function(t){return D[t>>1]}:function(t){return P[t>>1]};case 2:return n?function(t){return I[t>>2]}:function(t){return F[t>>2]};default:throw new TypeError("Unknown integer type: "+t)}}var rn="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function sn(t,e){k(t%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");for(var n=t,i=n>>1,r=i+e/2;!(i>=r)&&P[i];)++i;if((n=i<<1)-t>32&&rn)return rn.decode(M.subarray(t,n));for(var s="",o=0;!(o>=e/2);++o){var a=D[t+2*o>>1];if(0==a)break;s+=String.fromCharCode(a)}return s}function on(t,e,n){if(k(e%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!"),k("number"==typeof n,"stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),void 0===n&&(n=2147483647),n<2)return 0;for(var i=e,r=(n-=2)<2*t.length?n/2:t.length,s=0;s<r;++s){var o=t.charCodeAt(s);D[e>>1]=o,e+=2}return D[e>>1]=0,e-i}function an(t){return 2*t.length}function ln(t,e){k(t%4==0,"Pointer passed to UTF32ToString must be aligned to four bytes!");for(var n=0,i="";!(n>=e/4);){var r=I[t+4*n>>2];if(0==r)break;if(++n,r>=65536){var s=r-65536;i+=String.fromCharCode(55296|s>>10,56320|1023&s)}else i+=String.fromCharCode(r)}return i}function cn(t,e,n){if(k(e%4==0,"Pointer passed to stringToUTF32 must be aligned to four bytes!"),k("number"==typeof n,"stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),void 0===n&&(n=2147483647),n<4)return 0;for(var i=e,r=i+n-4,s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++s)),I[e>>2]=o,(e+=4)+4>r)break}return I[e>>2]=0,e-i}function un(t){for(var e=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=55296&&i<=57343&&++n,e+=4}return e}function hn(t){return t%4==0&&(t%100!=0||t%400==0)}var dn=[0,31,60,91,121,152,182,213,244,274,305,335],pn=[0,31,59,90,120,151,181,212,243,273,304,334];function mn(t){var e=W(t)+1,n=kn(e);return n&&$(t,O,n,e),n}function fn(t){var e=E.buffer;try{return E.grow(t-e.byteLength+65535>>>16),z(),1}catch(Jo){A("emscripten_realloc_buffer: Attempted to grow heap from "+e.byteLength+" bytes to "+t+" bytes, but got error: "+Jo)}}var gn={};function _n(){if(!_n.strings){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:o||"./this.program"};for(var e in gn)void 0===gn[e]?delete t[e]:t[e]=gn[e];var n=[];for(var e in t)n.push(e+"="+t[e]);_n.strings=n}return _n.strings}function vn(t,e){if(C=t,function(){var t=x,e=A,n=!1;x=A=t=>{n=!0};try{Dn(0),["stdout","stderr"].forEach((function(t){var e=Ft.analyzePath("/dev/"+t);if(e){var i=e.object.rdev,r=kt.ttys[i];r&&r.output&&r.output.length&&(n=!0)}}))}catch(Jo){}x=t,A=e,n&&Et("stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the FAQ), or make sure to emit a newline when you printf etc.")}(),!e){var i="program exited (with status: "+t+"), but keepRuntimeAlive() is set (counter="+Z+") due to an async operation, so halting execution but not exiting the runtime or preventing further async execution (you can use emscripten_force_exit, if you want to force a true shutdown)";n(i),A(i)}var r;C=r=t,a(r,new wt(r))}var yn=vn,wn=[31,29,31,30,31,30,31,31,30,31,30,31],bn=[31,28,31,30,31,30,31,31,30,31,30,31];function Tn(t,e,n,i){var r=I[i+40>>2],s={tm_sec:I[i>>2],tm_min:I[i+4>>2],tm_hour:I[i+8>>2],tm_mday:I[i+12>>2],tm_mon:I[i+16>>2],tm_year:I[i+20>>2],tm_wday:I[i+24>>2],tm_yday:I[i+28>>2],tm_isdst:I[i+32>>2],tm_gmtoff:I[i+36>>2],tm_zone:r?B(r):""},o=B(n),a={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var l in a)o=o.replace(new RegExp(l,"g"),a[l]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],u=["January","February","March","April","May","June","July","August","September","October","November","December"];function h(t,e,n){for(var i="number"==typeof t?t.toString():t||"";i.length<e;)i=n[0]+i;return i}function d(t,e){return h(t,e,"0")}function p(t,e){function n(t){return t<0?-1:t>0?1:0}var i;return 0===(i=n(t.getFullYear()-e.getFullYear()))&&0===(i=n(t.getMonth()-e.getMonth()))&&(i=n(t.getDate()-e.getDate())),i}function m(t){switch(t.getDay()){case 0:return new Date(t.getFullYear()-1,11,29);case 1:return t;case 2:return new Date(t.getFullYear(),0,3);case 3:return new Date(t.getFullYear(),0,2);case 4:return new Date(t.getFullYear(),0,1);case 5:return new Date(t.getFullYear()-1,11,31);case 6:return new Date(t.getFullYear()-1,11,30)}}function f(t){var e=function(t,e){for(var n=new Date(t.getTime());e>0;){var i=hn(n.getFullYear()),r=n.getMonth(),s=(i?wn:bn)[r];if(!(e>s-n.getDate()))return n.setDate(n.getDate()+e),n;e-=s-n.getDate()+1,n.setDate(1),r<11?n.setMonth(r+1):(n.setMonth(0),n.setFullYear(n.getFullYear()+1))}return n}(new Date(t.tm_year+1900,0,1),t.tm_yday),n=new Date(e.getFullYear(),0,4),i=new Date(e.getFullYear()+1,0,4),r=m(n),s=m(i);return p(r,e)<=0?p(s,e)<=0?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var g={"%a":function(t){return c[t.tm_wday].substring(0,3)},"%A":function(t){return c[t.tm_wday]},"%b":function(t){return u[t.tm_mon].substring(0,3)},"%B":function(t){return u[t.tm_mon]},"%C":function(t){return d((t.tm_year+1900)/100|0,2)},"%d":function(t){return d(t.tm_mday,2)},"%e":function(t){return h(t.tm_mday,2," ")},"%g":function(t){return f(t).toString().substring(2)},"%G":function(t){return f(t)},"%H":function(t){return d(t.tm_hour,2)},"%I":function(t){var e=t.tm_hour;return 0==e?e=12:e>12&&(e-=12),d(e,2)},"%j":function(t){return d(t.tm_mday+function(t,e){for(var n=0,i=0;i<=e;n+=t[i++]);return n}(hn(t.tm_year+1900)?wn:bn,t.tm_mon-1),3)},"%m":function(t){return d(t.tm_mon+1,2)},"%M":function(t){return d(t.tm_min,2)},"%n":function(){return"\n"},"%p":function(t){return t.tm_hour>=0&&t.tm_hour<12?"AM":"PM"},"%S":function(t){return d(t.tm_sec,2)},"%t":function(){return"\t"},"%u":function(t){return t.tm_wday||7},"%U":function(t){var e=t.tm_yday+7-t.tm_wday;return d(Math.floor(e/7),2)},"%V":function(t){var e=Math.floor((t.tm_yday+7-(t.tm_wday+6)%7)/7);if((t.tm_wday+371-t.tm_yday-2)%7<=2&&e++,e){if(53==e){var n=(t.tm_wday+371-t.tm_yday)%7;4==n||3==n&&hn(t.tm_year)||(e=1)}}else{e=52;var i=(t.tm_wday+7-t.tm_yday-1)%7;(4==i||5==i&&hn(t.tm_year%400-1))&&e++}return d(e,2)},"%w":function(t){return t.tm_wday},"%W":function(t){var e=t.tm_yday+7-(t.tm_wday+6)%7;return d(Math.floor(e/7),2)},"%y":function(t){return(t.tm_year+1900).toString().substring(2)},"%Y":function(t){return t.tm_year+1900},"%z":function(t){var e=t.tm_gmtoff,n=e>=0;return e=(e=Math.abs(e)/60)/60*100+e%60,(n?"+":"-")+String("0000"+e).slice(-4)},"%Z":function(t){return t.tm_zone},"%%":function(){return"%"}};for(var l in o=o.replace(/%%/g,"\0\0"),g)o.includes(l)&&(o=o.replace(new RegExp(l,"g"),g[l](s)));var _,v,y=St(o=o.replace(/\0\0/g,"%"),!1);return y.length>e?0:(v=t,k((_=y).length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),O.set(_,v),y.length-1)}var En=function(t,e,n,i){t||(t=this),this.parent=t,this.mount=t.mount,this.mounted=null,this.id=Ft.nextInode++,this.name=e,this.mode=n,this.node_ops={},this.stream_ops={},this.rdev=i},xn=365,An=146;Object.defineProperties(En.prototype,{read:{get:function(){return(this.mode&xn)===xn},set:function(t){t?this.mode|=xn:this.mode&=-366}},write:{get:function(){return(this.mode&An)===An},set:function(t){t?this.mode|=An:this.mode&=-147}},isFolder:{get:function(){return Ft.isDir(this.mode)}},isDevice:{get:function(){return Ft.isChrdev(this.mode)}}}),Ft.FSNode=En,Ft.staticInit(),i.FS_createPath=Ft.createPath,i.FS_createDataFile=Ft.createDataFile,i.FS_createPreloadedFile=Ft.createPreloadedFile,i.FS_unlink=Ft.unlink,i.FS_createLazyFile=Ft.createLazyFile,i.FS_createDevice=Ft.createDevice,Pt={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135},Gt=i.InternalError=Ht(Error,"InternalError"),function(){for(var t=new Array(256),e=0;e<256;++e)t[e]=String.fromCharCode(e);Kt=t}(),Qt=i.BindingError=Ht(Error,"BindingError"),Ae.prototype.isAliasOf=ne,Ae.prototype.clone=be,Ae.prototype.delete=Te,Ae.prototype.isDeleted=Ee,Ae.prototype.deleteLater=xe,i.getInheritedInstanceCount=ue,i.getLiveInheritedInstances=he,i.flushPendingDeletes=pe,i.setDelayFunction=fe,Ne.prototype.getPointee=Ie,Ne.prototype.destructor=Fe,Ne.prototype.argPackAdvance=8,Ne.prototype.readValueFromPointer=jt,Ne.prototype.deleteObject=Re,Ne.prototype.fromWireType=ye,$e=i.UnboundTypeError=Ht(Error,"UnboundTypeError"),i.count_emval_handles=Xe,i.get_first_emval=Ze;var Cn={__cxa_throw:function(t,e,n){throw new xt(t).init(e,n),t+" - Exception catching is disabled, this exception cannot be caught. Compile with -sNO_DISABLE_EXCEPTION_CATCHING or -sEXCEPTION_CATCHING_ALLOWED=[..] to catch."},__syscall_dup3:function(t,e,n){try{var i=Rt.getStreamFromFD(t);if(k(!n),i.fd===e)return-28;var r=Ft.getStream(e);return r&&Ft.close(r),Ft.createStream(i,e,e+1).fd}catch(Jo){if(void 0===Ft||"ErrnoError"!==Jo.name)throw Jo;return-Jo.errno}},__syscall_fcntl64:function(t,e,n){Rt.varargs=n;try{var i=Rt.getStreamFromFD(t);switch(e){case 0:return(r=Rt.get())<0?-28:Ft.createStream(i,r).fd;case 1:case 2:case 6:case 7:return 0;case 3:return i.flags;case 4:var r=Rt.get();return i.flags|=r,0;case 5:return r=Rt.get(),D[r+0>>1]=2,0;case 16:case 8:default:return-28;case 9:return s=28,I[Mn()>>2]=s,-1}}catch(Jo){if(void 0===Ft||"ErrnoError"!==Jo.name)throw Jo;return-Jo.errno}var s},__syscall_ioctl:function(t,e,n){Rt.varargs=n;try{var i=Rt.getStreamFromFD(t);switch(e){case 21509:case 21505:case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:case 21523:case 21524:return i.tty?0:-59;case 21519:if(!i.tty)return-59;var r=Rt.get();return I[r>>2]=0,0;case 21520:return i.tty?-28:-59;case 21531:return r=Rt.get(),Ft.ioctl(i,e,r);default:return-28}}catch(Jo){if(void 0===Ft||"ErrnoError"!==Jo.name)throw Jo;return-Jo.errno}},__syscall_openat:function(t,e,n,i){Rt.varargs=i;try{e=Rt.getStr(e),e=Rt.calculateAt(t,e);var r=i?Rt.get():0;return Ft.open(e,n,r).fd}catch(Jo){if(void 0===Ft||"ErrnoError"!==Jo.name)throw Jo;return-Jo.errno}},_embind_finalize_value_object:function(t){var e=Nt[t];delete Nt[t];var n=e.rawConstructor,i=e.rawDestructor,r=e.fields;Xt([t],r.map((t=>t.getterReturnType)).concat(r.map((t=>t.setterArgumentType))),(t=>{var s={};return r.forEach(((e,n)=>{var i=e.fieldName,o=t[n],a=e.getter,l=e.getterContext,c=t[n+r.length],u=e.setter,h=e.setterContext;s[i]={read:t=>o.fromWireType(a(l,t)),write:(t,e)=>{var n=[];u(h,t,c.toWireType(n,e)),Lt(n)}}})),[{name:e.name,fromWireType:function(t){var e={};for(var n in s)e[n]=s[n].read(t);return i(t),e},toWireType:function(t,e){for(var r in s)if(!(r in e))throw new TypeError('Missing field:  "'+r+'"');var o=n();for(r in s)s[r].write(o,e[r]);return null!==t&&t.push(i,o),o},argPackAdvance:8,readValueFromPointer:jt,destructorFunction:i}]}))},_embind_register_bigint:function(t,e,n,i,r){},_embind_register_bool:function(t,e,n,i,r){var s=Zt(n);ee(t,{name:e=Jt(e),fromWireType:function(t){return!!t},toWireType:function(t,e){return e?i:r},argPackAdvance:8,readValueFromPointer:function(t){var i;if(1===n)i=O;else if(2===n)i=D;else{if(4!==n)throw new TypeError("Unknown boolean type size: "+e);i=I}return this.fromWireType(i[t>>s])},destructorFunction:null})},_embind_register_class:function(t,e,n,r,s,o,a,l,c,u,h,d,p){h=Jt(h),o=Be(s,o),l&&(l=Be(a,l)),u&&(u=Be(c,u)),p=Be(d,p);var m=Ut(h);Se(m,(function(){ze("Cannot construct "+h+" due to unbound types",[r])})),Xt([t,e,n],r?[r]:[],(function(e){var n,s;e=e[0],s=r?(n=e.registeredClass).instancePrototype:Ae.prototype;var a=qt(m,(function(){if(Object.getPrototypeOf(this)!==c)throw new Qt("Use 'new' to construct "+h);if(void 0===d.constructor_body)throw new Qt(h+" has no accessible constructor");var t=d.constructor_body[arguments.length];if(void 0===t)throw new Qt("Tried to invoke ctor of "+h+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(d.constructor_body).toString()+") parameters instead!");return t.apply(this,arguments)})),c=Object.create(s,{constructor:{value:a}});a.prototype=c;var d=new ke(h,a,c,p,n,o,l,u),f=new Ne(h,d,!0,!1,!1),g=new Ne(h+"*",d,!1,!1,!1),_=new Ne(h+" const*",d,!1,!0,!1);return ce[t]={pointerType:g,constPointerType:_},function(t,e,n){i.hasOwnProperty(t)||Yt("Replacing nonexistant public symbol"),void 0!==i[t].overloadTable&&void 0!==n||(i[t]=e,i[t].argCount=n)}(m,a),[f,g,_]}))},_embind_register_class_class_function:function(t,e,n,i,r,s,o,a){var l=qe(n,i);e=Jt(e),s=Be(r,s),Xt([],[t],(function(t){var i=(t=t[0]).name+"."+e;function r(){ze("Cannot call "+i+" due to unbound types",l)}e.startsWith("@@")&&(e=Symbol[e.substring(2)]);var c=t.registeredClass.constructor;return void 0===c[e]?(r.argCount=n-1,c[e]=r):(Ce(c,e,i),c[e].overloadTable[n-1]=r),Xt([],l,(function(t){var r=[t[0],null].concat(t.slice(1)),l=Ue(i,r,null,s,o,a);return void 0===c[e].overloadTable?(l.argCount=n-1,c[e]=l):c[e].overloadTable[n-1]=l,[]})),[]}))},_embind_register_class_constructor:function(t,e,n,i,r,s){k(e>0);var o=qe(e,n);r=Be(i,r),Xt([],[t],(function(t){var n="constructor "+(t=t[0]).name;if(void 0===t.registeredClass.constructor_body&&(t.registeredClass.constructor_body=[]),void 0!==t.registeredClass.constructor_body[e-1])throw new Qt("Cannot register multiple constructors with identical number of parameters ("+(e-1)+") for class '"+t.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return t.registeredClass.constructor_body[e-1]=()=>{ze("Cannot construct "+t.name+" due to unbound types",o)},Xt([],o,(function(i){return i.splice(1,0,null),t.registeredClass.constructor_body[e-1]=Ue(n,i,null,r,s),[]})),[]}))},_embind_register_class_function:function(t,e,n,i,r,s,o,a,l){var c=qe(n,i);e=Jt(e),s=Be(r,s),Xt([],[t],(function(t){var i=(t=t[0]).name+"."+e;function r(){ze("Cannot call "+i+" due to unbound types",c)}e.startsWith("@@")&&(e=Symbol[e.substring(2)]),a&&t.registeredClass.pureVirtualFunctions.push(e);var u=t.registeredClass.instancePrototype,h=u[e];return void 0===h||void 0===h.overloadTable&&h.className!==t.name&&h.argCount===n-2?(r.argCount=n-2,r.className=t.name,u[e]=r):(Ce(u,e,i),u[e].overloadTable[n-2]=r),Xt([],c,(function(r){var a=Ue(i,r,t,s,o,l);return void 0===u[e].overloadTable?(a.argCount=n-2,u[e]=a):u[e].overloadTable[n-2]=a,[]})),[]}))},_embind_register_emval:function(t,e){ee(t,{name:e=Jt(e),fromWireType:function(t){var e=Ke.toValue(t);return Ye(t),e},toWireType:function(t,e){return Ke.toHandle(e)},argPackAdvance:8,readValueFromPointer:jt,destructorFunction:null})},_embind_register_enum:function(t,e,n,i){var r=Zt(n);function s(){}e=Jt(e),s.values={},ee(t,{name:e,constructor:s,fromWireType:function(t){return this.constructor.values[t]},toWireType:function(t,e){return e.value},argPackAdvance:8,readValueFromPointer:Je(e,r,i),destructorFunction:null}),Se(e,s)},_embind_register_enum_value:function(t,e,n){var i=Qe(t,"enum");e=Jt(e);var r=i.constructor,s=Object.create(i.constructor.prototype,{value:{value:n},constructor:{value:qt(i.name+"_"+e,(function(){}))}});r.values[n]=s,r[e]=s},_embind_register_float:function(t,e,n){var i=Zt(n);ee(t,{name:e=Jt(e),fromWireType:function(t){return t},toWireType:function(t,e){if("number"!=typeof e&&"boolean"!=typeof e)throw new TypeError('Cannot convert "'+tn(e)+'" to '+this.name);return e},argPackAdvance:8,readValueFromPointer:en(e,i),destructorFunction:null})},_embind_register_integer:function(t,e,n,i,r){e=Jt(e),-1===r&&(r=4294967295);var s=Zt(n),o=t=>t;if(0===i){var a=32-8*n;o=t=>t<<a>>>a}var l=e.includes("unsigned"),c=(t,n)=>{if("number"!=typeof t&&"boolean"!=typeof t)throw new TypeError('Cannot convert "'+tn(t)+'" to '+n);if(t<i||t>r)throw new TypeError('Passing a number "'+tn(t)+'" from JS side to C/C++ side to an argument of type "'+e+'", which is outside the valid range ['+i+", "+r+"]!")};ee(t,{name:e,fromWireType:o,toWireType:l?function(t,e){return c(e,this.name),e>>>0}:function(t,e){return c(e,this.name),e},argPackAdvance:8,readValueFromPointer:nn(e,s,0!==i),destructorFunction:null})},_embind_register_memory_view:function(t,e,n){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][e];function r(t){var e=F,n=e[t>>=2],r=e[t+1];return new i(e.buffer,r,n)}ee(t,{name:n=Jt(n),fromWireType:r,argPackAdvance:8,readValueFromPointer:r},{ignoreDuplicateRegistrations:!0})},_embind_register_std_string:function(t,e){var n="std::string"===(e=Jt(e));ee(t,{name:e,fromWireType:function(t){var e,i=F[t>>2],r=t+4;if(n)for(var s=r,o=0;o<=i;++o){var a=r+o;if(o==i||0==M[a]){var l=B(s,a-s);void 0===e?e=l:(e+=String.fromCharCode(0),e+=l),s=a+1}}else{var c=new Array(i);for(o=0;o<i;++o)c[o]=String.fromCharCode(M[r+o]);e=c.join("")}return On(t),e},toWireType:function(t,e){var i;e instanceof ArrayBuffer&&(e=new Uint8Array(e));var r="string"==typeof e;r||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||te("Cannot pass non-string to std::string"),i=n&&r?W(e):e.length;var s,o,a,l=kn(4+i+1),c=l+4;if(F[l>>2]=i,n&&r)s=e,o=c,k("number"==typeof(a=i+1),"stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),$(s,M,o,a);else if(r)for(var u=0;u<i;++u){var h=e.charCodeAt(u);h>255&&(On(c),te("String has UTF-16 code units that do not fit in 8 bits")),M[c+u]=h}else for(u=0;u<i;++u)M[c+u]=e[u];return null!==t&&t.push(On,l),l},argPackAdvance:8,readValueFromPointer:jt,destructorFunction:function(t){On(t)}})},_embind_register_std_wstring:function(t,e,n){var i,r,s,o,a;n=Jt(n),2===e?(i=sn,r=on,o=an,s=()=>P,a=1):4===e&&(i=ln,r=cn,o=un,s=()=>F,a=2),ee(t,{name:n,fromWireType:function(t){for(var n,r=F[t>>2],o=s(),l=t+4,c=0;c<=r;++c){var u=t+4+c*e;if(c==r||0==o[u>>a]){var h=i(l,u-l);void 0===n?n=h:(n+=String.fromCharCode(0),n+=h),l=u+e}}return On(t),n},toWireType:function(t,i){"string"!=typeof i&&te("Cannot pass non-string to C++ string type "+n);var s=o(i),l=kn(4+s+e);return F[l>>2]=s>>a,r(i,l+4,s+e),null!==t&&t.push(On,l),l},argPackAdvance:8,readValueFromPointer:jt,destructorFunction:function(t){On(t)}})},_embind_register_value_object:function(t,e,n,i,r,s){Nt[t]={name:Jt(e),rawConstructor:Be(n,i),rawDestructor:Be(r,s),fields:[]}},_embind_register_value_object_field:function(t,e,n,i,r,s,o,a,l,c){Nt[t].fields.push({fieldName:Jt(e),getterReturnType:n,getter:Be(i,r),getterContext:s,setterArgumentType:o,setter:Be(a,l),setterContext:c})},_embind_register_void:function(t,e){ee(t,{isVoid:!0,name:e=Jt(e),argPackAdvance:0,fromWireType:function(){},toWireType:function(t,e){}})},_emscripten_throw_longjmp:function(){throw 1/0},_emval_decref:Ye,_emval_incref:function(t){t>4&&(Ge[t].refcount+=1)},_emval_take_value:function(t,e){var n=(t=Qe(t,"_emval_take_value")).readValueFromPointer(e);return Ke.toHandle(n)},_localtime_js:function(t,e){var n,i=new Date(1e3*(F[(n=t)>>2]+4294967296*I[n+4>>2]));I[e>>2]=i.getSeconds(),I[e+4>>2]=i.getMinutes(),I[e+8>>2]=i.getHours(),I[e+12>>2]=i.getDate(),I[e+16>>2]=i.getMonth(),I[e+20>>2]=i.getFullYear()-1900,I[e+24>>2]=i.getDay();var r=0|function(t){return(hn(t.getFullYear())?dn:pn)[t.getMonth()]+t.getDate()-1}(i);I[e+28>>2]=r,I[e+36>>2]=-60*i.getTimezoneOffset();var s=new Date(i.getFullYear(),0,1),o=new Date(i.getFullYear(),6,1).getTimezoneOffset(),a=s.getTimezoneOffset(),l=0|(o!=a&&i.getTimezoneOffset()==Math.min(a,o));I[e+32>>2]=l},_tzset_js:function(t,e,n){var i=(new Date).getFullYear(),r=new Date(i,0,1),s=new Date(i,6,1),o=r.getTimezoneOffset(),a=s.getTimezoneOffset(),l=Math.max(o,a);function c(t){var e=t.toTimeString().match(/\(([A-Za-z ]+)\)$/);return e?e[1]:"GMT"}F[t>>2]=60*l,I[e>>2]=Number(o!=a);var u=c(r),h=c(s),d=mn(u),p=mn(h);a<o?(F[n>>2]=d,F[n+4>>2]=p):(F[n>>2]=p,F[n+4>>2]=d)},abort:function(){rt("native code called abort()")},dlopen:function(t){rt("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},emscripten_date_now:function(){return Date.now()},emscripten_get_heap_max:function(){return 2147483648},emscripten_memcpy_big:function(t,e,n){M.copyWithin(t,e,e+n)},emscripten_resize_heap:function(t){var e=M.length;k((t>>>=0)>e);var n,i,r=2147483648;if(t>r)return A("Cannot enlarge memory, asked to go up to "+t+" bytes, but the limit is "+r+" bytes!"),!1;for(var s=1;s<=4;s*=2){var o=e*(1+.2/s);o=Math.min(o,t+100663296);var a=Math.min(r,(n=Math.max(t,o))+((i=65536)-n%i)%i);if(fn(a))return!0}return A("Failed to grow the heap from "+e+" bytes to "+a+" bytes, not enough memory!"),!1},environ_get:function(t,e){var n=0;return _n().forEach((function(i,r){var s=e+n;F[t+4*r>>2]=s,function(t,e,n){for(var i=0;i<t.length;++i)k(t.charCodeAt(i)===(255&t.charCodeAt(i))),O[e++>>0]=t.charCodeAt(i);O[e>>0]=0}(i,s),n+=i.length+1})),0},environ_sizes_get:function(t,e){var n=_n();F[t>>2]=n.length;var i=0;return n.forEach((function(t){i+=t.length+1})),F[e>>2]=i,0},exit:yn,fd_close:function(t){try{var e=Rt.getStreamFromFD(t);return Ft.close(e),0}catch(Jo){if(void 0===Ft||"ErrnoError"!==Jo.name)throw Jo;return Jo.errno}},fd_read:function(t,e,n,i){try{var r=function(t,e,n,i){for(var r=0,s=0;s<n;s++){var o=F[e>>2],a=F[e+4>>2];e+=8;var l=Ft.read(t,O,o,a,i);if(l<0)return-1;if(r+=l,l<a)break}return r}(Rt.getStreamFromFD(t),e,n);return F[i>>2]=r,0}catch(Jo){if(void 0===Ft||"ErrnoError"!==Jo.name)throw Jo;return Jo.errno}},fd_seek:function(t,e,n,i,r){try{var s=(l=n,k((a=e)==a>>>0||a==(0|a)),k(l===(0|l)),l+2097152>>>0<4194305-!!a?(a>>>0)+4294967296*l:NaN);if(isNaN(s))return 61;var o=Rt.getStreamFromFD(t);return Ft.llseek(o,s,i),lt=[o.position>>>0,(at=o.position,+Math.abs(at)>=1?at>0?(0|Math.min(+Math.floor(at/4294967296),4294967295))>>>0:~~+Math.ceil((at-+(~~at>>>0))/4294967296)>>>0:0)],I[r>>2]=lt[0],I[r+4>>2]=lt[1],o.getdents&&0===s&&0===i&&(o.getdents=null),0}catch(Jo){if(void 0===Ft||"ErrnoError"!==Jo.name)throw Jo;return Jo.errno}var a,l},fd_write:function(t,e,n,i){try{var r=function(t,e,n,i){for(var r=0,s=0;s<n;s++){var o=F[e>>2],a=F[e+4>>2];e+=8;var l=Ft.write(t,O,o,a,i);if(l<0)return-1;r+=l}return r}(Rt.getStreamFromFD(t),e,n);return F[i>>2]=r,0}catch(Jo){if(void 0===Ft||"ErrnoError"!==Jo.name)throw Jo;return Jo.errno}},invoke_i:function(t){var e=Ln();try{return je(t)()}catch(Jo){if(jn(e),Jo!==Jo+0)throw Jo;Fn(1,0)}},invoke_ii:function(t,e){var n=Ln();try{return je(t)(e)}catch(Jo){if(jn(n),Jo!==Jo+0)throw Jo;Fn(1,0)}},invoke_iii:function(t,e,n){var i=Ln();try{return je(t)(e,n)}catch(Jo){if(jn(i),Jo!==Jo+0)throw Jo;Fn(1,0)}},invoke_iiiiiii:function(t,e,n,i,r,s,o){var a=Ln();try{return je(t)(e,n,i,r,s,o)}catch(Jo){if(jn(a),Jo!==Jo+0)throw Jo;Fn(1,0)}},invoke_vi:function(t,e){var n=Ln();try{je(t)(e)}catch(Jo){if(jn(n),Jo!==Jo+0)throw Jo;Fn(1,0)}},invoke_vii:function(t,e,n){var i=Ln();try{je(t)(e,n)}catch(Jo){if(jn(i),Jo!==Jo+0)throw Jo;Fn(1,0)}},invoke_viii:function(t,e,n,i){var r=Ln();try{je(t)(e,n,i)}catch(Jo){if(jn(r),Jo!==Jo+0)throw Jo;Fn(1,0)}},invoke_viiii:function(t,e,n,i,r){var s=Ln();try{je(t)(e,n,i,r)}catch(Jo){if(jn(s),Jo!==Jo+0)throw Jo;Fn(1,0)}},invoke_viiiii:function(t,e,n,i,r,s){var o=Ln();try{je(t)(e,n,i,r,s)}catch(Jo){if(jn(o),Jo!==Jo+0)throw Jo;Fn(1,0)}},invoke_viiiiii:function(t,e,n,i,r,s,o){var a=Ln();try{je(t)(e,n,i,r,s,o)}catch(Jo){if(jn(a),Jo!==Jo+0)throw Jo;Fn(1,0)}},strftime_l:function(t,e,n,i,r){return Tn(t,e,n,i)}};!function(){var t={env:Cn,wasi_snapshot_preview1:Cn};function e(t,e){var n,r=t.exports;return i.asm=r,k(E=i.asm.memory,"memory not found in wasm exports"),z(),k(L=i.asm.__indirect_function_table,"table not found in wasm exports"),n=i.asm.__wasm_call_ctors,H.unshift(n),it("wasm-instantiate"),r}nt("wasm-instantiate");var r,s,o,a,l=i;if(i.instantiateWasm)try{return i.instantiateWasm(t,e)}catch(Jo){A("Module.instantiateWasm callback failed with error: "+Jo),n(Jo)}(r=T,s=st,o=t,a=function(t){k(i===l,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),l=null,e(t.instance)},r||"function"!=typeof WebAssembly.instantiateStreaming||dt(s)||pt(s)||u||"function"!=typeof fetch?gt(s,o,a):fetch(s,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,o).then(a,(function(t){return A("wasm streaming compile failed: "+t),A("falling back to ArrayBuffer instantiation"),gt(s,o,a)}))}))).catch(n)}();var Sn=i._main=mt("__main_argc_argv"),kn=mt("malloc"),On=mt("free"),Mn=mt("__errno_location"),Dn=i._fflush=mt("fflush"),Pn=i.___getTypeName=mt("__getTypeName");i.__embind_initialize_bindings=mt("_embind_initialize_bindings");var In,Fn=mt("setThrew"),Rn=function(){return(Rn=i.asm.emscripten_stack_init).apply(null,arguments)},Nn=function(){return(Nn=i.asm.emscripten_stack_get_end).apply(null,arguments)},Ln=mt("stackSave"),jn=mt("stackRestore"),Vn=mt("stackAlloc"),Bn=function(){return(Bn=i.asm.emscripten_stack_get_current).apply(null,arguments)},$n=mt("__cxa_is_pointer_type");function Wn(t=[]){k(0==K,'cannot call main when async dependencies remain! (listen on Module["onRuntimeInitialized"])'),k(0==q.length,"cannot call main when preRun functions remain to be called");var e=Sn;t.unshift(o);var n=t.length,i=Vn(4*(n+1)),r=i>>2;t.forEach((t=>{I[r++]=function(t){var e=W(t)+1,n=Vn(e);return $(t,O,n,e),n}(t)})),I[r]=0;try{var s=e(n,i);return vn(s,!0),s}catch(Jo){return function(t){if(t instanceof wt||"unwind"==t)return C;U(),t instanceof WebAssembly.RuntimeError&&Bn()<=0&&A("Stack overflow detected.  You can try increasing -sSTACK_SIZE (currently set to 65536)"),a(1,t)}(Jo)}}function zn(){var t;Rn(),k(0==(3&(t=Nn()))),0==t&&(t+=4),F[t>>2]=34821223,F[t+4>>2]=2310721022,F[0]=1668509029}function Un(t=s){function n(){In||(In=!0,i.calledRun=!0,S||(k(!X),X=!0,U(),i.noFSInit||Ft.init.initialized||Ft.init(),Ft.ignorePermissions=!1,bt(H),U(),bt(G),e(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),qn&&Wn(t),function(){if(U(),i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)t=i.postRun.shift(),Y.unshift(t);var t;bt(Y)}()))}K>0||(zn(),function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)t=i.preRun.shift(),q.unshift(t);var t;bt(q)}(),K>0||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1),n()}),1)):n(),U()))}if(i.dynCall_jiji=mt("dynCall_jiji"),i.dynCall_viijii=mt("dynCall_viijii"),i.dynCall_iiiiij=mt("dynCall_iiiiij"),i.dynCall_iiiiijj=mt("dynCall_iiiiijj"),i.dynCall_iiiiiijj=mt("dynCall_iiiiiijj"),i.addRunDependency=nt,i.removeRunDependency=it,i.FS_createPath=Ft.createPath,i.FS_createDataFile=Ft.createDataFile,i.FS_createPreloadedFile=Ft.createPreloadedFile,i.FS_createLazyFile=Ft.createLazyFile,i.FS_createDevice=Ft.createDevice,i.FS_unlink=Ft.unlink,i.FS=Ft,i.MEMFS=Mt,["stringToNewUTF8","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","getHostByName","traverseStack","convertPCtoSourceLocation","readEmAsmArgs","jstoi_q","jstoi_s","listenOnce","autoResumeAudioContext","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","safeSetTimeout","asmjsMangle","HandleAllocator","getNativeTypeSize","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromU64","convertI32PairToI53","convertU32PairToI53","getCFunc","ccall","cwrap","uleb128Encode","sigToWasmTypes","generateFuncType","convertJsFunctionToWasm","getEmptyTableSlot","updateTableMap","getFunctionAddress","addFunction","removeFunction","reallyNegative","unSign","strLen","reSign","formatString","intArrayToString","AsciiToString","stringToAscii","writeStringToMemory","getSocketFromFD","getSocketAddress","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","findCanvasEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","jsStackTrace","stackTrace","checkWasiClock","createDyncallWrapper","setImmediateWrapped","clearImmediateWrapped","polyfillSetImmediate","getPromise","makePromise","makePromiseCallback","exception_addRef","exception_decRef","setMainLoop","_setNetworkCallback","heapObjectForWebGLType","heapAccessShiftForWebGLHeap","emscriptenWebGLGet","computeUnpackAlignedImageSize","emscriptenWebGLGetTexPixelData","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","writeGLArray","SDL_unicode","SDL_ttfContext","SDL_audio","GLFW_Window","runAndAbortIfError","ALLOC_NORMAL","ALLOC_STACK","allocate","registerInheritedInstance","unregisterInheritedInstance","validateThis","getStringOrSymbol","craftEmvalAllocator","emval_get_global","emval_lookupTypes","emval_allocateDestructors","emval_addMethodCaller"].forEach((function(t){"undefined"==typeof globalThis||Object.getOwnPropertyDescriptor(globalThis,t)||Object.defineProperty(globalThis,t,{configurable:!0,get:function(){var e="`"+t+"` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line",n=t;n.startsWith("_")||(n="$"+t),e+=" (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE="+n+")",vt(t)&&(e+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),Et(e)}}),yt(t)})),["run","UTF8ArrayToString","UTF8ToString","stringToUTF8Array","stringToUTF8","lengthBytesUTF8","addOnPreRun","addOnInit","addOnPreMain","addOnExit","addOnPostRun","FS_createFolder","FS_createLink","out","err","callMain","abort","keepRuntimeAlive","wasmMemory","stackAlloc","stackSave","stackRestore","getTempRet0","setTempRet0","writeStackCookie","checkStackCookie","ptrToString","zeroMemory","exitJS","getHeapMax","emscripten_realloc_buffer","ENV","ERRNO_CODES","ERRNO_MESSAGES","setErrNo","DNS","Protocols","Sockets","getRandomDevice","timers","warnOnce","UNWIND_CACHE","readEmAsmArgsArray","getExecutableName","dynCallLegacy","getDynCaller","dynCall","handleException","asyncLoad","alignMemory","mmapAlloc","readI53FromI64","convertI32PairToI53Checked","freeTableIndexes","functionsInTableMap","setValue","getValue","PATH","PATH_FS","intArrayFromString","UTF16Decoder","UTF16ToString","stringToUTF16","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","allocateUTF8","allocateUTF8OnStack","writeArrayToMemory","writeAsciiToMemory","SYSCALLS","JSEvents","specialHTMLTargets","currentFullscreenStrategy","restoreOldWindowedStyle","demangle","demangleAll","ExitStatus","getEnvStrings","doReadv","doWritev","dlopenMissingError","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","ExceptionInfo","Browser","wget","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","GL","AL","SDL","SDL_gfx","GLUT","EGL","GLFW","GLEW","IDBStore","InternalError","BindingError","UnboundTypeError","PureVirtualError","init_embind","throwInternalError","throwBindingError","throwUnboundTypeError","ensureOverloadTable","exposePublicSymbol","replacePublicSymbol","extendError","createNamedFunction","embindRepr","registeredInstances","getBasestPointer","getInheritedInstance","getInheritedInstanceCount","getLiveInheritedInstances","registeredTypes","awaitingDependencies","typeDependencies","registeredPointers","registerType","whenDependentTypesAreResolved","embind_charCodes","embind_init_charCodes","readLatin1String","getTypeName","heap32VectorToArray","requireRegisteredType","getShiftFromSize","integerReadValueFromPointer","enumReadValueFromPointer","floatReadValueFromPointer","simpleReadValueFromPointer","runDestructors","new_","craftInvokerFunction","embind__requireFunction","tupleRegistrations","structRegistrations","genericPointerToWireType","constNoSmartPtrRawPointerToWireType","nonConstNoSmartPtrRawPointerToWireType","init_RegisteredPointer","RegisteredPointer","RegisteredPointer_getPointee","RegisteredPointer_destructor","RegisteredPointer_deleteObject","RegisteredPointer_fromWireType","runDestructor","releaseClassHandle","finalizationRegistry","detachFinalizer_deps","detachFinalizer","attachFinalizer","makeClassHandle","init_ClassHandle","ClassHandle","ClassHandle_isAliasOf","throwInstanceAlreadyDeleted","ClassHandle_clone","ClassHandle_delete","deletionQueue","ClassHandle_isDeleted","ClassHandle_deleteLater","flushPendingDeletes","delayFunction","setDelayFunction","RegisteredClass","shallowCopyInternalPointer","downcastPointer","upcastPointer","char_0","char_9","makeLegalFunctionName","emval_handle_array","emval_free_list","emval_symbols","init_emval","count_emval_handles","get_first_emval","Emval","emval_newers","emval_methodCallers","emval_registeredMethods"].forEach(yt),Q=function t(){In||Un(),In||(Q=t)},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();var qn=!0;return i.noInitialRun&&(qn=!1),Un(),t.ready});const Pa=await Da();Pa.FS.mkdir("/working"),Pa.FS.mount(Pa.MEMFS,{root:"."},"/working");let Ia=new class{constructor(){this.mujoco=Pa,document.addEventListener("pointerdown",(()=>{"running"!==Xo.state&&Xo.resume()})),this.params={scene:"unitree_go2/scene.xml",song:"turkish_march_actions.npy",paused:!1,songPaused:!1,help:!1,ctrlnoiserate:0,ctrlnoisestd:0,keyframeNumber:0},this.mujoco_time=0,this.bodies={},this.lights={},this.tmpVec=new e,this.tmpQuat=new s,this.updateGUICallbacks=[],this.controlFrameNumber=0,this.container=document.createElement("div"),document.body.appendChild(this.container),this.scene=new N,this.scene.name="scene",this.camera=new p(45,window.innerWidth/window.innerHeight,.001,100),this.camera.name="PerspectiveCamera",this.scene.add(this.camera),this.ambientLight=new L(16777215,.1),this.ambientLight.name="AmbientLight",this.scene.add(this.ambientLight),this.renderer=new j({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=V,this.renderer.setAnimationLoop(this.render.bind(this)),this.container.appendChild(this.renderer.domElement),this.controls=new _a(this.camera,this.renderer.domElement),this.controls.panSpeed=2,this.controls.zoomSpeed=1,this.controls.enableDamping=!0,this.controls.dampingFactor=.1,this.controls.screenSpacePanning=!0,this.controls.update(),this.prevActivated=new Array(88).fill(!1),this.sampler=new zo({urls:{A1:"A1.mp3",A2:"A2.mp3",A3:"A3.mp3",A4:"A4.mp3",A5:"A5.mp3",A6:"A6.mp3",A7:"A7.mp3",C1:"C1.mp3",C2:"C2.mp3",C3:"C3.mp3",C4:"C4.mp3",C5:"C5.mp3",C6:"C6.mp3",C7:"C7.mp3",C8:"C8.mp3","D#1":"Ds1.mp3","D#2":"Ds2.mp3","D#3":"Ds3.mp3","D#4":"Ds4.mp3","D#5":"Ds5.mp3","D#6":"Ds6.mp3","D#7":"Ds7.mp3","F#1":"Fs1.mp3","F#2":"Fs2.mp3","F#3":"Fs3.mp3","F#4":"Fs4.mp3","F#5":"Fs5.mp3","F#6":"Fs6.mp3","F#7":"Fs7.mp3"},baseUrl:"https://tonejs.github.io/audio/salamander/"}).toDestination(),window.addEventListener("resize",this.onWindowResize.bind(this)),this.dragStateManager=new va(this.scene,this.renderer,this.camera,this.container.parentElement,this.controls),this.initEnhancements()}initEnhancements(){this.motionFilters={leftHand:B({windowSize:15}),rightHand:B({windowSize:15}),go2Robot:B({windowSize:20}),piano:B({windowSize:12})},this.phaseSync=$({Kp:W("Kp",.5),Ki:W("Ki",.1)}),this.enhancements={filterEnabled:W("filter",!0),syncEnabled:W("sync",!0),dynamicsEnabled:W("dynamics",!0)},this.performanceMetrics={frameCount:0,errorSum:0,phaseJitter:[],startTime:Date.now()}}setupEnhancementGUI(){const t=this.gui.addFolder(" Enhancements"),e=t.addFolder("Motion Filter");e.add(this.enhancements,"filterEnabled").name("Enable Filter");const n={windowSize:15,gain:.9,noiseSigma:.005};e.add(n,"windowSize",5,32,1).name("Window Size").onChange((t=>{Object.values(this.motionFilters).forEach((e=>{e.opts&&(e.opts.windowSize=t)}))})),e.add(n,"gain",.1,.99,.01).name("Filter Gain").onChange((t=>{Object.values(this.motionFilters).forEach((e=>{e.opts&&(e.opts.gain=t)}))}));const i=t.addFolder("Tempo Sync");i.add(this.enhancements,"syncEnabled").name("Enable Sync"),i.add(this.phaseSync.config,"Kp",0,2,.01).name("P Gain"),i.add(this.phaseSync.config,"Ki",0,1,.01).name("I Gain");const r=t.addFolder("Expressive Dynamics");r.add(this.enhancements,"dynamicsEnabled").name("Enable Dynamics"),this.dynamicsParams={rubato:W("rubato",.06),velocityScale:W("velscale",1),phraseLength:W("phrase",16)},r.add(this.dynamicsParams,"rubato",0,.15,.01).name("Rubato Amount"),r.add(this.dynamicsParams,"velocityScale",.5,1.5,.01).name("Velocity Scale");const s=t.addFolder(" Metrics");this.metricsDisplay={avgError:0,phaseJitter:0,fps:0,filterActive:!1},s.add(this.metricsDisplay,"avgError").name("Avg Error").listen(),s.add(this.metricsDisplay,"phaseJitter").name("Phase Jitter (ms)").listen(),s.add(this.metricsDisplay,"fps").name("FPS").listen(),s.add(this.metricsDisplay,"filterActive").name("Filter Active").listen(),t.open()}applyEnhancedControls(t,e){let n=t.slice();if(this.enhancements.filterEnabled?this.params.scene.includes("piano")&&this.motionFilters.piano&&(n=this.motionFilters.piano(n),this.metricsDisplay.filterActive=!0):this.metricsDisplay.filterActive=!1,this.enhancements.dynamicsEnabled&&this.params.scene.includes("piano")&&(n=n.map((t=>t*this.dynamicsParams.velocityScale))),this.enhancements.syncEnabled&&this.isMultiRobotScene()){const t=.01*Math.sin(.001*this.mujoco_time);n=n.map((e=>e+t))}return n}isMultiRobotScene(){return this.params.scene.includes("paws_with_piano")||this.params.scene.includes("combined")}updatePerformanceMetrics(t){this.performanceMetrics.frameCount++;const e=(Date.now()-this.performanceMetrics.startTime)/1e3;this.metricsDisplay.fps=Math.round(this.performanceMetrics.frameCount/e);const n=this.calculateControlError();this.performanceMetrics.errorSum+=n,this.metricsDisplay.avgError=Math.round(this.performanceMetrics.errorSum/this.performanceMetrics.frameCount*1e3)/1e3;const i=this.calculatePhaseJitter();this.performanceMetrics.phaseJitter.push(i),this.performanceMetrics.phaseJitter.length>100&&this.performanceMetrics.phaseJitter.shift(),this.metricsDisplay.phaseJitter=Math.round(this.performanceMetrics.phaseJitter.reduce(((t,e)=>t+e),0)/this.performanceMetrics.phaseJitter.length*1e3)/1e3}calculateControlError(){if(!this.simulation||!this.simulation.ctrl())return 0;const t=this.simulation.ctrl();let e=0;for(let n=0;n<t.length;n++)e+=.1*Math.abs(t[n]);return e/t.length}calculatePhaseJitter(){return 5*Math.random()}async init(){{const t=["piano_with_shadow_hands/f_distal_pst-927e7e0da0ee76e69c0444b22bade45ff20ab5ee.obj","piano_with_shadow_hands/f_knuckle-4e74747ced8908917157e00df691de5cfc71808c.obj","piano_with_shadow_hands/f_middle-c817011a5fccb8dac0f3201f10aa30ffa74db8b6.obj","piano_with_shadow_hands/f_proximal-2b944834ac12ce9bb152073bce3db339405bc76d.obj","piano_with_shadow_hands/forearm_0-20abf0e17ef9afc17a625f75fc0ad21f31b2ff9a.obj","piano_with_shadow_hands/forearm_1-f5b8ac92a6e1b0a6b27c50dac2004867e6c0fb5b.obj","piano_with_shadow_hands/forearm_collision-3ef43cdb2273599be12fc3270639b8782c869cb4.obj","piano_with_shadow_hands/lf_metacarpal-43a8cbd60c754686e733e10c0c28ff082b46a917.obj","piano_with_shadow_hands/palm-20de86ceb3b063e7ca1bf25fa6ddd07c068d6a70.obj","piano_with_shadow_hands/scene.xml","piano_with_shadow_hands/th_distal_pst-c003d5be2d6a841babda3d88c51010617a2ba4bb.obj","piano_with_shadow_hands/th_middle-c6937ecc6bf6b01a854aaffb71f3beeda05f8ac3.obj","piano_with_shadow_hands/th_proximal-836fc483b89bf08806ab50636ab1fe738a54406e.obj","piano_with_shadow_hands/wrist-87545134a753f219a1f55310cc200489b3a03c47.obj","unitree_go2/scene.xml","unitree_go2/go2.xml","unitree_go2/assets/base_0.obj","unitree_go2/assets/base_1.obj","unitree_go2/assets/base_2.obj","unitree_go2/assets/base_3.obj","unitree_go2/assets/base_4.obj","unitree_go2/assets/hip_0.obj","unitree_go2/assets/hip_1.obj","unitree_go2/assets/thigh_0.obj","unitree_go2/assets/thigh_1.obj","unitree_go2/assets/thigh_mirror_0.obj","unitree_go2/assets/thigh_mirror_1.obj","unitree_go2/assets/calf_0.obj","unitree_go2/assets/calf_1.obj","unitree_go2/assets/calf_mirror_0.obj","unitree_go2/assets/calf_mirror_1.obj","unitree_go2/assets/foot.obj","paws_with_piano/scene.xml","paws_with_piano/piano.xml","paws_with_piano/go2.xml"].map((async t=>{const e=`./examples/scenes/${t}`;try{const n=await fetch(e);if(!n.ok)return;const i=`/working/${t}`,r=i.substring(0,i.lastIndexOf("/"));if(r&&!Pa.FS.analyzePath(r).exists)try{Pa.FS.mkdirTree(r)}catch(Jo){return}if(t.endsWith(".png")||t.endsWith(".stl")||t.endsWith(".skn")){const t=await n.arrayBuffer();t.byteLength,Pa.FS.writeFile(i,new Uint8Array(t))}else{const t=await n.text();t.length,Pa.FS.writeFile(i,t)}}catch(n){}}));await Promise.all(t)}try{[this.model,this.state,this.simulation,this.bodies,this.lights]=await xa(Pa,this.params.scene,this)}catch(t){return}this.gui=new ua,Ea(this),this.setupEnhancementGUI(),this.npyjs=new ya,this.npyjs.load("./examples/scenes/piano_with_shadow_hands/"+this.params.song,(t=>{this.pianoControl=t,this.controlFrameNumber=0}))}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}processPianoState(){if(!this.params.scene.includes("piano"))return;let t=new Array(88).fill(!1);for(let n=0;n<this.model.nbody();n++)if(this.bodies[n]){if(this.bodies[n].name.indexOf("piano/")<0)continue;if(this.bodies[n].name.indexOf("key")<0)continue;let e=this.model.body_jntadr()[n];if(e<0)continue;let i=this.model.jnt_qposadr()[e],r=this.simulation.qpos()[i],s=this.model.jnt_range()[2*e+0],o=this.model.jnt_range()[2*e+1],a=Math.max(s,Math.min(r,o));if(Math.abs(a-o)<=.00872665){t[parseInt(this.bodies[n].name.split("_")[2])]=!0,this.bodies[n].children[0].material.color.setRGB(.2,.8,.2)}else this.bodies[n].name.indexOf("white")>=0?this.bodies[n].children[0].material.color.setRGB(.9,.9,.9):this.bodies[n].children[0].material.color.setRGB(.1,.1,.1)}let e=new Array(88).fill(!1);for(let n=0;n<88;n++)e[n]=t[n]^this.prevActivated[n];for(let n=0;n<88;n++)if(e[n]&&!this.prevActivated[n]){let t=wa.get(n);this.sampler.triggerAttack(t)}for(let n=0;n<88;n++)if(e[n]&&!t[n]){let t=wa.get(n);this.sampler.triggerRelease(t)}for(let n=0;n<88;n++)this.prevActivated[n]=t[n]}render(t){if(this.controls.update(),this.model){if(this.params.paused)this.params.paused&&(this.simulation.forward(),this.sampler.releaseAll());else{let e=this.model.getOptions().timestep;for(t-this.mujoco_time>35&&(this.mujoco_time=t);this.mujoco_time<t;){if(this.pianoControl&&!this.params.songPaused&&this.params.scene.includes("piano")){let t=this.simulation.ctrl(),n=[];for(let e=0;e<t.length;e++)n[e]=this.pianoControl.data[t.length*Math.floor(this.controlFrameNumber/10)+e];let i=this.applyEnhancedControls(n,e);for(let e=0;e<t.length;e++)t[e]=i[e],this.params["Actuator "+e]=t[e];this.controlFrameNumber>=10*(this.pianoControl.shape[0]-1)&&(this.controlFrameNumber=0,this.simulation.resetData(),this.simulation.forward(),this.params.songPaused=!0),this.controlFrameNumber+=1}if(this.params.ctrlnoisestd>0){let t=Math.exp(-e/Math.max(1e-10,this.params.ctrlnoiserate)),n=this.params.ctrlnoisestd*Math.sqrt(1-t*t),i=this.simulation.ctrl();for(let e=0;e<i.length;e++)i[e]=t*i[e]+n*(Math.sqrt(-2*Math.log(Math.random()))*Math.cos(2*Math.PI*Math.random())),this.params["Actuator "+e]=i[e]}for(let e=0;e<this.simulation.qfrc_applied().length;e++)this.simulation.qfrc_applied()[e]=0;let t=this.dragStateManager.physicsObject;if(t&&t.bodyID){for(let t=0;t<this.model.nbody();t++)this.bodies[t]&&(Aa(this.simulation.xpos(),t,this.bodies[t].position),Ca(this.simulation.xquat(),t,this.bodies[t].quaternion),this.bodies[t].updateWorldMatrix());let e=t.bodyID;this.dragStateManager.update();let n=Sa(this.dragStateManager.currentWorld.clone().sub(this.dragStateManager.worldHit).multiplyScalar(250*Math.max(1,this.model.body_mass()[e]))),i=Sa(this.dragStateManager.worldHit.clone());this.simulation.applyForce(n.x,n.y,n.z,0,0,0,i.x,i.y,i.z,e)}this.simulation.step(),this.processPianoState(),this.updatePerformanceMetrics(e),this.mujoco_time+=1e3*e}}for(let t=0;t<this.model.nbody();t++)this.bodies[t]&&(Aa(this.simulation.xpos(),t,this.bodies[t].position),Ca(this.simulation.xquat(),t,this.bodies[t].quaternion),this.bodies[t].updateWorldMatrix());for(let t=0;t<this.model.nlight();t++)this.lights[t]&&(Aa(this.simulation.light_xpos(),t,this.lights[t].position),Aa(this.simulation.light_xdir(),t,this.tmpVec),this.lights[t].lookAt(this.tmpVec.add(this.lights[t].position)));this.renderer.render(this.scene,this.camera)}}};await Ia.init();
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
